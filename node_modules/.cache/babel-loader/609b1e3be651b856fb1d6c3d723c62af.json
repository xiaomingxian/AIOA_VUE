{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\system\\DepartList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\system\\DepartList.vue","mtime":1575269788930},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport DepartModal from \"./modules/DepartModal\";\nimport pick from 'lodash.pick';\nimport { queryDepartTreeList, searchByKeywords, deleteByDepartId } from '@/api/api';\nimport { httpAction, deleteAction } from '@/api/manage';\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin';\nimport Index from \"../profile/basic/Index\";\nimport InputElement from \"ant-design-vue/es/auto-complete/InputElement\"; // 表头\n\nvar columns = [{\n  title: '机构名称',\n  dataIndex: 'departName'\n}, {\n  title: '机构类型',\n  align: 'center',\n  dataIndex: 'orgType'\n}, {\n  title: '机构编码',\n  dataIndex: 'orgCode'\n}, {\n  title: '手机号',\n  dataIndex: 'mobile'\n}, {\n  title: '传真',\n  dataIndex: 'fax'\n}, {\n  title: '地址',\n  dataIndex: 'address'\n}, {\n  title: '排序',\n  align: 'center',\n  dataIndex: 'departOrder'\n}, {\n  title: '操作',\n  align: 'center',\n  dataIndex: 'action',\n  scopedSlots: {\n    customRender: 'action'\n  }\n}];\nexport default {\n  name: 'DepartList',\n  mixins: [JeecgListMixin],\n  components: {\n    InputElement: InputElement,\n    Index: Index,\n    DepartModal: DepartModal\n  },\n  data: function data() {\n    return {\n      iExpandedKeys: [],\n      loading: false,\n      autoExpandParent: true,\n      currFlowId: '',\n      currFlowName: '',\n      disable: true,\n      treeData: [],\n      visible: false,\n      departTree: [],\n      rightClickSelectedKey: '',\n      hiding: true,\n      model: {},\n      dropTrigger: '',\n      depart: {},\n      columns: columns,\n      disableSubmit: false,\n      checkedKeys: [],\n      selectedKeys: [],\n      autoIncr: 1,\n      currSelected: {},\n      form: this.$form.createForm(this),\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 5\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 16\n        }\n      },\n      graphDatasource: {\n        nodes: [],\n        edges: []\n      },\n      validatorRules: {\n        departName: {\n          rules: [{\n            required: true,\n            message: '请输入机构/部门名称!'\n          }]\n        },\n        orgCode: {\n          rules: [{\n            required: true,\n            message: '请输入机构编码!'\n          }]\n        },\n        mobile: {\n          rules: [{\n            validator: this.validateMobile\n          }]\n        }\n      },\n      url: {\n        delete: '/sys/sysDepart/delete',\n        edit: '/sys/sysDepart/edit',\n        deleteBatch: '/sys/sysDepart/deleteBatch',\n        exportXlsUrl: \"sys/sysDepart/exportXls\",\n        importExcelUrl: \"sys/sysDepart/importExcel\"\n      }\n    };\n  },\n  computed: {\n    importExcelUrl: function importExcelUrl() {\n      return \"\".concat(window._CONFIG['domianURL'], \"/\").concat(this.url.importExcelUrl);\n    }\n  },\n  methods: {\n    loadData: function loadData() {\n      this.refresh();\n    },\n    loadTree: function loadTree() {\n      var _this = this;\n\n      var that = this;\n      that.treeData = [];\n      that.departTree = [];\n      queryDepartTreeList().then(function (res) {\n        if (res.success) {\n          for (var i = 0; i < res.result.length; i++) {\n            var temp = res.result[i];\n            that.treeData.push(temp);\n            that.departTree.push(temp);\n            that.setThisExpandedKeys(temp);\n            console.log(temp.id);\n          }\n\n          _this.loading = false;\n        }\n      });\n    },\n    setThisExpandedKeys: function setThisExpandedKeys(node) {\n      if (node.children && node.children.length > 0) {\n        this.iExpandedKeys.push(node.key);\n\n        for (var a = 0; a < node.children.length; a++) {\n          this.setThisExpandedKeys(node.children[a]);\n        }\n      }\n    },\n    refresh: function refresh() {\n      this.loading = true;\n      this.loadTree();\n    },\n    // 右键操作方法\n    rightHandle: function rightHandle(node) {\n      this.dropTrigger = 'contextmenu';\n      console.log(node.node.eventKey);\n      this.rightClickSelectedKey = node.node.eventKey;\n    },\n    onExpand: function onExpand(expandedKeys) {\n      console.log('onExpand', expandedKeys); // if not set autoExpandParent to false, if children expanded, parent can not collapse.\n      // or, you can remove all expanded children keys.\n\n      this.iExpandedKeys = expandedKeys;\n      this.autoExpandParent = false;\n    },\n    backFlowList: function backFlowList() {\n      this.$router.back(-1);\n    },\n    // 右键点击下拉框改变事件\n    dropStatus: function dropStatus(visible) {\n      if (visible == false) {\n        this.dropTrigger = '';\n      }\n    },\n    // 右键店家下拉关闭下拉框\n    closeDrop: function closeDrop() {\n      this.dropTrigger = '';\n    },\n    addRootNode: function addRootNode() {\n      this.$refs.nodeModal.add(this.currFlowId, '');\n    },\n    batchDel: function batchDel() {\n      console.log(this.checkedKeys);\n\n      if (this.checkedKeys.length <= 0) {\n        this.$message.warning('请选择一条记录！');\n      } else {\n        var ids = '';\n\n        for (var a = 0; a < this.checkedKeys.length; a++) {\n          ids += this.checkedKeys[a] + ',';\n        }\n\n        var that = this;\n        this.$confirm({\n          title: '确认删除',\n          content: '确定要删除所选中的 ' + this.checkedKeys.length + ' 条数据，以及子节点数据吗?',\n          onOk: function onOk() {\n            deleteAction(that.url.deleteBatch, {\n              ids: ids\n            }).then(function (res) {\n              if (res.success) {\n                that.$message.success(res.message);\n                that.loadTree();\n                that.onClearSelected();\n              } else {\n                that.$message.warning(res.message);\n              }\n            });\n          }\n        });\n      }\n    },\n    onSearch: function onSearch(value) {\n      var that = this;\n\n      if (value) {\n        searchByKeywords({\n          keyWord: value\n        }).then(function (res) {\n          if (res.success) {\n            that.departTree = [];\n\n            for (var i = 0; i < res.result.length; i++) {\n              var temp = res.result[i];\n              that.departTree.push(temp);\n            }\n          } else {\n            that.$message.warning(res.message);\n          }\n        });\n      } else {\n        that.loadTree();\n      }\n    },\n    nodeModalOk: function nodeModalOk() {\n      this.loadTree();\n    },\n    nodeModalClose: function nodeModalClose() {},\n    hide: function hide() {\n      console.log(111);\n      this.visible = false;\n    },\n    onCheck: function onCheck(checkedKeys, info) {\n      console.log('onCheck', checkedKeys, info);\n      this.hiding = false;\n      this.checkedKeys = checkedKeys.checked;\n    },\n    onSelect: function onSelect(selectedKeys, e) {\n      console.log('selected', selectedKeys, e);\n      this.hiding = false;\n      var record = e.node.dataRef;\n      console.log('onSelect-record', record);\n      this.currSelected = Object.assign({}, record);\n      this.model = this.currSelected;\n      this.selectedKeys = [record.key];\n      this.model.parentId = record.parentId;\n      this.setValuesToForm(record);\n    },\n    // 触发onSelect事件时,为部门树右侧的form表单赋值\n    setValuesToForm: function setValuesToForm(record) {\n      this.form.getFieldDecorator('fax', {\n        initialValue: ''\n      });\n      this.form.setFieldsValue(pick(record, 'departName', 'orgCode', 'orgType', 'departOrder', 'mobile', 'fax', 'address', 'memo'));\n    },\n    getCurrSelectedTitle: function getCurrSelectedTitle() {\n      return !this.currSelected.title ? '' : this.currSelected.title;\n    },\n    onClearSelected: function onClearSelected() {\n      this.hiding = true;\n      this.checkedKeys = [];\n      this.currSelected = {};\n      this.form.resetFields();\n      this.selectedKeys = [];\n    },\n    handleNodeTypeChange: function handleNodeTypeChange(val) {\n      this.currSelected.nodeType = val;\n    },\n    notifyTriggerTypeChange: function notifyTriggerTypeChange(value) {\n      this.currSelected.notifyTriggerType = value;\n    },\n    receiptTriggerTypeChange: function receiptTriggerTypeChange(value) {\n      this.currSelected.receiptTriggerType = value;\n    },\n    submitCurrForm: function submitCurrForm() {\n      var _this2 = this;\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          if (!_this2.currSelected.id) {\n            _this2.$message.warning('请点击选择要修改部门!');\n\n            return;\n          }\n\n          var formData = Object.assign(_this2.currSelected, values);\n          console.log('Received values of form: ', formData);\n          httpAction(_this2.url.edit, formData, 'put').then(function (res) {\n            if (res.success) {\n              _this2.$message.success('保存成功!');\n\n              _this2.loadTree();\n            } else {\n              _this2.$message.error(res.message);\n            }\n          });\n        }\n      });\n    },\n    emptyCurrForm: function emptyCurrForm() {\n      this.form.resetFields();\n    },\n    nodeSettingFormSubmit: function nodeSettingFormSubmit() {\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          console.log('Received values of form: ', values);\n        }\n      });\n    },\n    openSelect: function openSelect() {\n      this.$refs.sysDirectiveModal.show();\n    },\n    handleAdd: function handleAdd(num) {\n      if (num == 1) {\n        this.$refs.departModal.add();\n        this.$refs.departModal.title = '新增';\n      } else if (num == 2) {\n        var key = this.currSelected.key;\n\n        if (!key) {\n          this.$message.warning('请先选中一条记录!');\n          return false;\n        }\n\n        this.$refs.departModal.add(this.selectedKeys);\n        this.$refs.departModal.title = '新增';\n      } else {\n        this.$refs.departModal.add(this.rightClickSelectedKey);\n        this.$refs.departModal.title = '新增';\n      }\n    },\n    handleDelete: function handleDelete() {\n      var _this3 = this;\n\n      deleteByDepartId({\n        id: this.rightClickSelectedKey\n      }).then(function (resp) {\n        if (resp.success) {\n          _this3.$message.success('删除成功!');\n\n          _this3.loadTree();\n        } else {\n          _this3.$message.warning('删除失败!');\n        }\n      });\n    },\n    selectDirectiveOk: function selectDirectiveOk(record) {\n      console.log('选中指令数据', record);\n      this.nodeSettingForm.setFieldsValue({\n        directiveCode: record.directiveCode\n      });\n      this.currSelected.sysCode = record.sysCode;\n    },\n    getFlowGraphData: function getFlowGraphData(node) {\n      this.graphDatasource.nodes.push({\n        id: node.id,\n        text: node.flowNodeName\n      });\n\n      if (node.children.length > 0) {\n        for (var a = 0; a < node.children.length; a++) {\n          var temp = node.children[a];\n          this.graphDatasource.edges.push({\n            source: node.id,\n            target: temp.id\n          });\n          this.getFlowGraphData(temp);\n        }\n      }\n    }\n  },\n  created: function created() {\n    this.currFlowId = this.$route.params.id;\n    this.currFlowName = this.$route.params.name; // this.loadTree()\n  }\n};",{"version":3,"sources":["DepartList.vue"],"names":[],"mappings":"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","sourcesContent":["<template xmlns:background-color=\"http://www.w3.org/1999/xhtml\">\r\n  <a-row :gutter=\"10\">\r\n    <a-col :md=\"12\" :sm=\"24\">\r\n      <a-card :bordered=\"false\">\r\n\r\n        <!-- 按钮操作区域 -->\r\n        <a-row style=\"margin-left: 14px\">\r\n          <a-button @click=\"handleAdd(2)\" type=\"primary\">添加子部门</a-button>\r\n          <a-button @click=\"handleAdd(1)\" type=\"primary\">添加一级部门</a-button>\r\n          <a-button type=\"primary\" icon=\"download\" @click=\"handleExportXls('部门信息')\">导出</a-button>\r\n          <a-upload name=\"file\" :showUploadList=\"false\" :multiple=\"false\" :headers=\"tokenHeader\"\r\n                    :action=\"importExcelUrl\" @change=\"handleImportExcel\">\r\n            <a-button type=\"primary\" icon=\"import\">导入</a-button>\r\n          </a-upload>\r\n          <a-button title=\"删除多条数据\" @click=\"batchDel\" type=\"default\">批量删除</a-button>\r\n          <!--<a-button @click=\"refresh\" type=\"default\" icon=\"reload\" :loading=\"loading\">刷新</a-button>-->\r\n        </a-row>\r\n        <div style=\"background: #fff;padding-left:16px;height: 100%; margin-top: 5px\">\r\n          <a-alert type=\"info\" :showIcon=\"true\">\r\n            <div slot=\"message\">\r\n              当前选择：\r\n              <a v-if=\"this.currSelected.title\">{{ getCurrSelectedTitle() }}</a>\r\n              <a v-if=\"this.currSelected.title\" style=\"margin-left: 10px\" @click=\"onClearSelected\">取消选择</a>\r\n            </div>\r\n          </a-alert>\r\n          <a-input-search @search=\"onSearch\" style=\"width:100%;margin-top: 10px\" placeholder=\"请输入部门名称\"/>\r\n          <!-- 树-->\r\n          <a-col :md=\"10\" :sm=\"24\">\r\n            <template>\r\n              <a-dropdown :trigger=\"[this.dropTrigger]\" @visibleChange=\"dropStatus\">\r\n               <span style=\"user-select: none\">\r\n            <a-tree\r\n              checkable\r\n              multiple\r\n              @select=\"onSelect\"\r\n              @check=\"onCheck\"\r\n              @rightClick=\"rightHandle\"\r\n              :selectedKeys=\"selectedKeys\"\r\n              :checkedKeys=\"checkedKeys\"\r\n              :treeData=\"departTree\"\r\n              :checkStrictly=\"true\"\r\n              :expandedKeys=\"iExpandedKeys\"\r\n              :autoExpandParent=\"autoExpandParent\"\r\n              @expand=\"onExpand\"/>\r\n                </span>\r\n                <!--新增右键点击事件,和增加添加和删除功能-->\r\n                <a-menu slot=\"overlay\">\r\n                  <a-menu-item @click=\"handleAdd(3)\" key=\"1\">添加</a-menu-item>\r\n                  <a-menu-item @click=\"handleDelete\" key=\"2\">删除</a-menu-item>\r\n                  <a-menu-item @click=\"closeDrop\" key=\"3\">取消</a-menu-item>\r\n                </a-menu>\r\n              </a-dropdown>\r\n            </template>\r\n          </a-col>\r\n        </div>\r\n      </a-card>\r\n    </a-col>\r\n    <a-col :md=\"12\" :sm=\"24\">\r\n      <a-card :bordered=\"false\">\r\n        <a-form :form=\"form\">\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"机构名称\">\r\n            <a-input placeholder=\"请输入机构/部门名称\" v-decorator=\"['departName', validatorRules.departName ]\"/>\r\n          </a-form-item>\r\n          <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"上级部门\">\r\n            <a-tree-select\r\n              style=\"width:100%\"\r\n              :dropdownStyle=\"{maxHeight:'200px',overflow:'auto'}\"\r\n              :treeData=\"treeData\"\r\n              :disabled=\"disable\"\r\n              v-model=\"model.parentId\"\r\n              placeholder=\"无\">\r\n            </a-tree-select>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"机构编码\">\r\n            <a-input disabled placeholder=\"请输入机构编码\" v-decorator=\"['orgCode', validatorRules.orgCode ]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"类型\">\r\n\r\n\r\n            <a-radio-group  buttonStyle=\"solid\" v-decorator=\"['orgType', validatorRules.orgType ]\" size=\"small\">\r\n              <a-radio-button value=\"1\"  >机构</a-radio-button>\r\n              <a-radio-button value=\"2\" >部门</a-radio-button>\r\n            </a-radio-group>\r\n\r\n\r\n\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"排序\">\r\n            <a-input-number v-decorator=\"[ 'departOrder',{'initialValue':0}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"手机号\">\r\n            <a-input placeholder=\"请输入手机号\" v-decorator=\"['mobile', {'initialValue':''}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"地址\">\r\n            <a-input placeholder=\"请输入地址\" v-decorator=\"['address', {'initialValue':''}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"备注\">\r\n            <a-textarea placeholder=\"请输入备注\" v-decorator=\"['memo', {'initialValue':''}]\"/>\r\n          </a-form-item>\r\n        </a-form>\r\n        <div class=\"anty-form-btn\">\r\n          <a-button @click=\"emptyCurrForm\" type=\"default\" htmlType=\"button\" icon=\"sync\">重置</a-button>\r\n          <a-button @click=\"submitCurrForm\" type=\"primary\" htmlType=\"button\" icon=\"form\">修改并保存</a-button>\r\n        </div>\r\n      </a-card>\r\n    </a-col>\r\n    <depart-modal ref=\"departModal\" @ok=\"loadTree\"></depart-modal>\r\n  </a-row>\r\n</template>\r\n<script>\r\n  import DepartModal from './modules/DepartModal'\r\n  import pick from 'lodash.pick'\r\n  import {queryDepartTreeList, searchByKeywords, deleteByDepartId} from '@/api/api'\r\n  import {httpAction, deleteAction} from '@/api/manage'\r\n  import {JeecgListMixin} from '@/mixins/JeecgListMixin'\r\n  import Index from \"../profile/basic/Index\";\r\n  import InputElement from \"ant-design-vue/es/auto-complete/InputElement\";\r\n  // 表头\r\n  const columns = [\r\n    {\r\n      title: '机构名称',\r\n      dataIndex: 'departName'\r\n    },\r\n    {\r\n      title: '机构类型',\r\n      align: 'center',\r\n      dataIndex: 'orgType'\r\n    },\r\n    {\r\n      title: '机构编码',\r\n      dataIndex: 'orgCode',\r\n    },\r\n    {\r\n      title: '手机号',\r\n      dataIndex: 'mobile'\r\n    },\r\n    {\r\n      title: '传真',\r\n      dataIndex: 'fax'\r\n    },\r\n    {\r\n      title: '地址',\r\n      dataIndex: 'address'\r\n    },\r\n    {\r\n      title: '排序',\r\n      align: 'center',\r\n      dataIndex: 'departOrder'\r\n    },\r\n    {\r\n      title: '操作',\r\n      align: 'center',\r\n      dataIndex: 'action',\r\n      scopedSlots: {customRender: 'action'}\r\n    }\r\n  ]\r\n  export default {\r\n    name: 'DepartList',\r\n    mixins: [JeecgListMixin],\r\n    components: {\r\n      InputElement,\r\n      Index,\r\n      DepartModal\r\n    },\r\n    data() {\r\n      return {\r\n        iExpandedKeys: [],\r\n        loading: false,\r\n        autoExpandParent: true,\r\n        currFlowId: '',\r\n        currFlowName: '',\r\n        disable: true,\r\n        treeData: [],\r\n        visible: false,\r\n        departTree: [],\r\n        rightClickSelectedKey: '',\r\n        hiding: true,\r\n        model: {},\r\n        dropTrigger: '',\r\n        depart: {},\r\n        columns: columns,\r\n        disableSubmit: false,\r\n        checkedKeys: [],\r\n        selectedKeys: [],\r\n        autoIncr: 1,\r\n        currSelected: {},\r\n        form: this.$form.createForm(this),\r\n        labelCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 5}\r\n        },\r\n        wrapperCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 16}\r\n        },\r\n        graphDatasource: {\r\n          nodes: [],\r\n          edges: []\r\n        },\r\n        validatorRules: {\r\n          departName: {rules: [{required: true, message: '请输入机构/部门名称!'}]},\r\n          orgCode: {rules: [{required: true, message: '请输入机构编码!'}]},\r\n          mobile: {rules: [{validator: this.validateMobile}]}\r\n        },\r\n        url: {\r\n          delete: '/sys/sysDepart/delete',\r\n          edit: '/sys/sysDepart/edit',\r\n          deleteBatch: '/sys/sysDepart/deleteBatch',\r\n          exportXlsUrl: \"sys/sysDepart/exportXls\",\r\n          importExcelUrl: \"sys/sysDepart/importExcel\",\r\n        },\r\n      }\r\n    },\r\n    computed: {\r\n      importExcelUrl: function () {\r\n        return `${window._CONFIG['domianURL']}/${this.url.importExcelUrl}`;\r\n      }\r\n    },\r\n    methods: {\r\n      loadData() {\r\n        this.refresh();\r\n      },\r\n      loadTree() {\r\n        var that = this\r\n        that.treeData = []\r\n        that.departTree = []\r\n        queryDepartTreeList().then((res) => {\r\n          if (res.success) {\r\n            for (let i = 0; i < res.result.length; i++) {\r\n              let temp = res.result[i]\r\n              that.treeData.push(temp)\r\n              that.departTree.push(temp)\r\n              that.setThisExpandedKeys(temp)\r\n              console.log(temp.id)\r\n            }\r\n            this.loading = false\r\n          }\r\n        })\r\n      },\r\n      setThisExpandedKeys(node) {\r\n        if (node.children && node.children.length > 0) {\r\n          this.iExpandedKeys.push(node.key)\r\n          for (let a = 0; a < node.children.length; a++) {\r\n            this.setThisExpandedKeys(node.children[a])\r\n          }\r\n        }\r\n      },\r\n      refresh() {\r\n        this.loading = true\r\n        this.loadTree()\r\n      },\r\n      // 右键操作方法\r\n      rightHandle(node) {\r\n        this.dropTrigger = 'contextmenu'\r\n        console.log(node.node.eventKey)\r\n        this.rightClickSelectedKey = node.node.eventKey\r\n      },\r\n      onExpand(expandedKeys) {\r\n        console.log('onExpand', expandedKeys)\r\n        // if not set autoExpandParent to false, if children expanded, parent can not collapse.\r\n        // or, you can remove all expanded children keys.\r\n        this.iExpandedKeys = expandedKeys\r\n        this.autoExpandParent = false\r\n      },\r\n      backFlowList() {\r\n        this.$router.back(-1)\r\n      },\r\n      // 右键点击下拉框改变事件\r\n      dropStatus(visible) {\r\n        if (visible == false) {\r\n          this.dropTrigger = ''\r\n        }\r\n      },\r\n      // 右键店家下拉关闭下拉框\r\n      closeDrop() {\r\n        this.dropTrigger = ''\r\n      },\r\n      addRootNode() {\r\n        this.$refs.nodeModal.add(this.currFlowId, '')\r\n      },\r\n      batchDel: function () {\r\n        console.log(this.checkedKeys)\r\n        if (this.checkedKeys.length <= 0) {\r\n          this.$message.warning('请选择一条记录！')\r\n        } else {\r\n          var ids = ''\r\n          for (var a = 0; a < this.checkedKeys.length; a++) {\r\n            ids += this.checkedKeys[a] + ','\r\n          }\r\n          var that = this\r\n          this.$confirm({\r\n            title: '确认删除',\r\n            content: '确定要删除所选中的 ' + this.checkedKeys.length + ' 条数据，以及子节点数据吗?',\r\n            onOk: function () {\r\n              deleteAction(that.url.deleteBatch, {ids: ids}).then((res) => {\r\n                if (res.success) {\r\n                  that.$message.success(res.message)\r\n                  that.loadTree()\r\n                  that.onClearSelected()\r\n                } else {\r\n                  that.$message.warning(res.message)\r\n                }\r\n              })\r\n            }\r\n          })\r\n        }\r\n      },\r\n      onSearch(value) {\r\n        let that = this\r\n        if (value) {\r\n          searchByKeywords({keyWord: value}).then((res) => {\r\n            if (res.success) {\r\n              that.departTree = []\r\n              for (let i = 0; i < res.result.length; i++) {\r\n                let temp = res.result[i]\r\n                that.departTree.push(temp)\r\n              }\r\n            } else {\r\n              that.$message.warning(res.message)\r\n            }\r\n          })\r\n        } else {\r\n          that.loadTree()\r\n        }\r\n\r\n      },\r\n      nodeModalOk() {\r\n        this.loadTree()\r\n      },\r\n      nodeModalClose() {\r\n      },\r\n      hide() {\r\n        console.log(111)\r\n        this.visible = false\r\n      },\r\n      onCheck(checkedKeys, info) {\r\n        console.log('onCheck', checkedKeys, info)\r\n        this.hiding = false\r\n        this.checkedKeys = checkedKeys.checked\r\n      },\r\n      onSelect(selectedKeys, e) {\r\n        console.log('selected', selectedKeys, e)\r\n        this.hiding = false\r\n        let record = e.node.dataRef\r\n        console.log('onSelect-record', record)\r\n        this.currSelected = Object.assign({}, record)\r\n        this.model = this.currSelected\r\n        this.selectedKeys = [record.key]\r\n        this.model.parentId = record.parentId\r\n        this.setValuesToForm(record)\r\n\r\n\r\n      },\r\n      // 触发onSelect事件时,为部门树右侧的form表单赋值\r\n      setValuesToForm(record) {\r\n        this.form.getFieldDecorator('fax', {initialValue: ''})\r\n        this.form.setFieldsValue(pick(record, 'departName', 'orgCode','orgType', 'departOrder', 'mobile', 'fax', 'address', 'memo'))\r\n      },\r\n      getCurrSelectedTitle() {\r\n        return !this.currSelected.title ? '' : this.currSelected.title\r\n      },\r\n      onClearSelected() {\r\n        this.hiding = true\r\n        this.checkedKeys = []\r\n        this.currSelected = {}\r\n        this.form.resetFields()\r\n        this.selectedKeys = []\r\n      },\r\n      handleNodeTypeChange(val) {\r\n        this.currSelected.nodeType = val\r\n      },\r\n      notifyTriggerTypeChange(value) {\r\n        this.currSelected.notifyTriggerType = value\r\n      },\r\n      receiptTriggerTypeChange(value) {\r\n        this.currSelected.receiptTriggerType = value\r\n      },\r\n      submitCurrForm() {\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            if (!this.currSelected.id) {\r\n              this.$message.warning('请点击选择要修改部门!')\r\n              return\r\n            }\r\n\r\n            let formData = Object.assign(this.currSelected, values)\r\n            console.log('Received values of form: ', formData)\r\n            httpAction(this.url.edit, formData, 'put').then((res) => {\r\n              if (res.success) {\r\n                this.$message.success('保存成功!')\r\n                this.loadTree()\r\n              } else {\r\n                this.$message.error(res.message)\r\n              }\r\n            })\r\n          }\r\n        })\r\n      },\r\n      emptyCurrForm() {\r\n        this.form.resetFields()\r\n      },\r\n      nodeSettingFormSubmit() {\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            console.log('Received values of form: ', values)\r\n          }\r\n        })\r\n      },\r\n      openSelect() {\r\n        this.$refs.sysDirectiveModal.show()\r\n      },\r\n      handleAdd(num) {\r\n        if (num == 1) {\r\n          this.$refs.departModal.add()\r\n          this.$refs.departModal.title = '新增'\r\n        } else if (num == 2) {\r\n          let key = this.currSelected.key\r\n          if (!key) {\r\n            this.$message.warning('请先选中一条记录!')\r\n            return false\r\n          }\r\n          this.$refs.departModal.add(this.selectedKeys)\r\n          this.$refs.departModal.title = '新增'\r\n        } else {\r\n          this.$refs.departModal.add(this.rightClickSelectedKey)\r\n          this.$refs.departModal.title = '新增'\r\n        }\r\n      },\r\n      handleDelete() {\r\n        deleteByDepartId({id: this.rightClickSelectedKey}).then((resp) => {\r\n          if (resp.success) {\r\n            this.$message.success('删除成功!')\r\n            this.loadTree()\r\n          } else {\r\n            this.$message.warning('删除失败!')\r\n          }\r\n        })\r\n      },\r\n      selectDirectiveOk(record) {\r\n        console.log('选中指令数据', record)\r\n        this.nodeSettingForm.setFieldsValue({directiveCode: record.directiveCode})\r\n        this.currSelected.sysCode = record.sysCode\r\n      },\r\n      getFlowGraphData(node) {\r\n        this.graphDatasource.nodes.push({\r\n          id: node.id,\r\n          text: node.flowNodeName\r\n        })\r\n        if (node.children.length > 0) {\r\n          for (let a = 0; a < node.children.length; a++) {\r\n            let temp = node.children[a]\r\n            this.graphDatasource.edges.push({\r\n              source: node.id,\r\n              target: temp.id\r\n            })\r\n            this.getFlowGraphData(temp)\r\n          }\r\n        }\r\n      },\r\n    },\r\n    created() {\r\n      this.currFlowId = this.$route.params.id\r\n      this.currFlowName = this.$route.params.name\r\n      // this.loadTree()\r\n    },\r\n\r\n  }\r\n</script>\r\n<style scoped>\r\n  .ant-card-body .table-operator {\r\n    margin: 15px;\r\n  }\r\n\r\n  .anty-form-btn {\r\n    width: 100%;\r\n    text-align: center;\r\n  }\r\n\r\n  .anty-form-btn button {\r\n    margin: 0 5px;\r\n  }\r\n\r\n  .anty-node-layout .ant-layout-header {\r\n    padding-right: 0\r\n  }\r\n\r\n  .header {\r\n    padding: 0 8px;\r\n  }\r\n\r\n  .header button {\r\n    margin: 0 3px\r\n  }\r\n\r\n  .ant-modal-cust-warp {\r\n    height: 100%\r\n  }\r\n\r\n  .ant-modal-cust-warp .ant-modal-body {\r\n    height: calc(100% - 110px) !important;\r\n    overflow-y: auto\r\n  }\r\n\r\n  .ant-modal-cust-warp .ant-modal-content {\r\n    height: 90% !important;\r\n    overflow-y: hidden\r\n  }\r\n\r\n  #app .desktop {\r\n    height: auto !important;\r\n  }\r\n\r\n  /** Button按钮间距 */\r\n  .ant-btn {\r\n    margin-left: 3px\r\n  }\r\n</style>"],"sourceRoot":"src/views/system"}]}