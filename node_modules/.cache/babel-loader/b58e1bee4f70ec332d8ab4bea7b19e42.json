{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\oaTeamwork\\modules\\oaTeamworkSetListModel.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\oaTeamwork\\modules\\oaTeamworkSetListModel.vue","mtime":1579508875603},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport oaTeamworkModal from \"./oaTeamworkModal\";\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin';\nimport oaTeamworkSetList from \"../oaTeamworkSetList\";\nimport { httpAction, getAction, postAction, getRoleList, getUserList, getServiceList } from '@/api/manage';\nexport default {\n  name: \"oaTeamworkList\",\n  mixins: [JeecgListMixin],\n  components: {\n    oaTeamworkModal: oaTeamworkModal,\n    oaTeamworkSetList: oaTeamworkSetList\n  },\n  data: function data() {\n    return {\n      iteamworkId: '',\n      steamworkName: '',\n      iversion: '',\n      dataId: '',\n      newDataId: '',\n      Order: [],\n      modelId: '',\n      functionId: '',\n      dataIds: '',\n      IntsList: [],\n      visibleDel: false,\n      showFunPer: false,\n      description: '个人协同办公业务配置分类管理页面',\n      // 表头\n      columns: [{\n        title: '协同业务名称',\n        align: \"center\",\n        dataIndex: 'iteamworkName'\n      }, {\n        title: '描述',\n        align: \"center\",\n        dataIndex: 'description'\n      }, {\n        title: '步骤',\n        dataIndex: 'orderName',\n        align: \"center\"\n      }],\n      url: {\n        list: \"/oateamwork/oaTeamworkSet/queryList\",\n        Intslist: \"/oaTea/oaTeamworkInst/list\",\n        findOrder: \"/oaTea/oaTeamworkInst/findOrder\",\n        delete: \"/oateamwork/oaTeamwork/delete\",\n        deleteBatch: \"/oateamwork/oaTeamwork/deleteBatch\",\n        exportXlsUrl: \"oateamwork/oaTeamwork/exportXls\",\n        importExcelUrl: \"oateamwork/oaTeamwork/importExcel\"\n      },\n      keysObjs: []\n    };\n  },\n  created: function created() {},\n  computed: {\n    importExcelUrl: function importExcelUrl() {\n      return \"\".concat(window._CONFIG['domianURL'], \"/\").concat(this.url.importExcelUrl);\n    }\n  },\n  methods: {\n    handleTableChange: function handleTableChange(q, w, e) {\n      var _this = this;\n\n      console.log(q.current);\n      this.ipagination.current = q.current;\n      getAction(this.url.list, {\n        pageNo: q.current,\n        iTeamworkId: this.iteamworkId\n      }).then(function (res) {\n        _this.dataSource = res.result.record;\n        _this.ipagination.total = res.result.total;\n      });\n    },\n    showOpen: function showOpen(userid, backData, busDataid) {\n      var _this2 = this;\n\n      this.showFunPer = true;\n      this.dataId = busDataid;\n      getAction(this.url.list, {\n        sCreateBy: userid,\n        iBusFunctionId: backData.i_bus_function_id\n      }).then(function (res) {\n        if (res.result.records.length == 0) {\n          _this2.$message.error(\"该业务没有匹配的协同办公\");\n        } else {\n          _this2.ipagination.total = res.result.total;\n          _this2.dataSource = res.result.records;\n        }\n      });\n    },\n    // 多选事件\n    onSelectChange: function onSelectChange(selectedRowKeys, keysObjs) {\n      this.keysObjs = keysObjs;\n      this.selectedRowKeys = selectedRowKeys;\n    },\n    handleOk: function handleOk() {\n      var _this3 = this;\n\n      // this.showFunPer = false;\n      console.log(this.keysObjs[0]);\n      console.log(this.dataId);\n      getAction(this.url.findOrder, {\n        iteamworkId: this.keysObjs[0].iteamworkId\n      }).then(function (res) {\n        _this3.Order = res.result;\n\n        for (var i = 0; i < _this3.Order.length; i++) {\n          if (_this3.Order[i] < _this3.keysObjs[0].maxOrder) {\n            console.log(_this3.keysObjs[0]);\n            console.log(_this3.Order[i]);\n\n            _this3.$message.error(\"您选择的流程还没有完成\");\n\n            return;\n          } else {\n            var param = {\n              modelId: _this3.keysObjs[0].orderModelId.split(\",\")[1],\n              functionId: _this3.keysObjs[0].orderFunctionId.split(\",\")[1]\n            };\n            postAction(\"/oaBus/oaBusdata/queryNewTaskMsg\", param).then(function (res) {\n              if (res.success) {\n                var promise1 = new Promise(function (resolve) {\n                  // console.log(window.location);\n                  _this3.newDataId = JSON.stringify(res.result.busdataId);\n                  console.log(_this3.newDataId); // window.location.href(window.location.origin + '/mytask/taskList/Test-detailFile?tableName=' + res.result.tableName + '&busdataId=' + res.result.busdataId + '&navisshow=false')\n\n                  _this3.$router.push({\n                    path: '/mytask/taskList/Test-detailFile?tableName=' + res.result.tableName + '&busdataId=' + res.result.busdataId + '&navisshow=false'\n                  });\n\n                  resolve(_this3.newDataId);\n                });\n                promise1.then(function (newDataId) {\n                  var data1 = {\n                    iteamworkId: _this3.keysObjs[0].iteamworkId,\n                    iteamworkSetId: _this3.keysObjs[0].iid,\n                    iorder: 1,\n                    ibusdataId: _this3.dataId,\n                    iversion: _this3.dataId,\n                    ibusModelId: _this3.keysObjs[0].orderModelId.split(\",\")[0],\n                    ibusFunctionId: _this3.keysObjs[0].orderFunctionId.split(\",\")[0]\n                  };\n                  var data2 = {\n                    iteamworkId: _this3.keysObjs[0].iteamworkId,\n                    iteamworkSetId: _this3.keysObjs[0].iid,\n                    iorder: 2,\n                    ibusdataId: newDataId,\n                    iversion: _this3.dataId,\n                    ibusModelId: _this3.keysObjs[0].orderModelId.split(\",\")[1],\n                    ibusFunctionId: _this3.keysObjs[0].orderFunctionId.split(\",\")[1]\n                  };\n                  var dataList = {\n                    data1: data1,\n                    data2: data2\n                  };\n                  postAction(\"/oaTea/oaTeamworkInst/add\", dataList).then(function (res) {\n                    if (res.success) {\n                      _this3.$message.success(res.message);\n                    } else {\n                      _this3.$message.error(res.message);\n                    }\n                  });\n                });\n              } else {\n                _this3.$message.error(res.message);\n              }\n            });\n          }\n        }\n      });\n    },\n    handleCancle: function handleCancle() {\n      this.showFunPer = false;\n    }\n  }\n};",{"version":3,"sources":["oaTeamworkSetListModel.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal :visible=\"showFunPer\" :width=\"1200\" @ok=\"handleOk\" @cancel=\"handleCancle\">\r\n  <a-card :bordered=\"false\">\r\n\r\n    <!-- 查询区域 -->\r\n   <!-- <div class=\"table-page-search-wrapper\">\r\n      <a-form layout=\"inline\">\r\n        <a-row :gutter=\"24\">\r\n\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"描述\">\r\n              <a-input placeholder=\"请输入描述\" v-model=\"queryParam.description\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n\r\n          <a-col :md=\"6\" :sm=\"8\" >\r\n            <span style=\"float: left;overflow: hidden;\" class=\"table-page-search-submitButtons\">\r\n              <a-button type=\"primary\" @click=\"searchQuery\" icon=\"search\">查询</a-button>\r\n              <a-button type=\"primary\" @click=\"searchReset\" icon=\"reload\" style=\"margin-left: 8px\">重置</a-button>\r\n              <a @click=\"handleToggleSearch\" style=\"margin-left: 8px\">\r\n                {{ toggleSearchStatus ? '收起' : '展开' }}\r\n                <a-icon :type=\"toggleSearchStatus ? 'up' : 'down'\"/>\r\n              </a>\r\n            </span>\r\n          </a-col>\r\n\r\n        </a-row>\r\n      </a-form>\r\n    </div>\r\n-->\r\n    <!-- 操作按钮区域 -->\r\n\r\n    <!-- table区域-begin -->\r\n  <!--  <div>\r\n      <div class=\"ant-alert ant-alert-info\" style=\"margin-bottom: 16px;\">\r\n        <i class=\"anticon anticon-info-circle ant-alert-icon\"></i> 已选择 <a style=\"font-weight: 600\">{{ selectedRowKeys.length }}</a>项\r\n        <a style=\"margin-left: 24px\" @click=\"onClearSelected\">清空</a>\r\n      </div>-->\r\n\r\n      <a-table\r\n        ref=\"table\"\r\n        size=\"middle\"\r\n        bordered\r\n        rowKey=\"iid\"\r\n        :columns=\"columns\"\r\n        :dataSource=\"dataSource\"\r\n        :pagination=\"ipagination\"\r\n        :loading=\"loading\"\r\n        :rowSelection=\"{selectedRowKeys: selectedRowKeys, onChange: onSelectChange}\"\r\n        @change=\"handleTableChange\"\r\n        :rowClassName=\"(record,index) => {\r\n              let className  = 'light-row';\r\n              if (index % 2 === 1) className = 'dark-row';\r\n              return className;\r\n          }\"\r\n      >\r\n\r\n          <span slot=\"action\" slot-scope=\"text, record\">\r\n          <!--<a @click=\"handleEdit(record)\">编辑</a>\r\n            <a-divider type=\"vertical\" />-->\r\n          <a @click=\"handleConfig(record)\">配置明细</a>\r\n         <!-- <a-divider type=\"vertical\" />\r\n           <a @click=\"handleDelete(record.iid)\" title=\"确定删除吗?\">删除</a>-->\r\n        </span>\r\n      </a-table>\r\n\r\n    <oaTeamwork-modal ref=\"modalForm\" @ok=\"modalFormOk\"></oaTeamwork-modal>\r\n    <oa-teamwork-set-list ref=\"teamworkSetList\" @ok=\"modalFormOk\" ></oa-teamwork-set-list>\r\n  </a-card>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import oaTeamworkModal from './oaTeamworkModal'\r\n  import { JeecgListMixin } from '@/mixins/JeecgListMixin'\r\n  import  oaTeamworkSetList from '../oaTeamworkSetList'\r\n  import {httpAction, getAction, postAction, getRoleList, getUserList, getServiceList} from '@/api/manage'\r\n  export default {\r\n    name: \"oaTeamworkList\",\r\n    mixins:[JeecgListMixin],\r\n    components: {\r\n      oaTeamworkModal,\r\n      oaTeamworkSetList,\r\n\r\n    },\r\n    data () {\r\n      return {\r\n        iteamworkId:'',\r\n        steamworkName:'',\r\n        iversion:'',\r\n        dataId:'',\r\n        newDataId:'',\r\n        Order:[],\r\n        modelId:'',\r\n        functionId:'',\r\n        dataIds:'',\r\n        IntsList:[],\r\n        visibleDel:false,\r\n        showFunPer: false,\r\n        description: '个人协同办公业务配置分类管理页面',\r\n        // 表头\r\n          columns: [\r\n\r\n            {\r\n              title: '协同业务名称',\r\n              align:\"center\",\r\n              dataIndex: 'iteamworkName'\r\n            },\r\n            {\r\n              title: '描述',\r\n              align:\"center\",\r\n              dataIndex: 'description'\r\n            },\r\n           {\r\n              title: '步骤',\r\n              dataIndex: 'orderName',\r\n              align:\"center\",\r\n            }\r\n          ],\r\n          url: {\r\n            list: \"/oateamwork/oaTeamworkSet/queryList\",\r\n            Intslist: \"/oaTea/oaTeamworkInst/list\",\r\n            findOrder: \"/oaTea/oaTeamworkInst/findOrder\",\r\n            delete: \"/oateamwork/oaTeamwork/delete\",\r\n            deleteBatch: \"/oateamwork/oaTeamwork/deleteBatch\",\r\n            exportXlsUrl: \"oateamwork/oaTeamwork/exportXls\",\r\n            importExcelUrl: \"oateamwork/oaTeamwork/importExcel\",\r\n          },\r\n\r\n        keysObjs:[],\r\n        }\r\n  },\r\n    created () {\r\n\r\n    },\r\n\r\n  computed: {\r\n    importExcelUrl: function(){\r\n      return `${window._CONFIG['domianURL']}/${this.url.importExcelUrl}`;\r\n    }\r\n  },\r\n    methods: {\r\n      handleTableChange(q,w,e,){\r\n        console.log(q.current);\r\n        this.ipagination.current = q.current;\r\n        getAction(this.url.list, {pageNo:q.current, iTeamworkId:this.iteamworkId}).then((res) => {\r\n          this.dataSource = res.result.record;\r\n          this.ipagination.total =  res.result.total;\r\n        })\r\n      },\r\n      showOpen (userid,backData,busDataid) {\r\n        this.showFunPer = true\r\n        this.dataId=busDataid;\r\n        getAction(this.url.list,{sCreateBy:userid,iBusFunctionId:backData.i_bus_function_id}).then((res) => {\r\n          if(res.result.records.length == 0){\r\n            this.$message.error(\"该业务没有匹配的协同办公\");\r\n          }else{\r\n            this.ipagination.total =  res.result.total;\r\n            this.dataSource = res.result.records;\r\n          }\r\n\r\n\r\n        })\r\n      },\r\n\r\n\r\n      // 多选事件\r\n      onSelectChange(selectedRowKeys,keysObjs){\r\n        this.keysObjs = keysObjs;\r\n        this.selectedRowKeys = selectedRowKeys\r\n      },\r\n      handleOk() {\r\n        // this.showFunPer = false;\r\n        console.log(this.keysObjs[0])\r\n        console.log(this.dataId)\r\n        getAction(this.url.findOrder,{iteamworkId:this.keysObjs[0].iteamworkId}).then((res) => {\r\n          this.Order = res.result;\r\n          for(let i=0;i<this.Order.length;i++){\r\n            if(this.Order[i]<this.keysObjs[0].maxOrder){\r\n              console.log(this.keysObjs[0])\r\n              console.log(this.Order[i])\r\n              this.$message.error(\"您选择的流程还没有完成\");\r\n              return ;\r\n            }else\r\n              {\r\n              let param = {\r\n                modelId: this.keysObjs[0].orderModelId.split(\",\")[1],\r\n                functionId: this.keysObjs[0].orderFunctionId.split(\",\")[1],\r\n              }\r\n              postAction(\"/oaBus/oaBusdata/queryNewTaskMsg\", param).then(res => {\r\n                if (res.success) {\r\n                  const promise1 = new Promise((resolve => {\r\n                    // console.log(window.location);\r\n                    this.newDataId =   JSON.stringify(res.result.busdataId)\r\n                    console.log(this.newDataId);\r\n                    // window.location.href(window.location.origin + '/mytask/taskList/Test-detailFile?tableName=' + res.result.tableName + '&busdataId=' + res.result.busdataId + '&navisshow=false')\r\n                    this.$router.push({path: '/mytask/taskList/Test-detailFile?tableName=' + res.result.tableName + '&busdataId=' + res.result.busdataId + '&navisshow=false'})\r\n                    resolve(this.newDataId)\r\n                  }))\r\n\r\n\r\n                  promise1.then((newDataId)=>{\r\n                    let data1 = {\r\n                      iteamworkId:this.keysObjs[0].iteamworkId,\r\n                      iteamworkSetId:this.keysObjs[0].iid,\r\n                      iorder:1,\r\n                      ibusdataId:this.dataId,\r\n                      iversion:this.dataId,\r\n                      ibusModelId:this.keysObjs[0].orderModelId.split(\",\")[0],\r\n                      ibusFunctionId:this.keysObjs[0].orderFunctionId.split(\",\")[0]\r\n                    }\r\n                    let data2 = {\r\n                      iteamworkId:this.keysObjs[0].iteamworkId,\r\n                      iteamworkSetId:this.keysObjs[0].iid,\r\n                      iorder:2,\r\n                      ibusdataId:newDataId,\r\n                      iversion:this.dataId,\r\n                      ibusModelId:this.keysObjs[0].orderModelId.split(\",\")[1],\r\n                      ibusFunctionId:this.keysObjs[0].orderFunctionId.split(\",\")[1]\r\n                    }\r\n                    let dataList = {\r\n                      data1:data1,data2:data2\r\n                    }\r\n                    postAction(\"/oaTea/oaTeamworkInst/add\", dataList).then(res => {\r\n                      if (res.success) {\r\n                        this.$message.success(res.message)\r\n                      } else {\r\n                        this.$message.error(res.message)\r\n                      }\r\n                    })\r\n                  })\r\n\r\n                } else {\r\n                  this.$message.error(res.message)\r\n                }\r\n              })\r\n            }\r\n          }\r\n        })\r\n\r\n\r\n      },\r\n      handleCancle() {\r\n        this.showFunPer = false;\r\n      },\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n\r\n</style>"],"sourceRoot":"src/views/oaTeamwork/modules"}]}