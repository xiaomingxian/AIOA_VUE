{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\workflow\\modules\\opinion\\OaProcOpinionNewModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\workflow\\modules\\opinion\\OaProcOpinionNewModal.vue","mtime":1578232184167},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { httpAction, getAction, postAction, deleteAction } from '@/api/manage';\nimport pick from 'lodash.pick';\nimport moment from \"moment\";\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin';\nimport ACol from \"ant-design-vue/es/grid/Col\";\nexport default {\n  name: \"OaProcOpinionNewModal\",\n  mixins: [JeecgListMixin],\n  components: {\n    ACol: ACol\n  },\n  data: function data() {\n    return {\n      title: \"操作\",\n      visible: false,\n      show: false,\n      //意见类型--显示控制\n      procDefKey: '',\n      showName: false,\n      //是否显示提示\n      opinionName: '',\n      //后台产生的名字\n      typeList: [],\n      taskDefKey: '',\n      type: '',\n      //意见框类型：取数据字典下拉列表\n      sprocOpinionName: '',\n      //意见组合名称\n      model: {},\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 5\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 16\n        }\n      },\n      opinionSetModal: {\n        itaskOpinionName: '',\n        //意见框名称\n        itaskOpinionOrder: 0 //意见框位置\n\n      },\n      itaskOpinionName: '',\n      //意见框名称\n      itaskOpinionOrder: 0,\n      //意见框位置\n      TaskLinkList: [],\n      //任务环节列表\n      TaskLinkId: '',\n      //流程定义Id\n      //业务模块---------------\n      //         selectList: [],\n      // timeList:[],\n      // iProcSetId:'',\n      confirmLoading: false,\n      toggleSearchStatusSet: true,\n      form: this.$form.createForm(this),\n      validatorRules: {\n        iId: {\n          rules: [{\n            required: true,\n            message: '请输入主键id!'\n          }]\n        }\n      },\n      url: {\n        list: \"/oaopinionset/oaOpinionSet/list\",\n        delete: \"/oaopinionset/oaOpinionSet/delete\",\n        deleteBatch: \"/oaopinionset/oaOpinionSet/deleteBatch\",\n        exportXlsUrl: \"oaopinionset/oaOpinionSet/exportXls\",\n        importExcelUrl: \"oaopinionset/oaOpinionSet/importExcel\",\n        add: \"/oaopinionset/oaOpinionSet/add\",\n        edit: \"/oaopinionset/oaOpinionSet/edit\"\n      }\n    };\n  },\n  created: function created() {},\n  computed: {\n    importExcelUrl: function importExcelUrl() {\n      return \"\".concat(window._CONFIG['domianURL'], \"/\").concat(this.url.importExcelUrl);\n    }\n  },\n  methods: {\n    //\n    getType: function getType() {\n      this.opinionSetModal.type = this.type;\n    },\n    //修改意见组合名称\n    iTaskOpinionNewName: function iTaskOpinionNewName() {\n      var that = this;\n      var httpurl = '';\n      var method = '';\n\n      if (!this.model.iid) {\n        httpurl += this.url.add;\n        method = 'post';\n      } else {\n        httpurl += this.url.edit;\n        method = 'put';\n      }\n\n      this.model.sprocOpinionName = this.sprocOpinionName; // let formData = Object.assign(this.model, values);\n\n      httpAction(httpurl, {\n        iid: this.model.iid,\n        sprocOpinionName: this.model.sprocOpinionName,\n        procDefKey: this.model.procDefKey\n      }, method).then(function (res) {\n        if (res.success) {\n          that.$message.success(res.message);\n          that.$emit('ok');\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    },\n    getTypeList: function getTypeList() {\n      var _this = this;\n\n      //获取任务环节\n      var url = \"/sys/dict/getDictByKey\";\n      getAction(url, {\n        dictKey: 'type'\n      }).then(function (res) {\n        console.log('--------------------意见类型-下拉列表------------------------------');\n        console.log(res);\n        _this.typeList = res.result;\n      });\n    },\n    getTaskLinkList: function getTaskLinkList() {\n      var _this2 = this;\n\n      //获取任务环节\n      var url = \"/wf/process/actsList\";\n      getAction(url, {\n        processDefinitionId: this.TaskLinkId\n      }).then(function (res) {\n        _this2.TaskLinkList = res.result;\n\n        if (_this2.taskDefKey == null || _this2.taskDefKey == '') {\n          _this2.taskDefKey = _this2.TaskLinkList[0].id; //得到默认值\n        }\n\n        _this2.onTasklink();\n      });\n    },\n    onTasklink: function onTasklink() {\n      var _this3 = this;\n\n      //请求表单数据\n      //初始化\n      this.showName == false; //隐藏错误\n\n      this.toggleSearchStatus = true;\n      this.itaskOpinionName = ''; //意见框名称\n\n      this.itaskOpinionOrder = 0; //意见框位置\n      // this.iProcSetId='';\n\n      var url = \"/oaopinionset/oaOpinionSet/queryByTaskDefKey\";\n      postAction(url, {\n        taskDefKey: this.taskDefKey,\n        iProcOpinionId: this.model.iid,\n        procDefKey: this.procDefKey\n      }).then(function (res) {\n        console.log('0000000000000000000000000000000');\n        console.log(res.result);\n        _this3.model.taskDefKey = _this3.taskDefKey;\n\n        if (res.success) {\n          _this3.toggleSearchStatusSet = true;\n          _this3.opinionSetModal = res.result; // this.iProcSetId=this.opinionSetModal.iprocSetId;\n\n          _this3.itaskOpinionName = _this3.opinionSetModal.itaskOpinionName; //拟稿人\n\n          _this3.itaskOpinionOrder = _this3.opinionSetModal.itaskOpinionOrder; //读者\n\n          _this3.type = _this3.opinionSetModal.type; //意见框类型\n        } else {\n          _this3.opinionSetModal.iid = null;\n          _this3.toggleSearchStatusSet = false; // this.opinionSetModal.iProcSetId='';\n\n          _this3.opinionSetModal.itaskOpinionName = ''; //意见框名称\n\n          _this3.opinionSetModal.itaskOpinionOrder = 0; //意见框位置\n\n          _this3.opinionSetModal.type = ''; //意见框类型\n        }\n      });\n    },\n    onitaskOpinionOrder: function onitaskOpinionOrder() {\n      this.opinionSetModal.itaskOpinionOrder = this.itaskOpinionOrder;\n      this.jiaoYanXuh();\n    },\n    onitaskOpinionName: function onitaskOpinionName() {\n      // console.log('-=-=_+_+_+_+_+++++++',JSON.stringify(this.itaskOpinionName));\n      this.opinionSetModal.itaskOpinionName = this.itaskOpinionName;\n      this.jiaoYanXuh();\n    },\n    jiaoYanXuh: function jiaoYanXuh() {\n      var _this4 = this;\n\n      //改变时赋值并校验\n      var url = \"/oaopinionset/oaOpinionSet/queryByOrderAndKey\";\n      httpAction(url, {\n        itaskOpinionOrder: this.itaskOpinionOrder,\n        procDefKey: this.model.procDefKey\n      }, 'post').then(function (res) {\n        if (res.success) {\n          // console.log(\"ffffffffffffffffffffffffffff\");\n          // console.log(res);\n          if (res.result != null && _this4.itaskOpinionName == res.result[0].itaskOpinionName) {\n            _this4.showName = false;\n          } else {\n            if (res.result == null) {\n              _this4.showName = false;\n            } else {\n              _this4.showName = true;\n              _this4.opinionName = res.result[0].itaskOpinionName;\n            }\n          }\n        } else {\n          _this4.$message.warning(res.message);\n        }\n      });\n    },\n    //点击删除按钮 前校验\n    beforeConfirm: function beforeConfirm() {\n      var _this5 = this;\n\n      // console.log(this.btnSetModel)\n      if (this.opinionSetModal.iid == null) {\n        this.$message.warning(\"当前信息不存在\");\n      } else {\n        var url = '/oaopinionset/oaOpinionSet/verButtonSetDelete';\n        getAction(url, {\n          id: this.opinionSetModal.iid\n        }).then(function (res) {\n          if (res.success) {\n            // this.$message.success(res.message);\n            //调用弹框\n            _this5.showConfirm();\n          } else {\n            _this5.deleteOpinionSet();\n          }\n        });\n      }\n    },\n    //弹框\n    showConfirm: function showConfirm() {\n      var that = this;\n      this.$confirm({\n        title: '你确定要删除吗？',\n        content: '您的某些业务已经使用了这套意见',\n        onOk: function onOk() {\n          that.deleteOpinionSet();\n        },\n        onCancel: function onCancel() {}\n      });\n    },\n    deleteOpinionSet: function deleteOpinionSet() {\n      var _this6 = this;\n\n      if (this.opinionSetModal.iid) {\n        var that = this;\n        deleteAction(that.url.delete, {\n          id: this.opinionSetModal.iid\n        }).then(function (res) {\n          if (res.success) {\n            that.$message.success(res.message); // that.loadData();\n\n            _this6.itaskOpinionName = ''; //意见框名称\n\n            _this6.itaskOpinionOrder = 0; //意见框位置\n\n            _this6.toggleSearchStatus = false;\n            _this6.toggleSearchStatusSet = false;\n            _this6.opinionSetModal.type = ''; //意见框类型\n          } else {\n            that.$message.warning(res.message);\n          }\n        });\n      }\n    },\n    add: function add() {\n      this.edit({});\n    },\n    editBeforelvjian: function editBeforelvjian(record, TaskLinkId, res) {\n      console.log(\"fdsfasafadfasdfsadfsadfsadfas\");\n      console.log(res);\n      this.taskDefKey = res.taskDefKey;\n      this.editlvjian(record, TaskLinkId);\n    },\n    editlvjian: function editlvjian(record, TaskLinkId) {\n      var _this7 = this;\n\n      this.toggleSearchStatus = false;\n      this.itaskOpinionName = ''; //意见框名称\n\n      this.itaskOpinionOrder = 0; //意见框位置\n\n      this.opinionSetModal.type = ''; //意见框类型\n      //record---为上一页面数据，TaskLinkId---流程定义Key\n      // console.log('------------------888888888');\n\n      this.TaskLinkId = TaskLinkId;\n      console.log(this.TaskLinkId);\n      this.getTaskLinkList(); //获取任务环节下拉列表\n\n      this.getFunctionList();\n      this.form.resetFields();\n      this.model = Object.assign({}, record); // console.log(this.model);\n\n      this.sprocOpinionName = this.model.sprocOpinionName;\n      this.procDefKey = this.model.procDefKey;\n      this.visible = true; // console.log(\"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\");\n      // console.log(record);\n\n      if (this.model.procDefKey == \"sendFile_hang\") {\n        this.show = true;\n      } else {\n        this.show = false;\n      }\n\n      this.$nextTick(function () {\n        _this7.form.setFieldsValue(pick(_this7.model, 'iid', 'procDefKey', 'sprocOpinionName')); //时间格式化\n\n      }); //默认加载回显第一个\n\n      this.onTasklink();\n      this.getTypeList();\n    },\n    getFunctionList: function getFunctionList() {\n      var _this8 = this;\n\n      //获取全部业务下拉列表;\n      console.log('--------------------获取全部业务下拉列表-下拉列表------------------------------');\n      var url = \"/modify/fields/queryBusList\";\n      getAction(url, {}).then(function (res) {\n        _this8.selectList = res.result; // this.timeList = res.d_create_time;\n      });\n    },\n    getFunctionId: function getFunctionId() {// this.opinionSetModal.iprocSetId=this.iProcSetId;\n      //   console.log('----------busFunction----------queryById------------------------------');\n      //   console.log(this.opinionSetModal.iprocSetId);\n    },\n    close: function close() {\n      this.$emit('close');\n      this.visible = false;\n    },\n    handleOk: function handleOk() {\n      var _this9 = this;\n\n      // this.opinionSetModal.iProcSetId=this.iProcSetId;\n      console.log('-=-=-=', JSON.stringify(this.opinionSetModal));\n      var that = this; // 触发表单验证\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          that.confirmLoading = true;\n          var httpurl = '';\n          var method = '';\n\n          if (_this9.opinionSetModal.iid == null || _this9.opinionSetModal.iid == undefined || !_this9.opinionSetModal.iid) {\n            console.log('----------------------------------090');\n            console.log(_this9.opinionSetModal);\n            _this9.opinionSetModal.iprocOpinionId = _this9.model.iid;\n            _this9.opinionSetModal.procDefKey = _this9.model.procDefKey;\n            _this9.opinionSetModal.taskDefKey = _this9.taskDefKey;\n            httpurl += _this9.url.add;\n            method = 'post';\n          } else {\n            httpurl += _this9.url.edit;\n            method = 'put';\n          }\n\n          var formData = Object.assign(_this9.opinionSetModal, values);\n\n          if (_this9.showName == false) {\n            //校验没问题时才能提交\n            //时间格式化\n            httpAction(httpurl, formData, method).then(function (res) {\n              if (res.success) {\n                that.$message.success(res.message);\n                that.$emit('ok');\n              } else {// that.$message.warning(res.message);\n              }\n            }).finally(function () {\n              that.confirmLoading = false;\n              that.close();\n            });\n          } else {\n            that.$message.warning(\"相同序号，意见名称必须相同\");\n            that.close();\n          }\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.close();\n    }\n  }\n};",{"version":3,"sources":["OaProcOpinionNewModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    :title=\"title\"\r\n    :width=\"800\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @ok=\"handleOk\"\r\n    @cancel=\"handleCancel\"\r\n    cancelText=\"关闭\">\r\n\r\n    <a-spin :spinning=\"confirmLoading\" style=\"height: 360px;margin-left: 50px\">\r\n      <a-form :form=\"form\">\r\n\r\n        <!--<a-form-item-->\r\n          <!--:labelCol=\"labelCol\"-->\r\n          <!--:wrapperCol=\"wrapperCol\"-->\r\n          <!--label=\"主键id\">-->\r\n          <!--<a-input-number v-decorator=\"[ 'iId', validatorRules.iid ]\" />-->\r\n        <!--</a-form-item>-->\r\n        <a-form-item style=\"color: #1890ff;font-weight: 800;margin: 10px 0px\">\r\n          <span>流程定义KEY：</span>\r\n          <!--<a-input placeholder=\"请输入流程定义KEY\" v-decorator=\"['procDefKey', {}]\" />-->\r\n          <span >{{procDefKey}}</span>\r\n        </a-form-item>\r\n        <!--<a-form-item-->\r\n        <!--:labelCol=\"labelCol\"-->\r\n        <!--:wrapperCol=\"wrapperCol\"-->\r\n        <!--label=\"意见框组合名称\">-->\r\n        <!--<a-input style=\"width: 300px\" placeholder=\"请输入意见框组合名称\" v-model=\"sprocOpinionName\"/>-->\r\n          <!--<a-divider type=\"vertical\"/>-->\r\n          <!--<a-button @click=\"iTaskOpinionNewName\" type=\"primary\" icon=\"plus\">修改意见框组合名称</a-button>-->\r\n        <!--</a-form-item>-->\r\n        <!--水平分割-->\r\n        <!--<a-divider style=\"margin-top: 0px\"/>-->\r\n        <span style=\"font-weight: 1000;font-size: 16px;\">选择:</span>\r\n        <!--<a-divider/>-->\r\n        <!-- 查询区域 -->\r\n        <div class=\"table-page-search-wrapper\">\r\n          <a-form layout=\"inline\">\r\n            <a-row :gutter=\"12\">\r\n              <!--<template v-if=\"toggleSearchStatus\">-->\r\n              <a-col :md=\"10\" :sm=\"8\" style=\"margin-top: 10px;margin-left: 50px;padding-bottom: 0px\">\r\n                <a-form-item label=\"流程任务\">\r\n                  <!--<a-input placeholder=\"请输入流程任务\" v-model=\"queryParam.taskDefKey\"></a-input>-->\r\n                  <!--@change=\"handelChange\"-->\r\n                  <a-select\r\n                    placeholder=\"请选择任务环节\"\r\n                    v-model=\"taskDefKey\"\r\n                    @change=\"onTasklink\">\r\n                    <a-select-option v-for=\"Activity in TaskLinkList\" :value=\"Activity.id\">\r\n                      {{ Activity.name }}\r\n                    </a-select-option>\r\n                  </a-select>\r\n                </a-form-item>\r\n              </a-col>\r\n              <a-col>\r\n                <a-button style=\"margin-top: 10px;margin-left: 10px;\" v-if=\"toggleSearchStatusSet\"   @click=\"beforeConfirm\" type=\"primary\" icon=\"plus\">删除当前配置</a-button>\r\n              </a-col>\r\n              <!--<a-col :md=\"6\" :sm=\"8\">-->\r\n                <!--<a-form-item label=\"按钮列表\">-->\r\n                  <!--&lt;!&ndash;<a-input placeholder=\"请输入按钮名称\" v-model=\"queryParam.iButtonId\"></a-input>&ndash;&gt;-->\r\n                  <!--<a-select-->\r\n                    <!--placeholder=\"请选择按钮名称\"-->\r\n                    <!--v-model=\"iButtonId\"-->\r\n                    <!--@change=\"getButtonSetInfo\">-->\r\n                    <!--<a-select-option  v-for=\"(oaButton,index) in buttonList\" :key=\"index\" :value=\"oaButton.iid\">-->\r\n                      <!--{{ oaButton.sbtnName }}-->\r\n                    <!--</a-select-option>-->\r\n                  <!--</a-select>-->\r\n                <!--</a-form-item>-->\r\n              <!--</a-col>-->\r\n              <!--</template>-->\r\n              <!--<a-col :md=\"6\" :sm=\"8\" >-->\r\n              <!--<span style=\"float: left;overflow: hidden;\" class=\"table-page-search-submitButtons\">-->\r\n              <!--<a-button type=\"primary\" @click=\"searchQuery\" icon=\"search\">查询</a-button>-->\r\n              <!--<a-button type=\"primary\" @click=\"searchReset\" icon=\"reload\" style=\"margin-left: 8px\">重置</a-button>-->\r\n              <!--<a @click=\"handleToggleSearch\" style=\"margin-left: 8px\">-->\r\n              <!--{{ toggleSearchStatus ? '收起' : '展开' }}-->\r\n              <!--<a-icon :type=\"toggleSearchStatus ? 'up' : 'down'\"/>-->\r\n              <!--</a>-->\r\n              <!--</span>-->\r\n              <!--</a-col>-->\r\n            </a-row>\r\n          </a-form>\r\n        </div>\r\n\r\n        <!--水平分割-->\r\n        <!--<a-divider style=\"margin: 0px\"/>-->\r\n        <!-- table区域-begin -->\r\n        <!-- table区域-end -->\r\n        <span style=\"font-weight: 1000;font-size: 16px;\">配置:（位置相同名称必须一致）</span>\r\n        <!-- 表单区域 -->\r\n        <div>\r\n          <a-form>\r\n            <a-row :gutter=\"48\" style=\"margin-left: 25px\">\r\n              <template v-if=\"toggleSearchStatus\">\r\n                <!--<a-divider type=\"vertical\" style=\"margin-left: 110px;\"/>-->\r\n                <!--<a-divider type=\"vertical\"/>-->\r\n                <!--<a-form-item-->\r\n                <!--:labelCol=\"labelCol\"-->\r\n                <!--:wrapperCol=\"wrapperCol\"-->\r\n                <!--label=\"流程按钮关联ID\">-->\r\n                <!--<a-input-number v-decorator=\"[ 'iprocOpinionId', {}]\" />-->\r\n                <!--</a-form-item>-->\r\n                <!--<a-form-item-->\r\n                <!--:labelCol=\"labelCol\"-->\r\n                <!--:wrapperCol=\"wrapperCol\"-->\r\n                <!--label=\"业务流程配置ID\">-->\r\n                <!--<a-input-number v-decorator=\"[ 'iprocSetId', {}]\" />-->\r\n                <!--</a-form-item>-->\r\n                  <!--<a-form-item-->\r\n                    <!--:labelCol=\"labelCol\"-->\r\n                    <!--:wrapperCol=\"wrapperCol\"-->\r\n                    <!--label=\"业务功能\">-->\r\n                    <!--<a-select v-model=\"iProcSetId\" @change=\"getFunctionId\">-->\r\n                      <!--<a-select-option v-for=\"(item,index) in selectList\" :key=\"index\" :value=\"item.iprocSetId\">{{item.sname}}-->\r\n                      <!--</a-select-option>-->\r\n                    <!--</a-select>-->\r\n                  <!--</a-form-item>-->\r\n                <a-form-item\r\n                  style=\"margin:20px;\">\r\n                  <span>页面意见框位置：</span>\r\n                  <a-input-number @change=\"onitaskOpinionOrder\" v-model=\"itaskOpinionOrder\" />\r\n                </a-form-item>\r\n                <a-form-item\r\n                  style=\"margin:20px;\">\r\n                  <span>页面意见框名称：</span>\r\n                  <a-input style=\"width: 180px\" @change=\"onitaskOpinionName\" v-model=\"itaskOpinionName\" />\r\n                  <span v-show=\"showName\" style=\"margin-left: 10px;color: red\">序号为{{itaskOpinionOrder}}的意见框名字必须为\"{{opinionName}}\"。</span>\r\n                </a-form-item>\r\n\r\n<!--<div v-show=\"show\">-->\r\n<div>\r\n  <a-form-item  style=\"margin:20px;\">\r\n    <span>办文单意见类型:</span>\r\n    <a-select style=\"margin-left:15px;width: 330px\" v-model=\"type\" @change=\"getType\">\r\n      <a-select-option v-for=\"(item,index) in typeList\" :key=\"index\" :value=\"item.itemValue\">{{item.itemText}}\r\n      </a-select-option>\r\n    </a-select>\r\n  </a-form-item>\r\n</div>\r\n\r\n\r\n                <!--<a-form-item-->\r\n                  <!--:labelCol=\"labelCol\"-->\r\n                  <!--:wrapperCol=\"wrapperCol\"-->\r\n                  <!--label=\"\">-->\r\n                  <!--<a-input-hide v-model=\"procDefKey\" />-->\r\n                <!--</a-form-item>-->\r\n              </template>\r\n            </a-row>\r\n          </a-form>\r\n        </div>\r\n\r\n\r\n      </a-form>\r\n    </a-spin>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import {httpAction,getAction,postAction,deleteAction} from '@/api/manage'\r\n  import pick from 'lodash.pick'\r\n  import moment from \"moment\"\r\n  import {JeecgListMixin} from '@/mixins/JeecgListMixin'\r\n  import ACol from \"ant-design-vue/es/grid/Col\";\r\n\r\n\r\n  export default {\r\n    name: \"OaProcOpinionNewModal\",\r\n    mixins: [JeecgListMixin],\r\n    components: {\r\n      ACol\r\n    },\r\n    data() {\r\n      return {\r\n        title: \"操作\",\r\n        visible: false,\r\n        show:false,//意见类型--显示控制\r\n        procDefKey:'',\r\n        showName:false,//是否显示提示\r\n        opinionName:'',//后台产生的名字\r\n        typeList:[],\r\n        taskDefKey:'',\r\n        type:'',//意见框类型：取数据字典下拉列表\r\n        sprocOpinionName:'',//意见组合名称\r\n        model: {},\r\n        labelCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 5},\r\n        },\r\n        wrapperCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 16},\r\n        },\r\n        opinionSetModal:{\r\n          itaskOpinionName:'',//意见框名称\r\n          itaskOpinionOrder:0,//意见框位置\r\n        },\r\n        itaskOpinionName:'',//意见框名称\r\n        itaskOpinionOrder:0,//意见框位置\r\n        TaskLinkList:[],//任务环节列表\r\n        TaskLinkId:'',//流程定义Id\r\n//业务模块---------------\r\n//         selectList: [],\r\n        // timeList:[],\r\n        // iProcSetId:'',\r\n\r\n\r\n        confirmLoading: false,\r\n        toggleSearchStatusSet:true,\r\n        form: this.$form.createForm(this),\r\n        validatorRules: {\r\n          iId: {rules: [{required: true, message: '请输入主键id!'}]},\r\n        },\r\n        url: {\r\n          list: \"/oaopinionset/oaOpinionSet/list\",\r\n          delete: \"/oaopinionset/oaOpinionSet/delete\",\r\n          deleteBatch: \"/oaopinionset/oaOpinionSet/deleteBatch\",\r\n          exportXlsUrl: \"oaopinionset/oaOpinionSet/exportXls\",\r\n          importExcelUrl: \"oaopinionset/oaOpinionSet/importExcel\",\r\n          add: \"/oaopinionset/oaOpinionSet/add\",\r\n          edit: \"/oaopinionset/oaOpinionSet/edit\"\r\n        }\r\n      }\r\n    },\r\n    created() {\r\n\r\n    },\r\n    computed: {\r\n      importExcelUrl: function () {\r\n        return `${window._CONFIG['domianURL']}/${this.url.importExcelUrl}`;\r\n      }\r\n    },\r\n    methods: {\r\n      //\r\n      getType(){\r\n        this.opinionSetModal.type=this.type\r\n      },\r\n      //修改意见组合名称\r\n      iTaskOpinionNewName(){\r\n        const that = this;\r\n        let httpurl = '';\r\n        let method = '';\r\n        if (!this.model.iid) {\r\n          httpurl += this.url.add;\r\n          method = 'post';\r\n        } else {\r\n          httpurl += this.url.edit;\r\n          method = 'put';\r\n        }\r\n        this.model.sprocOpinionName=this.sprocOpinionName;\r\n        // let formData = Object.assign(this.model, values);\r\n        httpAction(httpurl, {iid:this.model.iid,sprocOpinionName:this.model.sprocOpinionName,\r\n          procDefKey: this.model.procDefKey}, method).then((res) => {\r\n          if (res.success) {\r\n            that.$message.success(res.message);\r\n            that.$emit('ok');\r\n          } else {\r\n            that.$message.warning(res.message);\r\n          }\r\n        })\r\n      },\r\n      getTypeList(){//获取任务环节\r\n      let url=\"/sys/dict/getDictByKey\";\r\n      getAction(url, {dictKey: 'type'}).then(res => {\r\n        console.log('--------------------意见类型-下拉列表------------------------------');\r\n        console.log(res);\r\n        this.typeList=res.result;\r\n      });\r\n      },\r\n      getTaskLinkList(){//获取任务环节\r\n        let url=\"/wf/process/actsList\";\r\n        getAction(url, {processDefinitionId: this.TaskLinkId}).then(res => {\r\n          this.TaskLinkList = res.result;\r\n          if (this.taskDefKey==null||this.taskDefKey==''){\r\n            this.taskDefKey=this.TaskLinkList[0].id;//得到默认值\r\n          }\r\n          this.onTasklink();\r\n        });\r\n      },\r\n      onTasklink() {//请求表单数据\r\n        //初始化\r\n        this.showName==false//隐藏错误\r\n        this.toggleSearchStatus=true;\r\n        this.itaskOpinionName='';//意见框名称\r\n        this.itaskOpinionOrder=0;//意见框位置\r\n        // this.iProcSetId='';\r\n        let url=\"/oaopinionset/oaOpinionSet/queryByTaskDefKey\";\r\n        postAction(url, {taskDefKey: this.taskDefKey,iProcOpinionId: this.model.iid,procDefKey: this.procDefKey}).then(res => {\r\n          console.log('0000000000000000000000000000000');\r\n          console.log(res.result);\r\n          this.model.taskDefKey=this.taskDefKey;\r\n          if (res.success) {\r\n            this.toggleSearchStatusSet=true;\r\n            this.opinionSetModal=res.result;\r\n            // this.iProcSetId=this.opinionSetModal.iprocSetId;\r\n            this.itaskOpinionName=this.opinionSetModal.itaskOpinionName;//拟稿人\r\n            this.itaskOpinionOrder=this.opinionSetModal.itaskOpinionOrder; //读者\r\n            this.type=this.opinionSetModal.type//意见框类型\r\n          } else {\r\n            this.opinionSetModal.iid = null;\r\n            this.toggleSearchStatusSet=false;\r\n            // this.opinionSetModal.iProcSetId='';\r\n            this.opinionSetModal.itaskOpinionName='';//意见框名称\r\n            this.opinionSetModal.itaskOpinionOrder=0;//意见框位置\r\n            this.opinionSetModal.type=''//意见框类型\r\n          }\r\n\r\n        })\r\n      },\r\n      onitaskOpinionOrder(){\r\n        this.opinionSetModal.itaskOpinionOrder=this.itaskOpinionOrder;\r\n        this.jiaoYanXuh();\r\n      },\r\n      onitaskOpinionName(){\r\n        // console.log('-=-=_+_+_+_+_+++++++',JSON.stringify(this.itaskOpinionName));\r\n        this.opinionSetModal.itaskOpinionName=this.itaskOpinionName;\r\n        this.jiaoYanXuh();\r\n      },\r\n      jiaoYanXuh(){//改变时赋值并校验\r\n        let url=\"/oaopinionset/oaOpinionSet/queryByOrderAndKey\";\r\n        httpAction(url, {itaskOpinionOrder:this.itaskOpinionOrder,\r\n          procDefKey: this.model.procDefKey}, 'post').then((res) => {\r\n          if (res.success) {\r\n            // console.log(\"ffffffffffffffffffffffffffff\");\r\n            // console.log(res);\r\n            if (res.result!=null && this.itaskOpinionName==res.result[0].itaskOpinionName){\r\n              this.showName=false;\r\n            } else {\r\n              if (res.result==null){\r\n              this.showName=false;\r\n              }else {\r\n                this.showName=true;\r\n                this.opinionName=res.result[0].itaskOpinionName;\r\n              }\r\n            }\r\n          } else {\r\n            this.$message.warning(res.message);\r\n          }\r\n        })\r\n      },\r\n      //点击删除按钮 前校验\r\n      beforeConfirm(){\r\n        // console.log(this.btnSetModel)\r\n        if (this.opinionSetModal.iid==null){\r\n          this.$message.warning(\"当前信息不存在\");\r\n        }else {\r\n          let url='/oaopinionset/oaOpinionSet/verButtonSetDelete';\r\n          getAction(url,{id:this.opinionSetModal.iid}).then(res=>{\r\n            if (res.success){\r\n              // this.$message.success(res.message);\r\n              //调用弹框\r\n              this.showConfirm();\r\n            } else {\r\n              this.deleteOpinionSet();\r\n            }\r\n          });\r\n        }\r\n\r\n\r\n      },\r\n      //弹框\r\n      showConfirm(){\r\n        let that=this;\r\n        this.$confirm({\r\n          title:'你确定要删除吗？',\r\n          content:'您的某些业务已经使用了这套意见',\r\n          onOk(){\r\n            that.deleteOpinionSet();\r\n          },\r\n          onCancel(){\r\n          }\r\n        })\r\n      },\r\n      deleteOpinionSet(){\r\n        if (this.opinionSetModal.iid){\r\n          var that = this;\r\n          deleteAction(that.url.delete, {id: this.opinionSetModal.iid}).then((res) => {\r\n            if (res.success) {\r\n              that.$message.success(res.message);\r\n              // that.loadData();\r\n              this.itaskOpinionName='';//意见框名称\r\n              this.itaskOpinionOrder=0;//意见框位置\r\n              this.toggleSearchStatus=false;\r\n              this.toggleSearchStatusSet=false;\r\n              this.opinionSetModal.type=''//意见框类型\r\n            } else {\r\n              that.$message.warning(res.message);\r\n            }\r\n          });\r\n        }\r\n      },\r\n      add() {\r\n        this.edit({});\r\n      },\r\n      editBeforelvjian(record,TaskLinkId,res){\r\n        console.log(\"fdsfasafadfasdfsadfsadfsadfas\")\r\n        console.log(res);\r\n        this.taskDefKey= res.taskDefKey;\r\n        this.editlvjian(record,TaskLinkId);\r\n      },\r\n      editlvjian(record,TaskLinkId) {\r\n        this.toggleSearchStatus=false;\r\n        this.itaskOpinionName='';//意见框名称\r\n        this.itaskOpinionOrder=0;//意见框位置\r\n        this.opinionSetModal.type=''//意见框类型\r\n        //record---为上一页面数据，TaskLinkId---流程定义Key\r\n        // console.log('------------------888888888');\r\n        this.TaskLinkId=TaskLinkId;\r\n        console.log(this.TaskLinkId);\r\n        this.getTaskLinkList();//获取任务环节下拉列表\r\n        this.getFunctionList();\r\n        this.form.resetFields();\r\n        this.model = Object.assign({}, record);\r\n        // console.log(this.model);\r\n        this.sprocOpinionName=this.model.sprocOpinionName;\r\n        this.procDefKey=this.model.procDefKey;\r\n        this.visible = true;\r\n        // console.log(\"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\");\r\n        // console.log(record);\r\n        if (this.model.procDefKey==\"sendFile_hang\"){\r\n          this.show=true;\r\n        }else {\r\n          this.show=false;\r\n        }\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.model, 'iid', 'procDefKey','sprocOpinionName'))\r\n          //时间格式化\r\n        });\r\n        //默认加载回显第一个\r\n        this.onTasklink();\r\n        this.getTypeList();\r\n      },\r\n      getFunctionList(){//获取全部业务下拉列表;\r\n        console.log('--------------------获取全部业务下拉列表-下拉列表------------------------------');\r\n\r\n        let url = \"/modify/fields/queryBusList\";\r\n        getAction(url, {}).then((res) => {\r\n\r\n          this.selectList = res.result;\r\n          // this.timeList = res.d_create_time;\r\n        });\r\n      },\r\n      getFunctionId(){\r\n        // this.opinionSetModal.iprocSetId=this.iProcSetId;\r\n        //   console.log('----------busFunction----------queryById------------------------------');\r\n        //   console.log(this.opinionSetModal.iprocSetId);\r\n      },\r\n      close() {\r\n        this.$emit('close');\r\n        this.visible = false;\r\n      },\r\n\r\n      handleOk() {\r\n        // this.opinionSetModal.iProcSetId=this.iProcSetId;\r\n        console.log('-=-=-=',JSON.stringify(this.opinionSetModal));\r\n        const that = this;\r\n        // 触发表单验证\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            that.confirmLoading = true;\r\n            let httpurl = '';\r\n            let method = '';\r\n            if (this.opinionSetModal.iid==null || this.opinionSetModal.iid == undefined || !this.opinionSetModal.iid) {\r\n              console.log('----------------------------------090');\r\n              console.log(this.opinionSetModal);\r\n              this.opinionSetModal.iprocOpinionId=this.model.iid;\r\n              this.opinionSetModal.procDefKey=this.model.procDefKey;\r\n              this.opinionSetModal.taskDefKey=this.taskDefKey;\r\n              httpurl += this.url.add;\r\n              method = 'post';\r\n            } else {\r\n              httpurl += this.url.edit;\r\n              method = 'put';\r\n            }\r\n            let formData = Object.assign(this.opinionSetModal, values);\r\n            if (this.showName==false){//校验没问题时才能提交\r\n              //时间格式化\r\n              httpAction(httpurl, formData, method).then((res) => {\r\n                if (res.success) {\r\n                  that.$message.success(res.message);\r\n                  that.$emit('ok');\r\n                } else {\r\n                  // that.$message.warning(res.message);\r\n                }\r\n              }).finally(() => {\r\n                that.confirmLoading = false;\r\n                that.close();\r\n              })\r\n            }else {\r\n              that.$message.warning(\"相同序号，意见名称必须相同\");\r\n              that.close();\r\n            }\r\n\r\n          }\r\n        })\r\n      },\r\n      handleCancel() {\r\n        this.close()\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>"],"sourceRoot":"src/views/workflow/modules/opinion"}]}