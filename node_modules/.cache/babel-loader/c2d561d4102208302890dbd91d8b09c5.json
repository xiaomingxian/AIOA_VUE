{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\oaBus\\modules\\BusPageDetailDefModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\oaBus\\modules\\BusPageDetailDefModal.vue","mtime":1579052728627},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { httpAction, getAction, postAction } from '@/api/manage';\nimport pick from 'lodash.pick';\nimport moment from \"moment\";\nexport default {\n  name: \"BusPageDetailDefModal\",\n  data: function data() {\n    return {\n      title: \"操作\",\n      visible: false,\n      model: {},\n      directOpt: [],\n      sqlOpt: [],\n      regulars: [],\n      //列输入类型\n      columnTypeList: [],\n      stableColumn: '',\n      disableFlag: false,\n      titleModel: '',\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 6\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 18\n        }\n      },\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      validatorRules: {\n        iId: {\n          rules: [{\n            required: true,\n            message: '请输入主键id!'\n          }]\n        }\n      },\n      url: {\n        add: \"/oaBus/busPageDetail/add\",\n        edit: \"/oaBus/busPageDetail/edit\",\n        editOrAdd: \"/oaBus/busPageDetail/editOrAdd\",\n        queryDirect: \"/oaBus/busPageDetail/queryDirect\",\n        getInitDict: \"/oaBus/busPage/getInitDict\",\n        columnTypeDict: \"/sys/dict/getDictByKeyObj\",\n        updateDetail: \"/oaBus/busPageDetail/updateDetail\"\n      }\n    };\n  },\n  created: function created() {},\n  methods: {\n    updateDetail: function updateDetail(value) {\n      var param = {\n        ibusPageId: this.model.ibusPageId,\n        stableColumn: this.model.stableColumn\n      };\n      /*console.log(this.model)\n      this.$nextTick(() => {\n        this.form.setFieldsValue(pick(this.model, 'iid', 'ibusPageId', 'ibusFunctionId', 'sbusdataTable', 'stableColumn','icolumnType', 'scolumnName', 'iisListtitle','iorder','iisListquery', 'sdictId', 'sdictSqlKey', 'icheckIsNull', 'scheckExpjava', 'scheckExpsql', 'icheckExpjs', 'scheckShowmsg', 'ssendKey', 'sarchivesKey', 'iisDefault','smarkKey' ,'isetType', 'scolumnRemarks'))\n        //时间格式化\n      });*/\n\n      param[value] = this.form.getFieldValue(value);\n\n      if (param[value] == undefined || param[value] == null || param[value] == \"\") {\n        this.$message.error(\"请填写对应的值！！！\");\n      } else {\n        postAction(this.url.updateDetail, param).then(function (res) {\n          console.log(res);\n        });\n      }\n    },\n    listTitleChange: function listTitleChange(params) {\n      var _this = this;\n\n      var param = params.target.value; //alert(JSON.stringify(param.target.value))\n\n      var str = this.model.stableColumn;\n\n      if (str == \"s_title\") {\n        if (param == 0 || param == \"0\") {\n          this.model.iisListtitle = 1;\n          this.$message.error(\"标题必须显示！！！\");\n          this.$nextTick(function () {\n            _this.form.setFieldsValue(pick(_this.model, 'iisListtitle'));\n          });\n        }\n      }\n    },\n    //dictId点击后sql为空\n    dictIdClick: function dictIdClick() {\n      this.form.setFieldsValue({\n        sdictSqlKey: null\n      });\n    },\n    //sql点击后dictId为空\n    dictSqlClick: function dictSqlClick() {\n      this.form.setFieldsValue({\n        sdictId: null\n      });\n    },\n    getInitDict: function getInitDict() {\n      var _this2 = this;\n\n      getAction(this.url.getInitDict).then(function (rec) {\n        _this2.directOpt = rec.result.dicList;\n        _this2.sqlOpt = rec.result.dictByCodeList;\n        _this2.regulars = rec.result.regulars;\n\n        for (var i = 0; i < _this2.regulars.length; i++) {\n          _this2.regulars[i].value = parseInt(_this2.regulars[i].value);\n        }\n      });\n      getAction(this.url.columnTypeDict, {\n        dictKey: \"columnType\"\n      }).then(function (res) {\n        _this2.columnTypeList = res.result;\n      });\n    },\n    add: function add() {\n      this.edit({});\n    },\n    show: function show() {\n      this.visible = true;\n    },\n    edit: function edit(record, ibusPageId, ibusFunctionId, sbusdataTable) {\n      var _this3 = this;\n\n      this.getInitDict();\n      this.form.resetFields();\n      this.model = Object.assign({}, record);\n      this.model.ibusPageId = ibusPageId;\n      this.model.ibusFunctionId = ibusFunctionId;\n      this.model.sbusdataTable = sbusdataTable;\n\n      if (this.model.stableColumn == 's_title') {\n        this.model.iisListtitle = 1;\n      }\n\n      this.visible = true;\n      this.$nextTick(function () {\n        _this3.form.setFieldsValue(pick(_this3.model, 'iid', 'ibusPageId', 'ibusFunctionId', 'sbusdataTable', 'stableColumn', 'icolumnType', 'scolumnName', 'iisListtitle', 'iorder', 'iisListquery', 'sdictId', 'sdictSqlKey', 'icheckIsNull', 'scheckExpjava', 'scheckExpsql', 'icheckExpjs', 'scheckShowmsg', 'ssendKey', 'sarchivesKey', 'iisDefault', 'smarkKey', 'isetType', 'scolumnRemarks')); //时间格式化\n\n      });\n    },\n    close: function close() {\n      this.$emit('close');\n      this.visible = false;\n    },\n    handleOk: function handleOk() {\n      var _this4 = this;\n\n      var that = this; // 触发表单验证\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          that.confirmLoading = true;\n          var httpurl = _this4.url.editOrAdd;\n          var method = 'put';\n          var formData = Object.assign(_this4.model, values);\n          httpAction(httpurl, formData, method).then(function (res) {\n            if (res.success) {\n              that.$message.success(res.message);\n              that.$emit('ok');\n            } else {\n              that.$message.warning(res.message);\n            }\n          }).finally(function () {\n            that.confirmLoading = false;\n            that.close();\n            that.$emit('loading');\n          });\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.close();\n    }\n  }\n};",{"version":3,"sources":["BusPageDetailDefModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    :title=\"title\"\r\n    :width=\"800\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @ok=\"handleOk\"\r\n    @cancel=\"handleCancel\"\r\n    cancelText=\"关闭\">\r\n\r\n    <div style=\"height: 500px;overflow: auto\">\r\n      <a-spin :spinning=\"confirmLoading\">\r\n        <a-form :form=\"form\">\r\n\r\n          <div v-show=\"false\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"业务页面id\">\r\n              <a-input-number v-decorator=\"[ 'ibusPageId', {}]\"/>\r\n            </a-form-item>\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"业务功能id\">\r\n              <a-input-number v-decorator=\"[ 'ibusFunctionId', {}]\"/>\r\n            </a-form-item>\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"业务数据表名\">\r\n              <a-input placeholder=\"请输入业务数据表名\" v-decorator=\"['sbusdataTable', {}]\"/>\r\n            </a-form-item>\r\n          </div>\r\n\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"字段名\">\r\n            <a-input placeholder=\"请输入字段名\" v-model=\"stableColumn\"  v-decorator=\"['stableColumn', {}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"列名\">\r\n            <a-input placeholder=\"列名\" v-decorator=\"['scolumnName', {rules:[{required:true}]}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"列输入类型\">\r\n            <a-select v-decorator=\"[ 'icolumnType', {}]\" >\r\n              <a-select-option v-for=\"(item,index) in columnTypeList\" :key=\"index\" :value=\"parseInt(item.value)\">\r\n                {{item.text}}\r\n              </a-select-option>\r\n            </a-select>\r\n            <!--<a-input-number v-decorator=\"[ 'iBusModelId', {}]\" />-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"标题列\">\r\n            <a-radio-group ref=\"refTitle\"\r\n                           v-model=\"titleModel\"\r\n                           :disabled=\"disableFlag\"\r\n                           @change=\"listTitleChange\"\r\n                            v-decorator=\"['iisListtitle', {}]\">\r\n              <a-radio  :value=\"1\">是</a-radio>\r\n              <a-radio  :value=\"0\">否</a-radio>\r\n            </a-radio-group>\r\n            <!--<a-input placeholder=\"请输入是否作为列表标题列\" />-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"数据列排序\">\r\n            <a-input-number v-decorator=\"[ 'iorder', {}]\" />\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"查询条件\">\r\n            <a-radio-group  :defaultValue=\"0\" v-decorator=\"['iisListquery', {}]\">\r\n              <a-radio :value=\"1\">是</a-radio>\r\n              <a-radio :value=\"0\">否</a-radio>\r\n            </a-radio-group>\r\n            <!--<a-input placeholder=\"请输入是否作为列表查询条件\" v-decorator=\"['iisListquery', {}]\"/>-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"数据字典类别\">\r\n            <a-select @change=\"dictIdClick\" v-decorator=\"[ 'sdictId', {}]\" >\r\n              <a-select-option v-for=\"(item,index) in directOpt\" :key=\"index\" :value=\"item.dictCode\">\r\n                {{item.dictName}}\r\n              </a-select-option>\r\n            </a-select>\r\n            <!--<a-input-number v-decorator=\"[ 'iBusModelId', {}]\" />-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"查询sql\">\r\n            <a-select v-decorator=\"[ 'sdictSqlKey', {}]\" @change=\"dictSqlClick\">\r\n              <a-select-option v-for=\"(item,index) in sqlOpt\" :key=\"index\" :value=\"item.value\">\r\n                {{item.text}}\r\n              </a-select-option>\r\n            </a-select>\r\n            <!--<a-input-number v-decorator=\"[ 'iBusModelId', {}]\" />-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"必填校验\">\r\n            <a-radio-group :defaultValue=\"0\" v-decorator=\"['icheckIsNull', {}]\">\r\n              <a-radio :value=\"1\">是</a-radio>\r\n              <a-radio :value=\"0\">否</a-radio>\r\n            </a-radio-group>\r\n            <!--<a-input placeholder=\"请输入是否必填校验\" />-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"java校验\">\r\n            <a-input placeholder=\"请输入java校验规则，正则表达式\" v-decorator=\"['scheckExpjava', {}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"sql校验\">\r\n            <a-input placeholder=\"请输入数据校验sql\" v-decorator=\"['scheckExpsql', {}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"js校验\">\r\n            <a-select v-decorator=\"[ 'icheckExpjs', {}]\">\r\n              <a-select-option v-for=\"(item,index) in regulars\" :key=\"index\" :value=\"item.value\">\r\n                {{item.text}}\r\n              </a-select-option>\r\n            </a-select>\r\n            <!--<a-input-number placeholder=\"请输入js校验规则，正则表达式（从数据字典查）\" v-decorator=\"['icheckExpjs', {}]\"/>-->\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"提示信息\">\r\n            <a-input placeholder=\"请输入校验提示信息\" v-decorator=\"['scheckShowmsg', {}]\"/>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"公文传输字段\">\r\n            <a-input style=\"width: calc(100% - 202px);\" placeholder=\"请输入对应公文传输字段\" v-decorator=\"['ssendKey', {}]\"/>\r\n            <span style=\"display: inline-block;width:200px;float: right;overflow: hidden;\">\r\n              <a-button type=\"primary\" @click=\"updateDetail('ssendKey')\"  style=\"width: 200px\">修改全部公文传输字段</a-button>\r\n            </span>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"档案系统字段\">\r\n            <a-input style=\"width: calc(100% - 202px);\" placeholder=\"请输入档案系统对应字段\" v-decorator=\"['sarchivesKey', {}]\"/>\r\n            <span style=\"display: inline-block;width:200px;float: right;overflow: hidden;\">\r\n              <a-button type=\"primary\" @click=\"updateDetail('sarchivesKey')\"  style=\"width: 200px\">修改全部档案系统对应字段</a-button>\r\n            </span>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"书签字段\">\r\n            <a-input style=\"width: calc(100% - 202px);\" placeholder=\"书签字段\" v-decorator=\"['smarkKey', {}]\"/>\r\n            <span style=\"display: inline-block;width:200px;float: right;overflow: hidden;\">\r\n              <a-button type=\"primary\" @click=\"updateDetail('smarkKey')\"  style=\"width: 200px\">修改全部书签字段</a-button>\r\n            </span>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :labelCol=\"labelCol\"\r\n            :wrapperCol=\"wrapperCol\"\r\n            label=\"备注\">\r\n            <a-input placeholder=\"请输入业务数据列备注\" v-decorator=\"['scolumnRemarks', {}]\"/>\r\n          </a-form-item>\r\n\r\n        </a-form>\r\n      </a-spin>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import {httpAction, getAction,postAction} from '@/api/manage'\r\n  import pick from 'lodash.pick'\r\n  import moment from \"moment\"\r\n\r\n  export default {\r\n    name: \"BusPageDetailDefModal\",\r\n    data() {\r\n      return {\r\n        title: \"操作\",\r\n        visible: false,\r\n        model: {},\r\n        directOpt: [],\r\n        sqlOpt: [],\r\n        regulars: [],\r\n        //列输入类型\r\n        columnTypeList: [],\r\n        stableColumn: '',\r\n        disableFlag: false,\r\n        titleModel: '',\r\n        labelCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 6},\r\n        },\r\n        wrapperCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 18},\r\n        },\r\n        confirmLoading: false,\r\n        form: this.$form.createForm(this),\r\n        validatorRules: {\r\n          iId: {rules: [{required: true, message: '请输入主键id!'}]},\r\n        },\r\n        url: {\r\n          add: \"/oaBus/busPageDetail/add\",\r\n          edit: \"/oaBus/busPageDetail/edit\",\r\n          editOrAdd: \"/oaBus/busPageDetail/editOrAdd\",\r\n          queryDirect: \"/oaBus/busPageDetail/queryDirect\",\r\n          getInitDict: \"/oaBus/busPage/getInitDict\",\r\n          columnTypeDict: \"/sys/dict/getDictByKeyObj\",\r\n          updateDetail: \"/oaBus/busPageDetail/updateDetail\",\r\n        },\r\n      }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n      updateDetail(value){\r\n        let param ={\r\n          ibusPageId:this.model.ibusPageId ,\r\n          stableColumn:this.model.stableColumn\r\n        };\r\n        /*console.log(this.model)\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.model, 'iid', 'ibusPageId', 'ibusFunctionId', 'sbusdataTable', 'stableColumn','icolumnType', 'scolumnName', 'iisListtitle','iorder','iisListquery', 'sdictId', 'sdictSqlKey', 'icheckIsNull', 'scheckExpjava', 'scheckExpsql', 'icheckExpjs', 'scheckShowmsg', 'ssendKey', 'sarchivesKey', 'iisDefault','smarkKey' ,'isetType', 'scolumnRemarks'))\r\n          //时间格式化\r\n        });*/\r\n        param[value]=this.form.getFieldValue(value) ;\r\n        if(param[value]==undefined || param[value]==null || param[value]==\"\"){\r\n          this.$message.error(\"请填写对应的值！！！\")\r\n        }else{\r\n          postAction(this.url.updateDetail,param).then(res =>{\r\n            console.log(res)\r\n          })\r\n        }\r\n      },\r\n      listTitleChange(params){\r\n        let param = params.target.value\r\n        //alert(JSON.stringify(param.target.value))\r\n        let str = this.model.stableColumn ;\r\n        if(str == \"s_title\"){\r\n          if(param == 0 || param == \"0\"){\r\n            this.model.iisListtitle = 1 ;\r\n            this.$message.error(\"标题必须显示！！！\");\r\n            this.$nextTick(() => {\r\n              this.form.setFieldsValue(pick(this.model, 'iisListtitle'))\r\n            });\r\n          }\r\n        }\r\n      },\r\n      //dictId点击后sql为空\r\n      dictIdClick(){\r\n        this.form.setFieldsValue({\r\n          sdictSqlKey: null,\r\n        });\r\n      },\r\n      //sql点击后dictId为空\r\n      dictSqlClick(){\r\n        this.form.setFieldsValue({\r\n          sdictId: null,\r\n        });\r\n      },\r\n      getInitDict() {\r\n        getAction(this.url.getInitDict).then(rec => {\r\n          this.directOpt = rec.result.dicList;\r\n          this.sqlOpt = rec.result.dictByCodeList;\r\n          this.regulars = rec.result.regulars;\r\n\r\n          for(let i = 0;i < this.regulars.length;i++){\r\n            this.regulars[i].value = parseInt(this.regulars[i].value);\r\n          }\r\n\r\n        });\r\n        getAction(this.url.columnTypeDict,{dictKey:\"columnType\"}).then(res=>{\r\n          this.columnTypeList = res.result ;\r\n        })\r\n      },\r\n      add() {\r\n        this.edit({});\r\n      },\r\n      show() {\r\n        this.visible = true;\r\n      },\r\n      edit(record, ibusPageId, ibusFunctionId, sbusdataTable) {\r\n        this.getInitDict();\r\n        this.form.resetFields();\r\n        this.model = Object.assign({}, record);\r\n        this.model.ibusPageId = ibusPageId;\r\n        this.model.ibusFunctionId = ibusFunctionId;\r\n        this.model.sbusdataTable = sbusdataTable;\r\n        if(this.model.stableColumn == 's_title'){\r\n          this.model.iisListtitle = 1;\r\n        }\r\n        this.visible = true;\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.model, 'iid', 'ibusPageId', 'ibusFunctionId', 'sbusdataTable', 'stableColumn','icolumnType', 'scolumnName', 'iisListtitle','iorder','iisListquery', 'sdictId', 'sdictSqlKey', 'icheckIsNull', 'scheckExpjava', 'scheckExpsql', 'icheckExpjs', 'scheckShowmsg', 'ssendKey', 'sarchivesKey', 'iisDefault','smarkKey' ,'isetType', 'scolumnRemarks'))\r\n          //时间格式化\r\n        });\r\n      },\r\n      close() {\r\n\r\n\r\n        this.$emit('close');\r\n        this.visible = false;\r\n      },\r\n      handleOk() {\r\n        const that = this;\r\n        // 触发表单验证\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            that.confirmLoading = true;\r\n            let httpurl = this.url.editOrAdd;\r\n            let method = 'put';\r\n\r\n            let formData = Object.assign(this.model, values);\r\n            httpAction(httpurl, formData, method).then((res) => {\r\n              if (res.success) {\r\n                that.$message.success(res.message);\r\n                that.$emit('ok');\r\n              } else {\r\n                that.$message.warning(res.message);\r\n              }\r\n            }).finally(() => {\r\n              that.confirmLoading = false;\r\n              that.close();\r\n              that.$emit('loading');\r\n            })\r\n\r\n\r\n          }\r\n        })\r\n      },\r\n      handleCancel() {\r\n        this.close()\r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>"],"sourceRoot":"src/views/oaBus/modules"}]}