{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\data\\myData.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\data\\myData.vue","mtime":1578125234186},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.ends-with\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { httpAction, getAction } from '@/api/manage';\nimport Distribution from \"./dataGram/Distribution\";\nimport Banjie from \"./dataGram/Banjie\";\nexport default {\n  name: \"dataAnalysis\",\n  components: {\n    Distribution: Distribution,\n    Banjie: Banjie\n  },\n  inject: ['reload'],\n  filters: {\n    numberSlipce: function numberSlipce(val) {\n      if (val % 1 === 0) {\n        return val;\n      } else {\n        return val.toFixed(2);\n      } // return val*100\n\n    }\n  },\n  data: function data() {\n    return {\n      defaultValue: '',\n      //ModelData[0].sname\n      tabShow: 1,\n      loading: false,\n      fenbuqingkuang: false,\n      allowClear: true,\n      cheackModel: '',\n      cheackPro: '',\n      cheackYear: '',\n      ModelData: [],\n      ProData: [],\n      YearData: [],\n      userid: '',\n      //人员id\n      departid: '',\n      //部门id\n      parentid: '',\n      //单位id\n      subData: {\n        //提交数据   提交前动态修改部门id  人员id   或者单位id\n        modelId: this.cheackModel,\n        iBusFunctionId: this.cheackPro ? this.cheackPro : '',\n        iCreateYear: this.cheackYear // sCreateBy:this.userid\n\n      },\n      initModal: '',\n      initYear: ''\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    //獲取用戶基本信息\n    var userinfo = JSON.parse(localStorage.getItem('userdata'));\n    this.userid = userinfo.userInfo.id; // 人员id\n\n    this.departid = userinfo.departs[0].id; //部门id\n\n    this.parentid = userinfo.departs[0].parentId; //单位id\n    //加载基本数据    所属模块列表   申请年份列表\n\n    this.getBusModelList();\n    this.getYearList(); //  初始化 加载图表\n\n    setTimeout(function () {\n      _this.startAnalysis(_this.initModal, _this.initYear, '');\n\n      var url = \"/papertitle/docNumSet/busFunctionList?ibusModelId=\" + _this.initModal;\n      getAction(url).then(function (res) {\n        _this.ProData = res.result;\n      });\n    }, 1000);\n  },\n  mounted: function mounted() {},\n  watch: {\n    $route: function $route(to, from) {\n      this.startAnalysis();\n    }\n  },\n  methods: {\n    getTabVal: function getTabVal(e) {\n      this.tabShow = e;\n      this.startAnalysis();\n    },\n    //所属模块数据列表\n    getBusModelList: function getBusModelList() {\n      var _this2 = this;\n\n      var url = \"/papertitle/docNumSet/busModelList\";\n      getAction(url).then(function (res) {\n        _this2.ModelData = res.result;\n        _this2.initModal = _this2.ModelData[0].iid; // alert( res.result[0].iid)\n        // this.defaultValue = res.result[0].iid\n      });\n    },\n    // 所属业务模块数据  参数依赖于所属模块 所选id\n    getProList: function getProList(value) {\n      var _this3 = this;\n\n      var url = \"/papertitle/docNumSet/busFunctionList?ibusModelId=\" + value;\n      getAction(url).then(function (res) {\n        _this3.ProData = res.result;\n      });\n    },\n    //所属年份列表数据\n    getYearList: function getYearList() {\n      var _this4 = this;\n\n      var url = '/data/dataAnalysis/analysis';\n      getAction(url).then(function (res) {\n        // alert(JSON.stringify(res.year))\n        _this4.YearData = res.year;\n        _this4.initYear = _this4.YearData[0].year; // console.log(res);\n      });\n    },\n    //切换部门时所加载动画\n    loadingAnimation: function loadingAnimation() {// this.loading = true;\n      // setTimeout(()=>{\n      //   this.loading = false;\n      // },500)\n    },\n    //------------------------------------------------------------------------------------------------------------\n    //获取选值    所属模块value   此value值时所属业务的方法的基本参数\n    getModelVal: function getModelVal(e) {\n      this.cheackModel = e;\n      this.subData.modelId = e; //获取对应业务列表  所需的模块儿id\n\n      this.getProList(e);\n      this.cheackPro = '';\n      this.defaultValue = '';\n      console.log(this.$refs.dsdsds);\n      var initYear = this.YearData[0].year; //  初始化 加载图表\n\n      this.startAnalysis(e, this.cheackYear ? this.cheackYear : initYear, this.cheackPro ? this.cheackPro : '');\n    },\n    //获取选值    所属业务value\n    getProVal: function getProVal(e) {\n      this.cheackPro = e;\n      this.subData.iBusFunctionId = e;\n      var initModal = this.ModelData[0].iid;\n      var initYear = this.YearData[0].year; //  初始化 加载图表\n\n      this.startAnalysis(this.cheackModel ? this.cheackModel : initModal, this.cheackYear ? this.cheackYear : initYear, e);\n    },\n    //获取选值    申请年份value\n    getYearVal: function getYearVal(e) {\n      this.cheackYear = e;\n      this.subData.iCreateYear = e;\n      var initModal = this.ModelData[0].iid; //  初始化 加载图表\n\n      this.startAnalysis(this.cheackModel ? this.cheackModel : initModal, e, this.cheackPro ? this.cheackPro : ''); // alert(this.cheackModel)\n    },\n    //------------------------------------------------------------------------------------------------------------\n    //开始分析件按钮    传递values  到接口方法参数\n    startAnalysis: function startAnalysis() {\n      var initModal = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.subData.modelId;\n      var initYear = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.subData.iCreateYear;\n      var initYewu = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.subData.iBusFunctionId;\n\n      if (!Boolean(initModal) || !Boolean(initYear)) {\n        this.$message.warning('所属模块与申请年份为必选项');\n      } else {\n        var urlStr = this.$route.path;\n\n        if (urlStr.endsWith('myData')) {\n          // alert('我的数据')\n          // this.loadingAnimation();\n          //  为对象新增属性\n          // Object.assign(this.subData,{'sCreateBy':this.userid})\n          this.subData = {\n            //提交数据   提交前动态修改部门id  人员id   或者单位id\n            modelId: this.cheackModel ? this.cheackModel : this.ModelData[0].iid,\n            iBusFunctionId: this.cheackPro ? this.cheackPro : '',\n            iCreateYear: this.cheackYear ? this.cheackYear : this.YearData[0].year,\n            sCreateBy: this.userid\n          };\n        } else if (urlStr.endsWith('dataAnalysis')) {\n          // alert('部门数据')\n          // this.loadingAnimation();\n          //  为对象新增属性\n          // Object.assign(this.subData,{'sCreateDeptid':this.departid})\n          this.subData = {\n            //提交数据   提交前动态修改部门id  人员id   或者单位id\n            modelId: this.cheackModel ? this.cheackModel : this.ModelData[0].iid,\n            iBusFunctionId: this.cheackPro ? this.cheackPro : '',\n            iCreateYear: this.cheackYear ? this.cheackYear : this.YearData[0].year,\n            sCreateDeptid: this.departid\n          };\n        } else if (urlStr.endsWith('unitidData')) {\n          // alert('单位数据数据')\n          // this.loadingAnimation();\n          //  为对象新增属性\n          // Object.assign(this.subData,{'sCreateUnitid':this.parentid})\n          this.subData = {\n            //提交数据   提交前动态修改部门id  人员id   或者单位id\n            modelId: this.cheackModel ? this.cheackModel : this.ModelData[0].iid,\n            iBusFunctionId: this.cheackPro ? this.cheackPro : '',\n            iCreateYear: this.cheackYear ? this.cheackYear : this.YearData[0].year,\n            sCreateUnitid: this.parentid\n          };\n        } //------------------------------子组件方法调用 传参 subData     子组件分别为分布情况、办结率----------------------------------------------\n\n\n        this.$refs.distributionComponent.getSubData(this.subData);\n        this.$refs.banjieCompoment.getSubData(this.subData); // this.$refs.distributionComponent.asDepartCheack(this.subData);\n      }\n    }\n  }\n};",{"version":3,"sources":["myData.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\" :loading=\"loading\">\r\n    <div class=\"searchBox\">\r\n        <p>\r\n          <span>所属模块：</span>\r\n          <a-select style=\"width: 260px;\"  placeholder=\"请选择所属模块（必选项）\" :defaultValue=\"ModelData[0].iid\"  @change=\"getModelVal\">\r\n            <a-select-option v-for=\"(item,index) in ModelData\" :key=\"index\" :value=\"item.iid\">{{item.sname}}\r\n            </a-select-option>\r\n          </a-select>\r\n        </p>\r\n\r\n      <p>\r\n        <span>所属业务：</span>\r\n        <a-select style=\"width: 260px;\" :allowClear='allowClear' ref=\"dsdsds\"  v-model=\"defaultValue\"   placeholder=\"请选择所属业务\" @change=\"getProVal\">\r\n          <a-select-option v-for=\"(item,index) in ProData\"  :key=\"index\" :value=\"item.iid\">{{item.sname}}\r\n          </a-select-option>\r\n        </a-select>\r\n      </p>\r\n\r\n      <p>\r\n        <span>申请年份：</span>\r\n        <a-select style=\"width: 260px;\"   placeholder=\"请选择申请年份（必选项）\" :defaultValue=\"YearData[0].year\" @change=\"getYearVal\">\r\n          <a-select-option v-for=\"(item,index) in YearData\" :key=\"index\" :value=\"item.year\">{{item.year}}\r\n          </a-select-option>\r\n        </a-select>\r\n      </p>\r\n\r\n      <p>\r\n        <!--<a-button type=\"primary\" @click=\"startAnalysis\">开始数据分析</a-button>-->\r\n      </p>\r\n    </div>\r\n\r\n    <a-tabs @change=\"getTabVal\">\r\n\r\n      <a-tab-pane  tab=\"分布情况\" key=\"1\">\r\n\r\n      </a-tab-pane>\r\n\r\n      <a-tab-pane  tab=\"办结率\" key=\"2\">\r\n      </a-tab-pane>\r\n\r\n    </a-tabs>\r\n    <!--<Banjie v-show=\"false\"    ref=\"banjieCompoment\"/>-->\r\n    <Distribution @startAnalysis=\"startAnalysis\" v-show=\"tabShow==1?true:false\" ref=\"distributionComponent\"/>\r\n    <Banjie  v-show=\"tabShow==2?true:false\"    ref=\"banjieCompoment\"/>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import {httpAction,getAction} from '@/api/manage'\r\n  import Distribution from './dataGram/Distribution'\r\n  import Banjie from './dataGram/Banjie'\r\n    export default {\r\n      name: \"dataAnalysis\",\r\n      components: {\r\n          Distribution,\r\n          Banjie\r\n      },\r\n      inject:['reload'],\r\n      filters:{\r\n        numberSlipce(val){\r\n          if(val%1===0){\r\n            return  val;\r\n          }else{\r\n            return (val).toFixed(2);\r\n          }\r\n          // return val*100\r\n        }\r\n      },\r\n      data() {\r\n        return {\r\n          defaultValue:'',\r\n          //ModelData[0].sname\r\n          tabShow:1,\r\n          loading:false,\r\n          fenbuqingkuang:false,\r\n          allowClear:true,\r\n          cheackModel:'',\r\n          cheackPro:'',\r\n          cheackYear:'',\r\n\r\n          ModelData:[],\r\n          ProData:[],\r\n          YearData:[],\r\n\r\n          userid:'',//人员id\r\n          departid:'',//部门id\r\n          parentid:'',//单位id\r\n\r\n          subData : {   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n            modelId:this.cheackModel,\r\n            iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n            iCreateYear:this.cheackYear,\r\n            // sCreateBy:this.userid\r\n          },\r\n          initModal:'',\r\n          initYear:''\r\n        }\r\n      },\r\n      created(){\r\n\r\n        //獲取用戶基本信息\r\n        const  userinfo =JSON.parse( localStorage.getItem('userdata'));\r\n        this.userid = userinfo.userInfo.id;// 人员id\r\n        this.departid = userinfo.departs[0].id;//部门id\r\n        this.parentid = userinfo.departs[0].parentId; //单位id\r\n\r\n        //加载基本数据    所属模块列表   申请年份列表\r\n        this.getBusModelList();\r\n        this.getYearList();\r\n        //  初始化 加载图表\r\n        setTimeout(()=>{\r\n          this.startAnalysis(this.initModal,this.initYear,'')\r\n          let url = \"/papertitle/docNumSet/busFunctionList?ibusModelId=\"+ this.initModal;\r\n          getAction(url).then((res)=>{\r\n            this.ProData = res.result;\r\n          })\r\n        },1000)\r\n\r\n\r\n      },\r\n      mounted(){\r\n\r\n\r\n      },\r\n      watch:{\r\n        $route(to,from){\r\n         this.startAnalysis();\r\n        }\r\n\r\n      },\r\n      methods:{\r\n        getTabVal(e){\r\n          this.tabShow = e;\r\n          this.startAnalysis();\r\n        },\r\n        //所属模块数据列表\r\n        getBusModelList() {\r\n          let url = \"/papertitle/docNumSet/busModelList\";\r\n          getAction(url).then((res) => {\r\n            this.ModelData = res.result;\r\n            this.initModal = this.ModelData[0].iid;\r\n\r\n            // alert( res.result[0].iid)\r\n            // this.defaultValue = res.result[0].iid\r\n          })\r\n        },\r\n\r\n        // 所属业务模块数据  参数依赖于所属模块 所选id\r\n        getProList(value){\r\n          let url = \"/papertitle/docNumSet/busFunctionList?ibusModelId=\"+value;\r\n          getAction(url).then((res)=>{\r\n            this.ProData = res.result;\r\n          })\r\n\r\n        },\r\n        //所属年份列表数据\r\n        getYearList(){\r\n          let url = '/data/dataAnalysis/analysis';\r\n          getAction(url).then((res)=>{\r\n            // alert(JSON.stringify(res.year))\r\n            this.YearData = res.year;\r\n            this.initYear = this.YearData[0].year;\r\n            // console.log(res);\r\n          })\r\n        },\r\n        //切换部门时所加载动画\r\n        loadingAnimation(){\r\n          // this.loading = true;\r\n          // setTimeout(()=>{\r\n          //   this.loading = false;\r\n          // },500)\r\n        },\r\n\r\n        //------------------------------------------------------------------------------------------------------------\r\n        //获取选值    所属模块value   此value值时所属业务的方法的基本参数\r\n        getModelVal(e){\r\n          this.cheackModel = e;\r\n          this.subData.modelId = e;\r\n\r\n          //获取对应业务列表  所需的模块儿id\r\n          this.getProList(e);\r\n          this.cheackPro = '';\r\n          this.defaultValue = ''\r\n\r\n            console.log(this.$refs.dsdsds);\r\n          let initYear = this.YearData[0].year;\r\n          //  初始化 加载图表\r\n          this.startAnalysis(e,this.cheackYear?this.cheackYear:initYear,this.cheackPro?this.cheackPro:'')\r\n        },\r\n        //获取选值    所属业务value\r\n        getProVal(e){\r\n          this.cheackPro = e;\r\n          this.subData.iBusFunctionId = e;\r\n\r\n\r\n\r\n          let initModal = this.ModelData[0].iid;\r\n          let initYear = this.YearData[0].year;\r\n          //  初始化 加载图表\r\n          this.startAnalysis(this.cheackModel?this.cheackModel:initModal,this.cheackYear?this.cheackYear:initYear,e)\r\n\r\n        },\r\n        //获取选值    申请年份value\r\n        getYearVal(e){\r\n          this.cheackYear = e;\r\n          this.subData.iCreateYear = e;\r\n\r\n\r\n          let initModal = this.ModelData[0].iid;\r\n          //  初始化 加载图表\r\n          this.startAnalysis(this.cheackModel?this.cheackModel:initModal,e,this.cheackPro?this.cheackPro:'')\r\n\r\n          // alert(this.cheackModel)\r\n\r\n        },\r\n\r\n        //------------------------------------------------------------------------------------------------------------\r\n\r\n\r\n        //开始分析件按钮    传递values  到接口方法参数\r\n        startAnalysis(initModal=this.subData.modelId,initYear=this.subData.iCreateYear,initYewu=this.subData.iBusFunctionId){\r\n\r\n            if(!Boolean(initModal)||!Boolean(initYear)){\r\n                this.$message.warning('所属模块与申请年份为必选项')\r\n            }else{\r\n\r\n              const urlStr = this.$route.path;\r\n              if(urlStr.endsWith('myData')){\r\n                // alert('我的数据')\r\n                // this.loadingAnimation();\r\n                //  为对象新增属性\r\n                // Object.assign(this.subData,{'sCreateBy':this.userid})\r\n                this.subData={   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n                    modelId:this.cheackModel?this.cheackModel :this.ModelData[0].iid,\r\n                    iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n                    iCreateYear:this.cheackYear?this.cheackYear:this.YearData[0].year,\r\n                    sCreateBy:this.userid\r\n                }\r\n\r\n              }else if(urlStr.endsWith('dataAnalysis')){\r\n                // alert('部门数据')\r\n                // this.loadingAnimation();\r\n                //  为对象新增属性\r\n                // Object.assign(this.subData,{'sCreateDeptid':this.departid})\r\n                this.subData={   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n                  modelId:this.cheackModel?this.cheackModel :this.ModelData[0].iid,\r\n                  iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n                  iCreateYear:this.cheackYear?this.cheackYear:this.YearData[0].year,\r\n                  sCreateDeptid:this.departid\r\n                }\r\n\r\n              }else if (urlStr.endsWith('unitidData')) {\r\n                // alert('单位数据数据')\r\n                // this.loadingAnimation();\r\n                //  为对象新增属性\r\n                // Object.assign(this.subData,{'sCreateUnitid':this.parentid})\r\n                this.subData={   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n                  modelId:this.cheackModel?this.cheackModel :this.ModelData[0].iid,\r\n                  iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n                  iCreateYear:this.cheackYear?this.cheackYear:this.YearData[0].year,\r\n                  sCreateUnitid:this.parentid\r\n                }\r\n\r\n\r\n              }\r\n\r\n\r\n              //------------------------------子组件方法调用 传参 subData     子组件分别为分布情况、办结率----------------------------------------------\r\n\r\n              this.$refs.distributionComponent.getSubData(this.subData);\r\n              this.$refs.banjieCompoment.getSubData(this.subData);\r\n\r\n              // this.$refs.distributionComponent.asDepartCheack(this.subData);\r\n\r\n\r\n            }\r\n        },\r\n\r\n\r\n\r\n      },\r\n    }\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n    .searchBox{\r\n      width: 100%;\r\n      height: 60px;\r\n      border-bottom: 1px solid #cccccc;\r\n\r\n      display: flex;\r\n\r\n      p{\r\n        margin-left: 20px;\r\n      }\r\n      p:first-child{\r\n        margin-left: 0px;\r\n      }\r\n      p:last-child{\r\n        margin-left: 50px;\r\n      }\r\n    }\r\n</style>"],"sourceRoot":"src/views/data"}]}