{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\xxm\\work\\jd\\fore\\src\\mixins\\JeecgListMixin.js","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\mixins\\JeecgListMixin.js","mtime":1578301921438},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1570780125155}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"C:\\\\xxm\\\\work\\\\jd\\\\fore\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\n\n/**\r\n * 新增修改完成调用 modalFormOk方法 编辑弹框组件ref定义为modalForm\r\n * 高级查询按钮调用 superQuery方法  高级查询组件ref定义为superQueryModal\r\n * data中url定义 list为查询列表  delete为删除单条记录  deleteBatch为批量删除\r\n */\nimport { filterObj } from '@/utils/util';\nimport { deleteAction, getAction, downFile } from '@/api/manage';\nimport Vue from 'vue';\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\";\nexport var JeecgListMixin = {\n  data: function data() {\n    return {\n      //token header\n      tokenHeader: {\n        'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\n      },\n\n      /* 查询条件-请不要在queryParam中声明非字符串值的属性 */\n      queryParam: {},\n\n      /* 数据源 */\n      dataSource: [],\n\n      /* 分页参数 */\n      ipagination: {\n        current: 1,\n        pageSize: 10,\n        pageSizeOptions: ['10', '20', '30'],\n        showTotal: function showTotal(total, range) {\n          return range[0] + \"-\" + range[1] + \" 共\" + total + \"条\";\n        },\n        showQuickJumper: true,\n        showSizeChanger: true,\n        total: 0\n      },\n\n      /* 排序参数 */\n      isorter: {// column: 'createTime',\n        // order: 'desc',\n      },\n\n      /* 筛选参数 */\n      filters: {},\n\n      /* table加载状态 */\n      loading: false,\n\n      /* table选中keys*/\n      selectedRowKeys: [],\n\n      /* table选中records*/\n      selectionRows: [],\n\n      /* 查询折叠 */\n      toggleSearchStatus: false,\n\n      /* 高级查询条件生效状态 */\n      superQueryFlag: false,\n\n      /* 高级查询条件 */\n      superQueryParams: \"\"\n    };\n  },\n  created: function created() {\n    //先获取上次缓存的参数(如果有的话)\n    this.getQueryParamsMy();\n    this.loadData(); //初始化字典配置 在自己页面定义\n\n    this.initDictConfig();\n  },\n  methods: {\n    //获取存储的查询条件\n    getQueryParamsMy: function getQueryParamsMy() {\n      var path = this.$route.path;\n      var userInfo = localStorage.getItem('userdata');\n      if (userInfo == undefined) return;\n      var user = JSON.parse(userInfo);\n      var uid = user.userInfo.id;\n      var paramMsg = localStorage.getItem(uid + path);\n      if (paramMsg == undefined) return;\n      var params = JSON.parse(paramMsg);\n      this.ipagination = params.ipagination;\n      this.queryParam = params.queryParams;\n      var total = params.ipagination.total;\n      var current = params.ipagination.current;\n      var pageSize = params.ipagination.pageSize;\n      var end = current + pageSize >= total ? total : current + pageSize; // console.log(total, current, pageSize, end)\n      // this.ipagination.showTotal = (current - 1) * pageSize + \"-\" + end + \" 共\" + total + \"条\"\n      // this.ipagination.showTotal = total\n    },\n    //记录查询条件到缓存\n    setQueryParams: function setQueryParams() {\n      var path = this.$route.path;\n      var userInfo = localStorage.getItem('userdata');\n      if (userInfo == undefined) return;\n      var user = JSON.parse(userInfo);\n      var uid = user.userInfo.id;\n      var params = {\n        ipagination: this.ipagination,\n        queryParams: this.queryParam\n      };\n      localStorage.setItem(uid + path, JSON.stringify(params));\n    },\n    loadData: function loadData(arg) {\n      var _this = this;\n\n      if (!this.url.list) {\n        this.$message.error(\"请设置url.list属性!\");\n        return;\n      } //加载数据 若传入参数1则加载第一页的内容\n\n\n      if (arg === 1) {\n        this.ipagination.current = 1;\n      }\n\n      var params = this.getQueryParams(); //查询条件\n      //记录查询信息到缓存\n\n      this.setQueryParams();\n      this.loading = true;\n      getAction(this.url.list, params).then(function (res) {\n        if (res.success) {\n          _this.dataSource = res.result.records;\n          _this.ipagination.total = res.result.total;\n        }\n\n        if (res.code === 510) {\n          _this.$message.warning(res.message);\n        }\n\n        _this.loading = false;\n      });\n    },\n    initDictConfig: function initDictConfig() {\n      console.log(\"--这是一个假的方法!\");\n    },\n    handleSuperQuery: function handleSuperQuery(arg) {\n      //高级查询方法\n      if (!arg) {\n        this.superQueryParams = '';\n        this.superQueryFlag = false;\n      } else {\n        this.superQueryFlag = true;\n        this.superQueryParams = JSON.stringify(arg);\n      }\n\n      this.loadData();\n    },\n    getQueryParams: function getQueryParams() {\n      //获取查询条件\n      var sqp = {};\n\n      if (this.superQueryParams) {\n        sqp['superQueryParams'] = encodeURI(this.superQueryParams);\n      }\n\n      var param = Object.assign(sqp, this.queryParam, this.isorter, this.filters);\n      param.field = this.getQueryField();\n      param.pageNo = this.ipagination.current;\n      param.pageSize = this.ipagination.pageSize;\n      return filterObj(param);\n    },\n    getQueryField: function getQueryField() {\n      //TODO 字段权限控制\n      var str = \"id,\";\n      this.columns.forEach(function (value) {\n        str += \",\" + value.dataIndex;\n      });\n      return str;\n    },\n    onSelectChange: function onSelectChange(selectedRowKeys, selectionRows) {\n      this.selectedRowKeys = selectedRowKeys;\n      this.selectionRows = selectionRows;\n    },\n    onClearSelected: function onClearSelected() {\n      this.selectedRowKeys = [];\n      this.selectionRows = [];\n    },\n    searchQuery: function searchQuery() {\n      this.loadData(1);\n    },\n    superQuery: function superQuery() {\n      this.$refs.superQueryModal.show();\n    },\n    searchReset: function searchReset() {\n      this.queryParam = {};\n      this.loadData(1);\n    },\n    batchDel: function batchDel() {\n      if (!this.url.deleteBatch) {\n        this.$message.error(\"请设置url.deleteBatch属性!\");\n        return;\n      }\n\n      if (this.selectedRowKeys.length <= 0) {\n        this.$message.warning('请选择一条记录！');\n        return;\n      } else {\n        var ids = \"\";\n\n        for (var a = 0; a < this.selectedRowKeys.length; a++) {\n          ids += this.selectedRowKeys[a] + \",\";\n        }\n\n        var that = this;\n        this.$confirm({\n          title: \"确认删除\",\n          content: \"是否删除选中数据?\",\n          onOk: function onOk() {\n            deleteAction(that.url.deleteBatch, {\n              ids: ids\n            }).then(function (res) {\n              if (res.success) {\n                that.$message.success(res.message);\n                that.loadData();\n                that.onClearSelected();\n              } else {\n                that.$message.warning(res.message);\n              }\n            });\n          }\n        });\n      }\n    },\n    handleDelete: function handleDelete(id) {\n      if (!this.url.delete) {\n        this.$message.error(\"请设置url.delete属性!\");\n        return;\n      }\n\n      var that = this;\n      deleteAction(that.url.delete, {\n        id: id\n      }).then(function (res) {\n        if (res.success) {\n          that.$message.success(res.message);\n          that.loadData();\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    },\n    handleEdit: function handleEdit(record) {\n      this.$refs.modalForm.edit(record);\n      this.$refs.modalForm.title = \"编辑\";\n      this.$refs.modalForm.disableSubmit = false;\n    },\n    handleAdd: function handleAdd() {\n      this.$refs.modalForm.add();\n      this.$refs.modalForm.title = \"新增\";\n      this.$refs.modalForm.disableSubmit = false;\n    },\n    handleSuggest: function handleSuggest() {\n      this.$refs.suggestModalForm.suggest();\n      this.$refs.suggestModalForm.title = \"意见建议\";\n      this.$refs.suggestModalForm.disableSubmit = false;\n    },\n    handleDenji: function handleDenji() {\n      this.$refs.DengJiModalForm.dengji();\n      this.$refs.DengJiModalForm.title = \"登记文号\";\n      this.$refs.DengJiModalForm.disableSubmit = false;\n    },\n    handleYinRu: function handleYinRu() {\n      this.$refs.YinRuModalForm.yinru();\n      this.$refs.YinRuModalForm.title = \"引入附件\";\n      this.$refs.YinRuModalForm.disableSubmit = false;\n    },\n    handleTableChange: function handleTableChange(pagination, filters, sorter) {\n      //分页、排序、筛选变化时触发   denji\n      //TODO 筛选\n      if (Object.keys(sorter).length > 0) {\n        this.isorter.column = sorter.field;\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\";\n      }\n\n      this.ipagination = pagination;\n      this.loadData();\n    },\n    handleToggleSearch: function handleToggleSearch() {\n      this.toggleSearchStatus = !this.toggleSearchStatus;\n    },\n    modalFormOk: function modalFormOk() {\n      // 新增/修改 成功时，重载列表\n      this.loadData();\n    },\n    handleDetail: function handleDetail(record) {\n      this.$refs.modalForm.edit(record);\n      this.$refs.modalForm.title = \"详情\";\n      this.$refs.modalForm.disableSubmit = true;\n    },\n\n    /* 导出 */\n    handleExportXls2: function handleExportXls2() {\n      var paramsStr = encodeURI(JSON.stringify(this.getQueryParams()));\n      var url = \"\".concat(window._CONFIG['domianURL'], \"/\").concat(this.url.exportXlsUrl, \"?paramsStr=\").concat(paramsStr);\n      window.location.href = url;\n    },\n    handleExportXls: function handleExportXls(fileName) {\n      var _this2 = this;\n\n      if (!fileName || typeof fileName != \"string\") {\n        fileName = \"导出文件\";\n      }\n\n      var param = _objectSpread({}, this.queryParam);\n\n      if (this.selectedRowKeys && this.selectedRowKeys.length > 0) {\n        param['selections'] = this.selectedRowKeys.join(\",\");\n      }\n\n      console.log(\"导出参数\", param);\n      downFile(this.url.exportXlsUrl, param).then(function (data) {\n        if (!data) {\n          _this2.$message.warning(\"文件下载失败\");\n\n          return;\n        }\n\n        if (typeof window.navigator.msSaveBlob !== 'undefined') {\n          window.navigator.msSaveBlob(new Blob([data]), fileName + '.xls');\n        } else {\n          var url = window.URL.createObjectURL(new Blob([data]));\n          var link = document.createElement('a');\n          link.style.display = 'none';\n          link.href = url;\n          link.setAttribute('download', fileName + '.xls');\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link); //下载完成移除元素\n\n          window.URL.revokeObjectURL(url); //释放掉blob对象\n        }\n      });\n    },\n\n    /* 导入 */\n    handleImportExcel: function handleImportExcel(info) {\n      if (info.file.status !== 'uploading') {\n        console.log(info.file, info.fileList);\n      }\n\n      if (info.file.status === 'done') {\n        if (info.file.response.success) {\n          this.$message.success(\"\".concat(info.file.name, \" \\u6587\\u4EF6\\u4E0A\\u4F20\\u6210\\u529F\"));\n          this.loadData();\n        } else {\n          this.$message.error(\"\".concat(info.file.name, \" \").concat(info.file.response.message, \".\"));\n        }\n      } else if (info.file.status === 'error') {\n        this.$message.error(\"\\u6587\\u4EF6\\u4E0A\\u4F20\\u5931\\u8D25: \".concat(info.file.msg, \" \"));\n      }\n    },\n\n    /* 图片预览 */\n    getImgView: function getImgView(text) {\n      if (text && text.indexOf(\",\") > 0) {\n        text = text.substring(0, text.indexOf(\",\"));\n      }\n\n      return window._CONFIG['imgDomainURL'] + \"/\" + text;\n    },\n\n    /* 文件下载 */\n    uploadFile: function uploadFile(text) {\n      if (!text) {\n        this.$message.warning(\"未知的文件\");\n        return;\n      }\n\n      if (text.indexOf(\",\") > 0) {\n        text = text.substring(0, text.indexOf(\",\"));\n      }\n\n      window.open(window._CONFIG['domianURL'] + \"/sys/common/download/\" + text);\n    }\n  }\n};",{"version":3,"sources":["C:\\xxm\\work\\jd\\fore\\src\\mixins\\JeecgListMixin.js"],"names":["filterObj","deleteAction","getAction","downFile","Vue","ACCESS_TOKEN","JeecgListMixin","data","tokenHeader","ls","get","queryParam","dataSource","ipagination","current","pageSize","pageSizeOptions","showTotal","total","range","showQuickJumper","showSizeChanger","isorter","filters","loading","selectedRowKeys","selectionRows","toggleSearchStatus","superQueryFlag","superQueryParams","created","getQueryParamsMy","loadData","initDictConfig","methods","path","$route","userInfo","localStorage","getItem","undefined","user","JSON","parse","uid","id","paramMsg","params","queryParams","end","setQueryParams","setItem","stringify","arg","url","list","$message","error","getQueryParams","then","res","success","result","records","code","warning","message","console","log","handleSuperQuery","sqp","encodeURI","param","Object","assign","field","getQueryField","pageNo","str","columns","forEach","value","dataIndex","onSelectChange","onClearSelected","searchQuery","superQuery","$refs","superQueryModal","show","searchReset","batchDel","deleteBatch","length","ids","a","that","$confirm","title","content","onOk","handleDelete","delete","handleEdit","record","modalForm","edit","disableSubmit","handleAdd","add","handleSuggest","suggestModalForm","suggest","handleDenji","DengJiModalForm","dengji","handleYinRu","YinRuModalForm","yinru","handleTableChange","pagination","sorter","keys","column","order","handleToggleSearch","modalFormOk","handleDetail","handleExportXls2","paramsStr","window","_CONFIG","exportXlsUrl","location","href","handleExportXls","fileName","join","navigator","msSaveBlob","Blob","URL","createObjectURL","link","document","createElement","style","display","setAttribute","body","appendChild","click","removeChild","revokeObjectURL","handleImportExcel","info","file","status","fileList","response","name","msg","getImgView","text","indexOf","substring","uploadFile","open"],"mappings":"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","sourcesContent":["/**\r\n * 新增修改完成调用 modalFormOk方法 编辑弹框组件ref定义为modalForm\r\n * 高级查询按钮调用 superQuery方法  高级查询组件ref定义为superQueryModal\r\n * data中url定义 list为查询列表  delete为删除单条记录  deleteBatch为批量删除\r\n */\r\nimport {filterObj} from '@/utils/util';\r\nimport {deleteAction, getAction, downFile} from '@/api/manage'\r\nimport Vue from 'vue'\r\nimport {ACCESS_TOKEN} from \"@/store/mutation-types\"\r\n\r\nexport const JeecgListMixin = {\r\n  data() {\r\n    return {\r\n      //token header\r\n      tokenHeader: {'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)},\r\n      /* 查询条件-请不要在queryParam中声明非字符串值的属性 */\r\n      queryParam: {},\r\n      /* 数据源 */\r\n      dataSource: [],\r\n      /* 分页参数 */\r\n      ipagination: {\r\n        current: 1,\r\n        pageSize: 10,\r\n        pageSizeOptions: ['10', '20', '30'],\r\n        showTotal: (total, range) => {\r\n          return range[0] + \"-\" + range[1] + \" 共\" + total + \"条\"\r\n        },\r\n        showQuickJumper: true,\r\n        showSizeChanger: true,\r\n        total: 0\r\n      },\r\n      /* 排序参数 */\r\n      isorter: {\r\n        // column: 'createTime',\r\n        // order: 'desc',\r\n      },\r\n      /* 筛选参数 */\r\n      filters: {},\r\n      /* table加载状态 */\r\n      loading: false,\r\n      /* table选中keys*/\r\n      selectedRowKeys: [],\r\n      /* table选中records*/\r\n      selectionRows: [],\r\n      /* 查询折叠 */\r\n      toggleSearchStatus: false,\r\n      /* 高级查询条件生效状态 */\r\n      superQueryFlag: false,\r\n      /* 高级查询条件 */\r\n      superQueryParams: \"\"\r\n    }\r\n  },\r\n  created() {\r\n    //先获取上次缓存的参数(如果有的话)\r\n    this.getQueryParamsMy()\r\n    this.loadData();\r\n    //初始化字典配置 在自己页面定义\r\n    this.initDictConfig();\r\n  },\r\n  methods: {\r\n    //获取存储的查询条件\r\n    getQueryParamsMy() {\r\n      let path = this.$route.path\r\n      let userInfo = localStorage.getItem('userdata');\r\n      if (userInfo == undefined) return\r\n      let user = JSON.parse(userInfo)\r\n      let uid = user.userInfo.id\r\n      let paramMsg = localStorage.getItem(uid + path)\r\n      if (paramMsg == undefined) return\r\n      let params = JSON.parse(paramMsg)\r\n\r\n      this.ipagination = params.ipagination\r\n      this.queryParam = params.queryParams\r\n\r\n\r\n      let total = params.ipagination.total\r\n      let current = params.ipagination.current\r\n      let pageSize = params.ipagination.pageSize\r\n      let end = current + pageSize >= total ? total : current + pageSize\r\n      // console.log(total, current, pageSize, end)\r\n      // this.ipagination.showTotal = (current - 1) * pageSize + \"-\" + end + \" 共\" + total + \"条\"\r\n      // this.ipagination.showTotal = total\r\n    },\r\n    //记录查询条件到缓存\r\n    setQueryParams() {\r\n      let path = this.$route.path\r\n      let userInfo = localStorage.getItem('userdata');\r\n      if (userInfo == undefined) return\r\n      let user = JSON.parse(userInfo)\r\n      let uid = user.userInfo.id\r\n      let params = {\r\n        ipagination: this.ipagination,\r\n        queryParams: this.queryParam\r\n      }\r\n\r\n      localStorage.setItem(uid + path, JSON.stringify(params))\r\n\r\n    },\r\n    loadData(arg) {\r\n\r\n      if (!this.url.list) {\r\n        this.$message.error(\"请设置url.list属性!\")\r\n        return\r\n      }\r\n      //加载数据 若传入参数1则加载第一页的内容\r\n      if (arg === 1) {\r\n        this.ipagination.current = 1;\r\n      }\r\n      var params = this.getQueryParams();//查询条件\r\n      //记录查询信息到缓存\r\n      this.setQueryParams()\r\n\r\n      this.loading = true;\r\n      getAction(this.url.list, params).then((res) => {\r\n        if (res.success) {\r\n          this.dataSource = res.result.records;\r\n          this.ipagination.total = res.result.total;\r\n        }\r\n        if (res.code === 510) {\r\n          this.$message.warning(res.message)\r\n        }\r\n        this.loading = false;\r\n      })\r\n    },\r\n    initDictConfig() {\r\n      console.log(\"--这是一个假的方法!\")\r\n    },\r\n    handleSuperQuery(arg) {\r\n      //高级查询方法\r\n      if (!arg) {\r\n        this.superQueryParams = ''\r\n        this.superQueryFlag = false\r\n      } else {\r\n        this.superQueryFlag = true\r\n        this.superQueryParams = JSON.stringify(arg)\r\n      }\r\n      this.loadData()\r\n    },\r\n    getQueryParams() {\r\n      //获取查询条件\r\n      let sqp = {}\r\n      if (this.superQueryParams) {\r\n        sqp['superQueryParams'] = encodeURI(this.superQueryParams)\r\n      }\r\n      var param = Object.assign(sqp, this.queryParam, this.isorter, this.filters);\r\n      param.field = this.getQueryField();\r\n      param.pageNo = this.ipagination.current;\r\n      param.pageSize = this.ipagination.pageSize;\r\n      return filterObj(param);\r\n    },\r\n    getQueryField() {\r\n      //TODO 字段权限控制\r\n      var str = \"id,\";\r\n      this.columns.forEach(function (value) {\r\n        str += \",\" + value.dataIndex;\r\n      });\r\n      return str;\r\n    },\r\n\r\n    onSelectChange(selectedRowKeys, selectionRows) {\r\n      this.selectedRowKeys = selectedRowKeys;\r\n      this.selectionRows = selectionRows;\r\n    },\r\n    onClearSelected() {\r\n      this.selectedRowKeys = [];\r\n      this.selectionRows = [];\r\n    },\r\n    searchQuery() {\r\n      this.loadData(1);\r\n    },\r\n    superQuery() {\r\n      this.$refs.superQueryModal.show();\r\n    },\r\n    searchReset() {\r\n      this.queryParam = {}\r\n      this.loadData(1);\r\n    },\r\n    batchDel: function () {\r\n      if (!this.url.deleteBatch) {\r\n        this.$message.error(\"请设置url.deleteBatch属性!\")\r\n        return\r\n      }\r\n      if (this.selectedRowKeys.length <= 0) {\r\n        this.$message.warning('请选择一条记录！');\r\n        return;\r\n      } else {\r\n        var ids = \"\";\r\n        for (var a = 0; a < this.selectedRowKeys.length; a++) {\r\n          ids += this.selectedRowKeys[a] + \",\";\r\n        }\r\n        var that = this;\r\n        this.$confirm({\r\n          title: \"确认删除\",\r\n          content: \"是否删除选中数据?\",\r\n          onOk: function () {\r\n            deleteAction(that.url.deleteBatch, {ids: ids}).then((res) => {\r\n              if (res.success) {\r\n                that.$message.success(res.message);\r\n                that.loadData();\r\n                that.onClearSelected();\r\n              } else {\r\n                that.$message.warning(res.message);\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    handleDelete: function (id) {\r\n      if (!this.url.delete) {\r\n        this.$message.error(\"请设置url.delete属性!\")\r\n        return\r\n      }\r\n      var that = this;\r\n      deleteAction(that.url.delete, {id: id}).then((res) => {\r\n        if (res.success) {\r\n          that.$message.success(res.message);\r\n          that.loadData();\r\n        } else {\r\n          that.$message.warning(res.message);\r\n        }\r\n      });\r\n    },\r\n    handleEdit: function (record) {\r\n      this.$refs.modalForm.edit(record);\r\n      this.$refs.modalForm.title = \"编辑\";\r\n      this.$refs.modalForm.disableSubmit = false;\r\n    },\r\n    handleAdd: function () {\r\n      this.$refs.modalForm.add();\r\n      this.$refs.modalForm.title = \"新增\";\r\n      this.$refs.modalForm.disableSubmit = false;\r\n    },\r\n    handleSuggest: function () {\r\n      this.$refs.suggestModalForm.suggest();\r\n      this.$refs.suggestModalForm.title = \"意见建议\";\r\n      this.$refs.suggestModalForm.disableSubmit = false;\r\n    },\r\n    handleDenji: function () {\r\n      this.$refs.DengJiModalForm.dengji();\r\n      this.$refs.DengJiModalForm.title = \"登记文号\";\r\n      this.$refs.DengJiModalForm.disableSubmit = false;\r\n    },\r\n    handleYinRu: function () {\r\n      this.$refs.YinRuModalForm.yinru();\r\n      this.$refs.YinRuModalForm.title = \"引入附件\";\r\n      this.$refs.YinRuModalForm.disableSubmit = false;\r\n    },\r\n    handleTableChange(pagination, filters, sorter) {\r\n      //分页、排序、筛选变化时触发   denji\r\n      //TODO 筛选\r\n      if (Object.keys(sorter).length > 0) {\r\n        this.isorter.column = sorter.field;\r\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\"\r\n      }\r\n      this.ipagination = pagination;\r\n      this.loadData();\r\n    },\r\n    handleToggleSearch() {\r\n      this.toggleSearchStatus = !this.toggleSearchStatus;\r\n    },\r\n    modalFormOk() {\r\n      // 新增/修改 成功时，重载列表\r\n      this.loadData();\r\n    },\r\n    handleDetail: function (record) {\r\n      this.$refs.modalForm.edit(record);\r\n      this.$refs.modalForm.title = \"详情\";\r\n      this.$refs.modalForm.disableSubmit = true;\r\n    },\r\n    /* 导出 */\r\n    handleExportXls2() {\r\n      let paramsStr = encodeURI(JSON.stringify(this.getQueryParams()));\r\n      let url = `${window._CONFIG['domianURL']}/${this.url.exportXlsUrl}?paramsStr=${paramsStr}`;\r\n      window.location.href = url;\r\n    },\r\n    handleExportXls(fileName) {\r\n      if (!fileName || typeof fileName != \"string\") {\r\n        fileName = \"导出文件\"\r\n      }\r\n      let param = {...this.queryParam};\r\n      if (this.selectedRowKeys && this.selectedRowKeys.length > 0) {\r\n        param['selections'] = this.selectedRowKeys.join(\",\")\r\n      }\r\n      console.log(\"导出参数\", param)\r\n      downFile(this.url.exportXlsUrl, param).then((data) => {\r\n        if (!data) {\r\n          this.$message.warning(\"文件下载失败\")\r\n          return\r\n        }\r\n        if (typeof window.navigator.msSaveBlob !== 'undefined') {\r\n          window.navigator.msSaveBlob(new Blob([data]), fileName + '.xls')\r\n        } else {\r\n          let url = window.URL.createObjectURL(new Blob([data]))\r\n          let link = document.createElement('a')\r\n          link.style.display = 'none'\r\n          link.href = url\r\n          link.setAttribute('download', fileName + '.xls')\r\n          document.body.appendChild(link)\r\n          link.click()\r\n          document.body.removeChild(link); //下载完成移除元素\r\n          window.URL.revokeObjectURL(url); //释放掉blob对象\r\n        }\r\n      })\r\n    },\r\n    /* 导入 */\r\n    handleImportExcel(info) {\r\n      if (info.file.status !== 'uploading') {\r\n        console.log(info.file, info.fileList);\r\n      }\r\n      if (info.file.status === 'done') {\r\n        if (info.file.response.success) {\r\n          this.$message.success(`${info.file.name} 文件上传成功`);\r\n          this.loadData();\r\n        } else {\r\n          this.$message.error(`${info.file.name} ${info.file.response.message}.`);\r\n        }\r\n      } else if (info.file.status === 'error') {\r\n        this.$message.error(`文件上传失败: ${info.file.msg} `);\r\n      }\r\n    },\r\n    /* 图片预览 */\r\n    getImgView(text) {\r\n      if (text && text.indexOf(\",\") > 0) {\r\n        text = text.substring(0, text.indexOf(\",\"))\r\n      }\r\n      return window._CONFIG['imgDomainURL'] + \"/\" + text\r\n    },\r\n    /* 文件下载 */\r\n    uploadFile(text) {\r\n      if (!text) {\r\n        this.$message.warning(\"未知的文件\")\r\n        return;\r\n      }\r\n      if (text.indexOf(\",\") > 0) {\r\n        text = text.substring(0, text.indexOf(\",\"))\r\n      }\r\n      window.open(window._CONFIG['domianURL'] + \"/sys/common/download/\" + text);\r\n    },\r\n  }\r\n\r\n}"]}]}