{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\mytask\\modules\\pic2Modal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\mytask\\modules\\pic2Modal.vue","mtime":1579587944058},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.typed.uint8-array\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getAction, postAction, picUrl } from '@/api/manage';\nexport default {\n  name: \"pic2Modal\",\n  data: function data() {\n    return {\n      scrHeight: window.innerHeight - 320 + 'px',\n      styles: [],\n      title: '流程查看',\n      confirmLoading: false,\n      visible: false,\n      trace: false,\n      showPic: true,\n      picurl: '',\n      locationUrl: '',\n      record: '',\n      //************* table **************\n      dataSource: [],\n      columns: [{\n        title: '环节名称',\n        align: \"center\",\n        dataIndex: 'taskDefName'\n      }, {\n        title: '负责人',\n        align: \"center\",\n        dataIndex: 'userName'\n      }, {\n        title: '部门',\n        align: \"center\",\n        dataIndex: 'deptName'\n      }, {\n        title: '完成时间',\n        align: \"center\",\n        dataIndex: 'endTime'\n      }],\n      backRecord: false,\n      columns2: [// {\n      //   title: '环节名称',\n      //   align: \"center\",\n      //   dataIndex: 'name'\n      // },\n      {\n        title: '撤回/回退人',\n        align: \"center\",\n        dataIndex: 'userName'\n      }, {\n        title: '撤回/回退记录',\n        align: \"left\",\n        dataIndex: 'log'\n      }, {\n        title: '回退原因',\n        align: \"left\",\n        dataIndex: 'backReason'\n      }, {\n        title: '完成时间',\n        align: \"center\",\n        dataIndex: 'endTime'\n      }]\n    };\n  },\n  created: function created() {},\n  methods: {\n    rowClick: function rowClick(res) {\n      var _this = this;\n\n      return {\n        on: {\n          click: function click() {\n            if (res.assignee.indexOf('回退') == 0) {\n              //查询意见 table tableid 环节 任务id\n              var url = '/oaBus/dynamic/query';\n              var taskId = res.id;\n              var table = _this.record.table + '_opinion';\n              var dataId = _this.record.tableId;\n              postAction(url, {\n                i_busdata_id: dataId,\n                table: table,\n                s_task_id: taskId,\n                s_opinion_type: -1\n              }).then(function (res) {\n                if (res.success) {\n                  console.log();\n                  var h = _this.$createElement;\n                  var content = [];\n\n                  for (var i in res.result.records) {\n                    var msg = res.result.records[i];\n                    content.push(h('p', \"\".concat(msg.s_name, \" (\").concat(msg.s_dept_name, \") \\uFF1A\").concat(msg.s_opinion)));\n                  }\n\n                  if (content.length == 0) {\n                    content = ['暂无数据'];\n                  }\n\n                  var content_ = h('div', {}, content);\n\n                  var modal = _this.$success({\n                    title: '回退原因',\n                    content: content_\n                  });\n                } else {\n                  _this.$message.error('查询意见失败');\n                }\n              });\n            } else {\n              console.log('---------->>>>撤回没有意见');\n            }\n          }\n        }\n      };\n    },\n    backRecordClick: function backRecordClick() {\n      var _this2 = this;\n\n      var procInstId = this.record.processInstanceId;\n      var table = this.record.table + '_opinion';\n      var url = 'wf/task/backRecordQuery?procInstId=' + procInstId + '&table=' + table;\n      getAction(url).then(function (res) {\n        if (res.success) {\n          _this2.dataSource = res.result;\n          _this2.backRecord = true;\n          _this2.showPic = false;\n          _this2.trace = false;\n        } else {\n          _this2.$message.error(res.message);\n        }\n      });\n    },\n    show: function show(record) {\n      this.record = record;\n      this.showPict();\n    },\n    showPict: function showPict() {\n      var _this3 = this;\n\n      var procInstId = this.record.processInstanceId;\n      var taskDefinitionKey = this.record.taskDefinitionKey;\n      var processDefinitionId = this.record.processDefinitionId; //查询图片\n      // window._CONFIG['domianURL'] +\n\n      this.picurl = '/wf/process/resource/read?processDefinitionId=' + processDefinitionId + '&resourceType=image';\n      this.locationUrl = '/wf/task/pointLocationQuery?processId=' + procInstId + '&taskId=' + taskDefinitionKey + \"&processDefinitionId=\" + processDefinitionId;\n      picUrl(this.picurl).then(function (res) {\n        _this3.picurl = 'data:image/png;base64,' + btoa(new Uint8Array(res).reduce(function (data, byte) {\n          return data + String.fromCharCode(byte);\n        }, ''));\n        _this3.visible = true;\n      }); //坐标\n\n      getAction(this.locationUrl).then(function (res) {\n        _this3.styles = [];\n\n        for (var i in res.result) {\n          var x = res.result[i].x;\n          var y = res.result[i].y;\n          var width = res.result[i].width;\n          var height = res.result[i].height; // let style = \"position:absolute;left:\" + x + \"px;top:\" + (y + 31) + \"px;width:\" + (width + 1) + \"px;height:\" + (height + 1) + \"px\"\n\n          var style = \"position:absolute;left:\" + x + \"px;top:\" + y + \"px;width:\" + (width + 1) + \"px;height:\" + (height + 1) + \"px\";\n\n          _this3.styles.push(style);\n        }\n      });\n      this.showPic = true;\n      this.trace = false;\n      this.backRecord = false;\n    },\n    traceP: function traceP() {\n      var _this4 = this;\n\n      var url = 'oaBus/taskInAct/workTrack';\n      getAction(url, {\n        proInstId: this.record.processInstanceId\n      }).then(function (res) {\n        if (res.success) {\n          _this4.dataSource = res.result;\n          _this4.showPic = false;\n          _this4.trace = true;\n          _this4.backRecord = false;\n        } else {\n          _this4.$message.error(res.message);\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.$emit('close');\n      this.visible = false;\n    },\n    onSelectChange: function onSelectChange() {}\n  }\n};",{"version":3,"sources":["pic2Modal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    title=\"流程查看\"\r\n    :width=\"1000\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @ok=\"handleCancel\"\r\n    @cancel=\"handleCancel\"\r\n    destroyOnClose\r\n    cancelText=\"关闭\">\r\n    <div class=\"bingpai\">\r\n      <a-button @click=\"showPict\" block>流程图查看</a-button>\r\n      <a-button @click=\"traceP\" block>流程跟踪表</a-button>\r\n      <a-button @click=\"backRecordClick\" block>撤回/回退记录</a-button>\r\n    </div>\r\n    <div style=\"overflow: auto; position: relative;background-color: #f6f6f6;border: 1px solid #e0e0e0;\" :style=\"{height: scrHeight}\">\r\n\r\n\r\n\r\n\r\n      <div style=\"width:100%\" v-if=\"showPic\">\r\n\r\n\r\n        <div v-for=\"item in styles\" class=\"div\" :style='item'></div>\r\n\r\n        <img :src=\"picurl\" v-show=\"visible\"/>\r\n\r\n      </div>\r\n      <div v-if=\"trace\" style=\"width: 98%;margin: 1%;\">\r\n\r\n        <a-table\r\n          ref=\"table\"\r\n          size=\"middle\"\r\n          rowKey=\"taskKey\"\r\n          :columns=\"columns\"\r\n          :dataSource=\"dataSource\"\r\n          :rowClassName=\"(record,index) => {\r\n              let className  = 'light-row';\r\n              if (index % 2 === 1) className = 'dark-row';\r\n              return className;\r\n          }\"\r\n        >\r\n\r\n        </a-table>\r\n      </div>\r\n\r\n      <div v-if=\"backRecord\" style=\"width: 98%;margin: 1%;\">\r\n\r\n        <!--  :customRow=\"rowClick\"-->\r\n        <a-table\r\n          ref=\"table\"\r\n          size=\"middle\"\r\n          rowKey=\"taskKey\"\r\n          :columns=\"columns2\"\r\n          :dataSource=\"dataSource\"\r\n          :rowClassName=\"(record,index) => {\r\n              let className  = 'light-row';\r\n              if (index % 2 === 1) className = 'dark-row';\r\n              return className;\r\n          }\"\r\n        >\r\n\r\n        </a-table>\r\n      </div>\r\n\r\n    </div>\r\n\r\n\r\n  </a-modal>\r\n</template>\r\n<style type=\"text/css\">\r\n  .div {\r\n    border: 2px solid red;\r\n    padding: 5px;\r\n  }\r\n\r\n  .bingpai {\r\n    display: flex;\r\n    width: fit-content;\r\n  }\r\n\r\n</style>\r\n\r\n<script>\r\n\r\n  import {getAction, postAction, picUrl} from '@/api/manage'\r\n\r\n\r\n  export default {\r\n    name: \"pic2Modal\",\r\n    data() {\r\n      return {\r\n        scrHeight: window.innerHeight - 320 + 'px',\r\n        styles: [],\r\n        title: '流程查看',\r\n        confirmLoading: false,\r\n        visible: false,\r\n        trace: false,\r\n        showPic: true,\r\n        picurl: '',\r\n        locationUrl: '',\r\n        record: '',\r\n        //************* table **************\r\n        dataSource: [],\r\n        columns: [\r\n          {\r\n            title: '环节名称',\r\n            align: \"center\",\r\n            dataIndex: 'taskDefName'\r\n          },\r\n          {\r\n            title: '负责人',\r\n            align: \"center\",\r\n            dataIndex: 'userName'\r\n          },\r\n          {\r\n            title: '部门',\r\n            align: \"center\",\r\n            dataIndex: 'deptName'\r\n          },\r\n          {\r\n            title: '完成时间',\r\n            align: \"center\",\r\n            dataIndex: 'endTime'\r\n          },\r\n\r\n        ],\r\n        backRecord: false,\r\n        columns2: [\r\n          // {\r\n          //   title: '环节名称',\r\n          //   align: \"center\",\r\n          //   dataIndex: 'name'\r\n          // },\r\n          {\r\n            title: '撤回/回退人',\r\n            align: \"center\",\r\n            dataIndex: 'userName'\r\n          },\r\n          {\r\n            title: '撤回/回退记录',\r\n            align: \"left\",\r\n            dataIndex: 'log'\r\n          }, {\r\n            title: '回退原因',\r\n            align: \"left\",\r\n            dataIndex: 'backReason'\r\n          },\r\n          {\r\n            title: '完成时间',\r\n            align: \"center\",\r\n            dataIndex: 'endTime'\r\n          },\r\n\r\n        ]\r\n      }\r\n    },\r\n    created() {\r\n\r\n\r\n    },\r\n    methods: {\r\n      rowClick(res) {\r\n        return {\r\n          on: {\r\n            click: () => {\r\n              if (res.assignee.indexOf('回退') == 0) {\r\n                //查询意见 table tableid 环节 任务id\r\n                let url = '/oaBus/dynamic/query'\r\n                let taskId = res.id\r\n                let table = this.record.table + '_opinion'\r\n                let dataId = this.record.tableId\r\n                postAction(url, {\r\n                  i_busdata_id: dataId,\r\n                  table: table,\r\n                  s_task_id: taskId,\r\n                  s_opinion_type: -1\r\n                }).then(res => {\r\n                  if (res.success) {\r\n                    console.log()\r\n\r\n\r\n                    const h = this.$createElement;\r\n                    let content = []\r\n                    for (let i in res.result.records) {\r\n                      let msg = res.result.records[i]\r\n                      content.push(h('p', `${msg.s_name} (${msg.s_dept_name}) ：${msg.s_opinion}`))\r\n                    }\r\n\r\n                    if (content.length == 0) {\r\n                      content = ['暂无数据']\r\n                    }\r\n                    let content_ = h('div', {}, content)\r\n\r\n                    const modal = this.$success({\r\n                      title: '回退原因',\r\n                      content: content_,\r\n                    });\r\n\r\n                  } else {\r\n                    this.$message.error('查询意见失败')\r\n                  }\r\n                })\r\n\r\n              } else {\r\n                console.log('---------->>>>撤回没有意见')\r\n              }\r\n\r\n            }\r\n          }\r\n        }\r\n      },\r\n      backRecordClick() {\r\n        var procInstId = this.record.processInstanceId\r\n        let table = this.record.table + '_opinion'\r\n\r\n        let url = 'wf/task/backRecordQuery?procInstId=' + procInstId + '&table=' + table\r\n\r\n\r\n        getAction(url).then(res => {\r\n          if (res.success) {\r\n            this.dataSource = res.result\r\n            this.backRecord = true\r\n            this.showPic = false\r\n            this.trace = false\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n\r\n\r\n      },\r\n      show(record) {\r\n        this.record = record\r\n\r\n        this.showPict();\r\n\r\n      },\r\n      showPict() {\r\n        var procInstId = this.record.processInstanceId\r\n        var taskDefinitionKey = this.record.taskDefinitionKey\r\n        var processDefinitionId = this.record.processDefinitionId\r\n\r\n        //查询图片\r\n        // window._CONFIG['domianURL'] +\r\n        this.picurl = '/wf/process/resource/read?processDefinitionId='\r\n          + processDefinitionId + '&resourceType=image'\r\n        this.locationUrl = '/wf/task/pointLocationQuery?processId=' + procInstId + '&taskId=' + taskDefinitionKey\r\n          + \"&processDefinitionId=\" + processDefinitionId\r\n\r\n\r\n        picUrl(this.picurl).then(res => {\r\n          this.picurl = 'data:image/png;base64,' + btoa(new Uint8Array(res).reduce((data, byte) => data + String.fromCharCode(byte), ''));\r\n          this.visible = true;\r\n        })\r\n\r\n\r\n        //坐标\r\n        getAction(this.locationUrl).then(res => {\r\n\r\n          this.styles = []\r\n          for (let i in res.result) {\r\n            var x = res.result[i].x;\r\n            var y = res.result[i].y;\r\n            var width = res.result[i].width;\r\n            var height = res.result[i].height;\r\n            // let style = \"position:absolute;left:\" + x + \"px;top:\" + (y + 31) + \"px;width:\" + (width + 1) + \"px;height:\" + (height + 1) + \"px\"\r\n            let style = \"position:absolute;left:\" + x + \"px;top:\" + y + \"px;width:\" + (width + 1) + \"px;height:\" + (height + 1) + \"px\"\r\n            this.styles.push(style)\r\n          }\r\n\r\n        })\r\n\r\n\r\n        this.showPic = true\r\n        this.trace = false\r\n        this.backRecord = false\r\n\r\n\r\n      },\r\n\r\n      traceP() {\r\n        let url = 'oaBus/taskInAct/workTrack'\r\n\r\n\r\n        getAction(url, {\r\n          proInstId: this.record.processInstanceId\r\n\r\n        }).then(res => {\r\n          if (res.success) {\r\n            this.dataSource = res.result\r\n            this.showPic = false\r\n            this.trace = true\r\n            this.backRecord = false\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n\r\n\r\n      },\r\n      handleCancel() {\r\n        this.$emit('close');\r\n        this.visible = false;\r\n      }, onSelectChange() {\r\n      }\r\n\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ant-btn{\r\n  border-color: transparent;\r\n}\r\n\r\n.ant-btn:focus{\r\n  border:2px solid #bcbcbc;\r\n  border-bottom: transparent;\r\n}\r\n</style>"],"sourceRoot":"src/views/mytask/modules"}]}