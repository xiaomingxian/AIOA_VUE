{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js!C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\oaBus\\TestStandardList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\oaBus\\TestStandardList.vue","mtime":1579513669248},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.search\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport HeadInfo from '@/components/tools/HeadInfo';\nimport { getAction, postAction } from '@/api/manage'; // import jsonp from 'fetch-jsonp';\n\nimport querystring from 'querystring';\nimport debounce from 'lodash/debounce';\nexport default {\n  name: \"TestStandardList\",\n  components: {\n    HeadInfo: HeadInfo\n  },\n  data: function data() {\n    var _this = this;\n\n    this.lastFetchId = 0;\n    this.fetchUser = debounce(this.fetchUser, 800);\n    return {\n      defaultActivityKey: '0',\n      //默认为第一个tab\n      data: [],\n      fetching: false,\n      getPageList: [{\n        sname: '全文检索'\n      }, {\n        sname: '附件检索'\n      }],\n      search: '',\n      textData: [],\n      attachmentData: [],\n      dataSource: [],\n      pagination: {\n        current: 1,\n        pageSize: 10,\n        // pageSizeOptions: ['5', '10', '15', '20', '25', '30'],\n        showTotal: function showTotal(total, range) {\n          return \"共\" + total + \"条\";\n        },\n        // showQuickJumper: true,\n        // showSizeChanger: true,\n        total: 0,\n        onChange: function onChange(pageindex) {\n          console.log(pageindex);\n          _this.current = pageindex;\n          console.log(_this.defaultActivityKey); //检测测试为全文检索  还是附件检索\n\n          if (_this.defaultActivityKey == '0') {\n            //全文检索\n            _this.FilterAllFiles(_this.search, pageindex);\n          } else {\n            //附件检索\n            _this.FuJianFiles(_this.search, pageindex);\n          }\n        }\n      }\n    };\n  },\n  created: function created() {},\n  destroyed: function destroyed() {\n    this.dataDestroy();\n  },\n  methods: {\n    //---切换页签-----\n    changeTabs: function changeTabs(e) {\n      console.log(e); //切换Tabs时  清空dataSourse\n\n      this.dataSource = [];\n      this.defaultActivityKey = e.toString(); //点击查询按钮检测  检测是否填写\n\n      if (this.search) {\n        //若用户已填写 判断此时Tab 是全文检索0   附件检索1\n        if (e == '0') {\n          //全文检索\n          this.FilterAllFiles(this.search);\n        } else {\n          //附件检索\n          this.FuJianFiles(this.search);\n        }\n      } else {\n        this.$message.error('请输入搜索内容');\n      }\n    },\n    //---切换分页-----\n    changePage: function changePage(e) {\n      console.log(e);\n    },\n    fetchUser: function fetchUser(value) {\n      var _this2 = this;\n\n      // console.log('fetching user', value);\n      this.lastFetchId += 1;\n      var fetchId = this.lastFetchId;\n      this.data = [];\n      this.fetching = true;\n      var url = \"/oaEs/oaelasticsearch/getsearch\";\n      postAction(url, {\n        keyWord: value\n      }).then(function (res) {\n        if (fetchId !== _this2.lastFetchId) {\n          // for fetch callback order\n          return;\n        }\n\n        for (var i = 0; i < res.result.length; i++) {\n          _this2.data.push({\n            text: res.result[i].keyWord,\n            value: res.result[i].id\n          });\n        }\n\n        _this2.fetching = false;\n      });\n    },\n    handleChange: function handleChange(obj) {\n      //判断  全文检索搜索框是否输入    检测输入变化则赋值  否则清空变量\n      if (obj) {\n        console.log(obj);\n        this.search = obj.key;\n      } else {\n        this.search = '';\n      } // Object.assign(this, {\n      //   value,\n      //   data: [],\n      //   fetching: false,\n      // });\n\n    },\n    getTextSearch: function getTextSearch(defaultActivityKey) {\n      console.log(this.search);\n      console.log(defaultActivityKey); //点击查询按钮检测  检测是否填写\n\n      if (this.search) {\n        //若用户已填写 判断此时Tab 是全文检索0   附件检索1\n        if (defaultActivityKey == '0') {\n          //全文检索\n          this.FilterAllFiles(this.search);\n        } else {\n          //附件检索\n          this.FuJianFiles(this.search);\n        }\n      } else {\n        this.$message.error('请输入搜索内容');\n      }\n    },\n    //--------全文检索------------\n    FilterAllFiles: function FilterAllFiles(serchval) {\n      var _this3 = this;\n\n      var pageindex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '1';\n      var url = \"/oaEs/oaelasticsearch/list\";\n      postAction(url, {\n        keyWord: serchval,\n        pageNo: pageindex\n      }).then(function (res) {\n        console.log(res);\n\n        if (res.success) {\n          _this3.pagination.total = res.result.total;\n          _this3.dataSource = res.result.records;\n        } else {\n          _this3.$message.error('查询失败');\n        } // for (let i = 0; i < res.result.records.length; i++) {\n        //   this.textData.push({\n        //     title: res.result.records[i].s_cur_proc_name,\n        //     description: res.result.records[i].s_title,\n        //   });\n        // }\n\n      });\n    },\n    //--------附件检索-------------\n    FuJianFiles: function FuJianFiles(serchval) {\n      var _this4 = this;\n\n      var pageindex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '1';\n      var url = \"/oaEs/oaelasticsearch/oafile\";\n      postAction(url, {\n        keyWord: serchval,\n        pageNo: pageindex\n      }).then(function (res) {\n        if (res.success) {\n          _this4.pagination.total = res.result.total;\n          _this4.dataSource = res.result.records;\n        } else {\n          _this4.$message.error('查询失败');\n        } // for (let i = 0; i < res.result.records.length; i++) {\n        //   this.attachmentData.push({\n        //     title: res.result.records[i].s_file_name,\n        //     description: res.result.records[i].s_title,\n        //   });\n        // }\n\n      });\n    },\n    getPgSearchList: function getPgSearchList(iBMId) {\n      console.log(iBMId); // for(let i=0;i<this.dataSource.length;i++){\n      //   this.dataSource[i].length=0;\n      // }\n\n      this.getTextSearch(this.defaultActivityKey); // this.getAttachmentSearch(iBMId);\n      //\n      // this.dataSource.push(this.textData,this.attachmentData);\n    },\n    dataDestroy: function dataDestroy() {\n      this.pagination = [];\n      this.textData = [], this.attachmentData = [], this.dataSource = [];\n    }\n  }\n};",{"version":3,"sources":["TestStandardList.vue"],"names":[],"mappings":"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","sourcesContent":["<style>\r\n\r\n  /*.ant-tabs-nav-scroll{*/\r\n    /*height:39px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar{*/\r\n    /*border:none;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-nav{*/\r\n    /*!*background-color: #ffadd2;*!*/\r\n    /*border:1px solid #909090;*/\r\n    /*border-radius: 25%;*/\r\n    /*height: 27px;*/\r\n    /*top: 5px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-tab{*/\r\n    /*font-size: 14px;*/\r\n    /*padding-top: 2px;*/\r\n    /*margin-right: 0px;*/\r\n    /*bottom: 1px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-tab:hover{*/\r\n    /*color: #0061cb;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-tab-active{*/\r\n    /*color: #fff;*/\r\n    /*background-color: #7d70ff;*/\r\n    /*border-radius: 27%;*/\r\n    /*height:27px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-ink-bar-animated{*/\r\n    /*display: none !important;*/\r\n  /*}*/\r\n\r\n\r\n</style>\r\n\r\n<template>\r\n  <div class=\"table-page-search-wrapper\">\r\n    <a-card :bordered=false>\r\n      <a-form layout=\"inline\" style=\"text-align: center; margin-top: 20px\">\r\n        <a-row :gutter=\"24\">\r\n          <a-col :md=\"8\" :sm=\"24\" style=\"margin-left:385px;\">\r\n              <a-select\r\n                mode=\"combobox\"\r\n                labelInValue\r\n                placeholder=\"公文检索\"\r\n                style=\"width: 100%\"\r\n                @search=\"fetchUser\"\r\n                @change=\"handleChange\"\r\n                :showArrow=\"false\"\r\n                :allowClear=\"true\"\r\n                :defaultActiveFirstOption=\"false\"\r\n                :notFoundContent=\"fetching ? undefined : null\"\r\n              >\r\n                <a-spin v-if=\"fetching\" slot=\"notFoundContent\" size=\"small\" />\r\n                <a-select-option v-for=\"d in data\" :key=\"d.text\">{{d.text}}</a-select-option>\r\n            </a-select>\r\n          </a-col>\r\n\r\n          <a-col :md=\"1\" :sm=\"24\" >\r\n            <span class=\"table-page-search-submitButtons\">\r\n              <a-button type=\"primary\" icon=\"search\" @click=\"getPgSearchList\">查询</a-button>\r\n            </span>\r\n          </a-col>\r\n        </a-row>\r\n        <!--<a-row :gutter=\"48\">-->\r\n        <!--<a-col :md=\"24\" :sm=\"24\" >-->\r\n        <!--<span class=\"table-page-search-submitButtons\" :style=\"advanced && { overflow: 'hidden' } || {} \">-->\r\n        <!--<a-button type=\"primary\" @click=\"getPgSearchList\">查询</a-button>-->\r\n        <!--</span>-->\r\n        <!--</a-col>-->\r\n        <!--</a-row>-->\r\n      </a-form>\r\n\r\n\r\n\r\n      <a-tabs\r\n        :default-active-key=\"0\"\r\n        @change=\"changeTabs\"\r\n      >\r\n        <a-tab-pane :tab=\"titleItem.sname\" v-for=\"(titleItem,titleIndex) in getPageList\" :key=\"titleIndex\">\r\n          <a-list size=\"large\" :pagination=\"pagination\" >\r\n            <a-list-item :key=\"index\" v-for=\"(item, index) in dataSource\">\r\n\r\n             <span v-if=\"defaultActivityKey=='0'\" v-html=\"item.s_title\"></span>\r\n             <span v-else v-html=\"item.sFileName\"></span>\r\n              <!--<a-list-item-meta>-->\r\n                <!--<a slot=\"title\" v-html=\"item.title\"></a>-->\r\n                <!--<p slot=\"description\" v-html=\"item.description\"></p>-->\r\n              <!--</a-list-item-meta>-->\r\n            </a-list-item>\r\n          </a-list>\r\n        </a-tab-pane>\r\n      </a-tabs>\r\n\r\n\r\n    </a-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import HeadInfo from '@/components/tools/HeadInfo'\r\n  import { getAction, postAction } from '@/api/manage'\r\n  // import jsonp from 'fetch-jsonp';\r\n  import querystring from 'querystring';\r\n  import debounce from 'lodash/debounce';\r\n\r\n  export default {\r\n    name: \"TestStandardList\",\r\n    components: {\r\n      HeadInfo\r\n    },\r\n    data() {\r\n      this.lastFetchId = 0;\r\n      this.fetchUser = debounce(this.fetchUser, 800);\r\n      return {\r\n        defaultActivityKey:'0',//默认为第一个tab\r\n        data: [],\r\n        fetching: false,\r\n        getPageList: [\r\n          {\r\n            sname:'全文检索'\r\n          },\r\n          {\r\n            sname:'附件检索'\r\n          }\r\n        ],\r\n        search: '',\r\n        textData:[],\r\n        attachmentData:[],\r\n        dataSource: [],\r\n        pagination: {\r\n          current: 1,\r\n          pageSize: 10,\r\n          // pageSizeOptions: ['5', '10', '15', '20', '25', '30'],\r\n          showTotal: (total, range) => {\r\n            return \"共\" + total + \"条\"\r\n          },\r\n          // showQuickJumper: true,\r\n          // showSizeChanger: true,\r\n          total: 0,\r\n          onChange:pageindex=>{\r\n            console.log(pageindex);\r\n            this.current = pageindex;\r\n            console.log(this.defaultActivityKey);\r\n            //检测测试为全文检索  还是附件检索\r\n            if(this.defaultActivityKey=='0'){\r\n              //全文检索\r\n              this.FilterAllFiles(this.search,pageindex);\r\n            }else{\r\n              //附件检索\r\n              this.FuJianFiles(this.search,pageindex);\r\n            }\r\n\r\n          }\r\n        },\r\n      }\r\n    },\r\n    created() {\r\n\r\n    },\r\n    destroyed(){\r\n      this.dataDestroy();\r\n    },\r\n    methods: {\r\n      //---切换页签-----\r\n      changeTabs(e){\r\n        console.log(e);\r\n        //切换Tabs时  清空dataSourse\r\n        this.dataSource = [];\r\n        this.defaultActivityKey = e.toString()\r\n        //点击查询按钮检测  检测是否填写\r\n        if(this.search){\r\n          //若用户已填写 判断此时Tab 是全文检索0   附件检索1\r\n          if(e=='0'){\r\n            //全文检索\r\n            this.FilterAllFiles(this.search);\r\n          }else{\r\n            //附件检索\r\n            this.FuJianFiles(this.search);\r\n          }\r\n\r\n        }else{\r\n          this.$message.error('请输入搜索内容')\r\n        }\r\n\r\n      },\r\n      //---切换分页-----\r\n      changePage(e){\r\n        console.log(e);\r\n      },\r\n      fetchUser(value) {\r\n        // console.log('fetching user', value);\r\n        this.lastFetchId += 1;\r\n        const fetchId = this.lastFetchId;\r\n        this.data = [];\r\n        this.fetching = true;\r\n        let url = \"/oaEs/oaelasticsearch/getsearch\";\r\n        postAction(url, {keyWord: value}).then((res) => {\r\n            if (fetchId !== this.lastFetchId) {\r\n              // for fetch callback order\r\n              return;\r\n            }\r\n\r\n          for(let i = 0;i<res.result.length;i++){\r\n            this.data.push({\r\n              text: res.result[i].keyWord,\r\n              value: res.result[i].id\r\n            });\r\n          }\r\n            this.fetching = false;\r\n          });\r\n      },\r\n      handleChange(obj) {\r\n\r\n        //判断  全文检索搜索框是否输入    检测输入变化则赋值  否则清空变量\r\n        if(obj){\r\n          console.log(obj);\r\n          this.search = obj.key;\r\n        }else{\r\n          this.search = '';\r\n        }\r\n        // Object.assign(this, {\r\n        //   value,\r\n        //   data: [],\r\n        //   fetching: false,\r\n        // });\r\n      },\r\n      getTextSearch(defaultActivityKey) {\r\n\r\n        console.log(this.search);\r\n        console.log(defaultActivityKey);\r\n\r\n        //点击查询按钮检测  检测是否填写\r\n        if(this.search){\r\n          //若用户已填写 判断此时Tab 是全文检索0   附件检索1\r\n          if(defaultActivityKey=='0'){\r\n            //全文检索\r\n            this.FilterAllFiles(this.search);\r\n          }else{\r\n            //附件检索\r\n            this.FuJianFiles(this.search);\r\n          }\r\n\r\n        }else{\r\n          this.$message.error('请输入搜索内容')\r\n        }\r\n\r\n      },\r\n      //--------全文检索------------\r\n      FilterAllFiles(serchval,pageindex='1'){\r\n        let url = \"/oaEs/oaelasticsearch/list\";\r\n        postAction(url, {keyWord:serchval,pageNo:pageindex}).then((res) => {\r\n          console.log(res);\r\n          if(res.success){\r\n            this.pagination.total =  res.result.total;\r\n            this.dataSource = res.result.records;\r\n          }else{\r\n            this.$message.error('查询失败')\r\n          }\r\n\r\n          // for (let i = 0; i < res.result.records.length; i++) {\r\n          //   this.textData.push({\r\n          //     title: res.result.records[i].s_cur_proc_name,\r\n          //     description: res.result.records[i].s_title,\r\n          //   });\r\n          // }\r\n        });\r\n      },\r\n      //--------附件检索-------------\r\n      FuJianFiles(serchval,pageindex='1') {\r\n        let url = \"/oaEs/oaelasticsearch/oafile\";\r\n        postAction(url, {keyWord:serchval,pageNo:pageindex}).then((res) => {\r\n          if(res.success){\r\n            this.pagination.total =  res.result.total;\r\n            this.dataSource = res.result.records;\r\n          }else{\r\n            this.$message.error('查询失败')\r\n          }\r\n          // for (let i = 0; i < res.result.records.length; i++) {\r\n          //   this.attachmentData.push({\r\n          //     title: res.result.records[i].s_file_name,\r\n          //     description: res.result.records[i].s_title,\r\n          //   });\r\n          // }\r\n        });\r\n      },\r\n      getPgSearchList(iBMId) {\r\n\r\n        console.log(iBMId);\r\n\r\n        // for(let i=0;i<this.dataSource.length;i++){\r\n        //   this.dataSource[i].length=0;\r\n        // }\r\n\r\n        this.getTextSearch(this.defaultActivityKey);\r\n\r\n        // this.getAttachmentSearch(iBMId);\r\n        //\r\n        // this.dataSource.push(this.textData,this.attachmentData);\r\n\r\n      },\r\n      dataDestroy(){\r\n        this.pagination = [];\r\n        this.textData = [],\r\n        this.attachmentData = [],\r\n        this.dataSource = [];\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .table-page-search-submitButtons .ant-btn{\r\n    background:linear-gradient(180deg,rgba(115,128,255,1),rgba(47,86,255,1)) repeat scroll 0% 0%;\r\n  }\r\n\r\n  .table-page-search-submitButtons .ant-btn svg{\r\n    fill:cyan;\r\n  }\r\n\r\n  /deep/.ant-card-body{\r\n    min-height: 650px !important;\r\n  }\r\n  /deep/.ant-spin-container{\r\n    min-height: 400px !important;\r\n  }\r\n\r\n\r\n  .ant-avatar-lg {\r\n    width: 48px;\r\n    height: 48px;\r\n    line-height: 48px;\r\n  }\r\n\r\n  .list-content-item {\r\n    color: rgba(0, 0, 0, .45);\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    font-size: 14px;\r\n    margin-left: 40px;\r\n    span {\r\n      line-height: 20px;\r\n    }\r\n    p {\r\n      margin-top: 4px;\r\n      margin-bottom: 0;\r\n      line-height: 22px;\r\n    }\r\n  }\r\n</style>"],"sourceRoot":"src/views/oaBus"}]}