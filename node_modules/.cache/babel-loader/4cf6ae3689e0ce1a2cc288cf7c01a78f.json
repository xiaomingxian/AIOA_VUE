{"remainingRequest":"D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\src\\utils\\JEditableTableUtil.js","dependencies":[{"path":"D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\src\\utils\\JEditableTableUtil.js","mtime":1568535226389},{"path":"D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568345883562},{"path":"D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1568345858740},{"path":"D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1568345873200}],"contextDependencies":[],"result":["import _typeof from \"D:\\\\ProgramFiles\\\\ideaIUWork\\\\jeecg-boot\\\\ant-design-vue-jeecg\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nvar FormTypes = {\n  normal: 'normal',\n  input: 'input',\n  inputNumber: 'inputNumber',\n  checkbox: 'checkbox',\n  select: 'select',\n  date: 'date',\n  datetime: 'datetime',\n  upload: 'upload',\n  slot: 'slot',\n  hidden: 'hidden'\n};\nvar VALIDATE_NO_PASSED = Symbol();\nexport { FormTypes, VALIDATE_NO_PASSED };\n/**\r\n * 获取指定的 $refs 对象\r\n * 有时候可能会遇到组件未挂载到页面中的情况，导致无法获取 $refs 中的某个对象\r\n * 这个方法可以等待挂载完成之后再返回 $refs 的对象，避免报错\r\n * @author sunjianlei\r\n **/\n\nexport function getRefPromise(vm, name) {\n  return new Promise(function (resolve) {\n    (function next() {\n      var ref = vm.$refs[name];\n\n      if (ref) {\n        resolve(ref);\n      } else {\n        setTimeout(function () {\n          next();\n        }, 10);\n      }\n    })();\n  });\n}\n/**\r\n * 一次性验证主表单和所有的次表单\r\n * @param form 主表单 form 对象\r\n * @param cases 接收一个数组，每项都是一个JEditableTable实例\r\n * @returns {Promise<any>}\r\n * @author sunjianlei\r\n */\n\nexport function validateFormAndTables(form, cases) {\n  if (!(form && typeof form.validateFields === 'function')) {\n    throw \"form \\u53C2\\u6570\\u9700\\u8981\\u7684\\u662F\\u4E00\\u4E2Aform\\u5BF9\\u8C61\\uFF0C\\u800C\\u4F20\\u5165\\u7684\\u5374\\u662F\".concat(_typeof(form));\n  }\n\n  var options = {};\n  return new Promise(function (resolve, reject) {\n    // 验证主表表单\n    form.validateFields(function (err, values) {\n      err ? reject({\n        error: VALIDATE_NO_PASSED\n      }) : resolve(values);\n    });\n  }).then(function (values) {\n    Object.assign(options, {\n      formValue: values\n    }); // 验证所有子表的表单\n\n    return validateTables(cases);\n  }).then(function (all) {\n    Object.assign(options, {\n      tablesValue: all\n    });\n    return Promise.resolve(options);\n  }).catch(function (error) {\n    return Promise.reject(error);\n  });\n}\n/**\r\n * 验证并获取一个或多个表格的所有值\r\n * @param cases 接收一个数组，每项都是一个JEditableTable实例\r\n * @author sunjianlei\r\n */\n\nexport function validateTables(cases) {\n  if (!(cases instanceof Array)) {\n    throw \"'validateTables'\\u51FD\\u6570\\u7684'cases'\\u53C2\\u6570\\u9700\\u8981\\u7684\\u662F\\u4E00\\u4E2A\\u6570\\u7EC4\\uFF0C\\u800C\\u4F20\\u5165\\u7684\\u5374\\u662F\".concat(_typeof(cases));\n  }\n\n  return new Promise(function (resolve, reject) {\n    var tables = [];\n    var index = 0;\n\n    (function next() {\n      var vm = cases[index];\n      vm.getAll(true).then(function (all) {\n        tables[index] = all; // 判断校验是否全部完成，完成返回成功，否则继续进行下一步校验\n\n        if (++index === cases.length) {\n          resolve(tables);\n        } else next();\n      }, function (error) {\n        // 出现未验证通过的表单，不再进行下一步校验，直接返回失败并跳转到该表格\n        if (error === VALIDATE_NO_PASSED) {\n          reject({\n            error: VALIDATE_NO_PASSED,\n            index: index\n          });\n        }\n\n        reject(error);\n      });\n    })();\n  });\n}",{"version":3,"sources":["D:\\ProgramFiles\\ideaIUWork\\jeecg-boot\\ant-design-vue-jeecg\\src\\utils\\JEditableTableUtil.js"],"names":["FormTypes","normal","input","inputNumber","checkbox","select","date","datetime","upload","slot","hidden","VALIDATE_NO_PASSED","Symbol","getRefPromise","vm","name","Promise","resolve","next","ref","$refs","setTimeout","validateFormAndTables","form","cases","validateFields","options","reject","err","values","error","then","Object","assign","formValue","validateTables","all","tablesValue","catch","Array","tables","index","getAll","length"],"mappings":"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","sourcesContent":["const FormTypes = {\r\n  normal: 'normal',\r\n  input: 'input',\r\n  inputNumber: 'inputNumber',\r\n  checkbox: 'checkbox',\r\n  select: 'select',\r\n  date: 'date',\r\n  datetime: 'datetime',\r\n  upload: 'upload',\r\n  slot: 'slot',\r\n  hidden: 'hidden'\r\n}\r\nconst VALIDATE_NO_PASSED = Symbol()\r\nexport { FormTypes, VALIDATE_NO_PASSED }\r\n\r\n/**\r\n * 获取指定的 $refs 对象\r\n * 有时候可能会遇到组件未挂载到页面中的情况，导致无法获取 $refs 中的某个对象\r\n * 这个方法可以等待挂载完成之后再返回 $refs 的对象，避免报错\r\n * @author sunjianlei\r\n **/\r\nexport function getRefPromise(vm, name) {\r\n  return new Promise((resolve) => {\r\n    (function next() {\r\n      let ref = vm.$refs[name]\r\n      if (ref) {\r\n        resolve(ref)\r\n      } else {\r\n        setTimeout(() => {\r\n          next()\r\n        }, 10)\r\n      }\r\n    })()\r\n  })\r\n}\r\n\r\n/**\r\n * 一次性验证主表单和所有的次表单\r\n * @param form 主表单 form 对象\r\n * @param cases 接收一个数组，每项都是一个JEditableTable实例\r\n * @returns {Promise<any>}\r\n * @author sunjianlei\r\n */\r\nexport function validateFormAndTables(form, cases) {\r\n\r\n  if (!(form && typeof form.validateFields === 'function')) {\r\n    throw `form 参数需要的是一个form对象，而传入的却是${typeof form}`\r\n  }\r\n\r\n  let options = {}\r\n  return new Promise((resolve, reject) => {\r\n    // 验证主表表单\r\n    form.validateFields((err, values) => {\r\n      err ? reject({ error: VALIDATE_NO_PASSED }) : resolve(values)\r\n    })\r\n  }).then(values => {\r\n    Object.assign(options, { formValue: values })\r\n    // 验证所有子表的表单\r\n    return validateTables(cases)\r\n  }).then(all => {\r\n    Object.assign(options, { tablesValue: all })\r\n    return Promise.resolve(options)\r\n  }).catch(error => {\r\n    return Promise.reject(error)\r\n  })\r\n\r\n}\r\n\r\n/**\r\n * 验证并获取一个或多个表格的所有值\r\n * @param cases 接收一个数组，每项都是一个JEditableTable实例\r\n * @author sunjianlei\r\n */\r\nexport function validateTables(cases) {\r\n  if (!(cases instanceof Array)) {\r\n    throw `'validateTables'函数的'cases'参数需要的是一个数组，而传入的却是${typeof cases}`\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    let tables = []\r\n    let index = 0;\r\n    (function next() {\r\n      let vm = cases[index]\r\n      vm.getAll(true).then(all => {\r\n        tables[index] = all\r\n        // 判断校验是否全部完成，完成返回成功，否则继续进行下一步校验\r\n        if (++index === cases.length) {\r\n          resolve(tables)\r\n        } else (\r\n          next()\r\n        )\r\n      }, error => {\r\n        // 出现未验证通过的表单，不再进行下一步校验，直接返回失败并跳转到该表格\r\n        if (error === VALIDATE_NO_PASSED) {\r\n          reject({ error: VALIDATE_NO_PASSED, index })\r\n        }\r\n        reject(error)\r\n      })\r\n    })()\r\n  })\r\n}"]}]}