{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\buttons\\DengjiwenhaoModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\buttons\\DengjiwenhaoModal.vue","mtime":1578367501981},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {httpAction} from '@/api/manage'\nimport Vue from 'vue'\nimport {ACCESS_TOKEN} from \"../../store/mutation-types\";\nimport pick from 'lodash.pick'\nimport {getAction} from '@/api/manage'\n\nconst columns = [\n  {\n    title: '空号',\n    dataIndex: 'idocNum',\n    width: '20%'\n  },\n  {\n    title: '是否线下占用',\n    dataIndex: 'ibusdataId',\n    width: '20%'\n  },\n\n  {\n    title: '操作',\n    dataIndex: 'work',\n    width: '20%',\n    scopedSlots: {customRender: 'action'},\n  },]\n\nconst data = []\nexport default {\n  name: \"DengjiwenhaoModal\",\n  data() {\n    return {\n      title: \"登记文号\",\n      visible: false,\n      visible1: false,  //线下占用modal\n      docnumData: {\n        id: '',\n        docnum: ''\n      },\n      setid: '',\n      loading: true,\n      defaultYear: new Date().getFullYear(),\n      model: {},\n      listName: '展开空号列表',\n      headers: {'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)},\n      columns,\n      numId: '',\n      numLists: [],\n      modelData: '',\n      docnum: '',\n      docwordNum: '',\n      isshowTable: false,\n      yearData: [\n        {id: new Date().getFullYear(), name: new Date().getFullYear()},\n        {id: new Date().getFullYear() - 1, name: new Date().getFullYear() - 1}\n      ],\n      selectData: [],\n      secoendData: '',//发送对象值\n      selectedModel: '',\n      wenhao: '',\n      sendObj: '',\n      table: '',\n      functionId: '',\n      busdataId: '',\n      pagination: {\n        current: '',\n        total: '',\n      },\n      columns,\n      data,\n      labelCol: {\n        xs: {span: 24},\n        sm: {span: 5},\n      },\n      wrapperCol: {\n        xs: {span: 24},\n        sm: {span: 16},\n      },\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      validatorRules: {\n        // iId:{rules: [{ required: true, message: '请输入主键id!' }]},\n      },\n      url: {\n        namelist: \"/papertitle/docNumSet/getDocNumList\",\n        numlist: \"/docnum/docNumManage/getNumList\",\n        setNum: \"/docnum/docNumManage/setNum\",\n        selectNum: \"/docnum/docNumManage/selectNum\",\n        sendobj: \"/papertitle/docNumSet/queryById\",\n\n      },\n    }\n  },\n  created() {\n  },\n  methods: {\n    //展开空号列表\n    showTable() {\n      console.log(Boolean(this.selectedModel));\n      if (Boolean(this.selectedModel)) {\n        // console.log(this.isshowTable);\n        getAction(this.url.numlist, {iDocnumId: this.numId, sYear: this.defaultYear}).then((res) => {\n          // console.log(res.result);\n          //分页\n          this.pagination.total = res.result.total;\n          let resNumLists = res.result.records;\n          resNumLists.map((item) => {\n            if (!Boolean(item.ibusdataId)) {\n              item.ibusdataId = '否'\n            } else {\n              item.ibusdataId = '是'\n            }\n          });\n          this.numLists = resNumLists;\n          this.loading = false;\n\n        });\n\n        if (this.isshowTable) {\n          this.isshowTable = false;\n          this.listName = '展开空号列表';\n        } else {\n          this.listName = '收起空号列表';\n          this.isshowTable = true;\n        }\n      } else {\n\n        this.$notification['warning']({\n          message: '温馨提示',\n          description: '先选择文件字'\n        })\n      }\n\n    },\n    //分页事件\n    changePagenation(pagination) {\n      // console.log(pagination);\n      const pager = {...this.pagination};\n      pager.current = pagination.current;\n      this.pagination = pager;\n      console.log(pager);\n\n      getAction(this.url.numlist, {\n        iDocnumId: this.numId,\n        sYear: this.defaultYear,\n        pageNo: this.pagination.current\n      }).then((res) => {\n        console.log(res.result);\n        //分页\n        this.pagination.total = res.result.total;\n        let resNumLists = res.result.records;\n        resNumLists.map((item) => {\n          if (!Boolean(item.ibusdataId)) {\n            item.ibusdataId = '否'\n          } else {\n            item.ibusdataId = '是'\n          }\n        });\n        this.numLists = resNumLists;\n      })\n\n    },\n    getNowNum(event){\n      this.docnum = event.srcElement.value;\n      this.docwordNum = this.selectedModel.label.trim() + '〔' + this.defaultYear + '〕' + this.docnum + '号';\n    },\n    dengji(record) {\n      this.busdataId = record.i_id;\n      this.functionId = record.i_bus_function_id;\n      this.table = record.table;\n      this.visible = true;\n      this.getDocNumList();\n    },\n    close() {\n      this.$emit('close');\n      this.selectData = \"\",\n      this.secoendData = \"\",\n      this.selectedModel = \"\",\n      this.wenhao = \"\",\n      this.sendObj = \"\",\n      this.table = \"\",\n      this.functionId = \"\",\n      this.busdataId = \"\",\n      this.docnum = '',\n      // this.docwordNum = '',\n      this.visible = false;\n    },\n    handleOk() {\n      let iSend = '';\n      if (this.selectedModel) {\n        if (this.secoendData === \"上报\") {\n          iSend = 1;\n        } else {\n          iSend = 2;\n        }\n        getAction(this.url.setNum, {\n          iDocnumId: this.numId,\n          sYear: this.defaultYear,\n          iDocNum: this.docnum,\n          sBusdataTable: this.table,\n          iBusdataId: this.busdataId,\n          iSendObj: iSend\n        }).then((res) => {\n          this.docnumData.id = res.result.iid;\n          this.docnumData.docnum = this.docwordNum;\n          // alert(JSON.stringify(this.docnumData))\n          this.$emit('saveDocNum', this.docnumData)\n        })\n        this.close()\n      } else {\n        this.$notification['warning']({\n          message: '温馨提示',\n          description: '先选择文件字'\n        })\n      }\n\n    },\n    handleDenji() {\n      this.close()\n    },\n    use(e) {\n      console.log(e);\n\n      getAction(this.url.selectNum, {iId: e.iid, iBusdataId: this.busdataId}).then((res) => {\n        let idocNum = e.idocNum;\n        this.docnum = idocNum;\n        this.docwordNum = this.wenhao.trim() + '〔' + this.defaultYear + '〕' + this.docnum + '号';\n        getAction(this.url.numlist, {iDocnumId: this.numId, sYear: this.defaultYear}).then((res) => {\n          console.log(res.result);\n          //分页\n          this.pagination.total = res.result.total;\n          let resNumLists = res.result.records;\n          resNumLists.map((item) => {\n            if (!Boolean(item.ibusdataId)) {\n              item.ibusdataId = '否'\n            } else {\n              item.ibusdataId = '是'\n            }\n          });\n          this.numLists = resNumLists;\n        })\n      })\n    },\n    set(e) {\n      console.log(e);\n      this.visible1 = true;\n      this.setid = e.iid;\n\n    },\n    //设置线下占用确定按钮\n    openok() {\n      getAction(this.url.selectNum, {\n          iId: this.setid,\n          iBusdataId: -1\n        }\n      ).then((res) => {\n        getAction(this.url.numlist, {\n          iDocnumId: this.numId,\n          sYear: this.defaultYear,\n          pageNo: this.pagination.current\n        }).then((res) => {\n          console.log(res.result);\n          //分页\n          this.pagination.total = res.result.total;\n          let resNumLists = res.result.records;\n          resNumLists.map((item) => {\n            if (!Boolean(item.ibusdataId)) {\n              item.ibusdataId = '否'\n            } else {\n              item.ibusdataId = '是'\n            }\n          });\n          this.numLists = resNumLists;\n        });\n      })\n      this.visible1 = false;\n    },\n    cancelModal() {\n      this.visible1 = false;\n    },\n    //查询文件字列表\n    getDocNumList() {\n      //let that = this;\n      let url = this.url.namelist;\n      getAction(url, {iBusFunctionId: this.functionId}).then((res) => {\n        this.modelData = res.result;\n\n      })\n    },\n    getModalVal(val) {\n      this.numId = val.key;\n      this.wenhao = val.label;\n      setTimeout(() => {\n        console.log('-------', this.docnum)\n        this.docwordNum = val.label.trim() + '〔' + this.defaultYear + '〕' + that.docnum + '号';\n      }, 200)\n      let that = this;\n      let url = that.url.sendobj;\n      getAction(url, {id: val.key}).then((res) => {\n        that.docnum = res.result.idocNum+1;\n        let iud = res.result.iutemplateId;\n        let idd = res.result.idtemplateId;\n        let arr = [];\n        if (iud) {\n          arr.push({id: '1', name: '上报'})\n        } else {\n          arr.splice(0, 1);\n\n        }\n        if (idd) {\n          arr.push({id: '2', name: '下发'})\n        } else {\n          arr.splice(1, 2);\n\n        }\n        this.selectData = arr;\n        console.log(this.selectData);\n        this.secoendData = this.selectData[0].name;\n        this.docwordNum = val.label.trim() + '〔' + this.defaultYear + '〕' + that.docnum + '号';\n        // console.log(this.selectedModel)\n        // this.docwordNum = that.modelData[val.key].name+that.docnum\n      })\n    },\n\n    changeYear(e) {\n      console.log(e);\n      this.defaultYear = e;\n      this.docwordNum = this.wenhao + '〔' + e + '〕' + this.docnum + '号';\n\n    }\n  }\n}\n",{"version":3,"sources":["DengjiwenhaoModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"DengjiwenhaoModal.vue","sourceRoot":"src/views/buttons","sourcesContent":["<template>\r\n  <a-modal\r\n    :title=\"title\"\r\n    :width=\"800\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @ok=\"handleOk\"\r\n    @cancel=\"handleDenji\"\r\n\r\n    cancelText=\"关闭\">\r\n\r\n    <div class=\"box\">\r\n      <div class=\"line1\">\r\n        <p>\r\n          <span>文件字</span>\r\n          <a-select v-model=\"selectedModel\" style=\"width: 200px\" labelInValue=\"true\" @change=\"getModalVal\">\r\n            <a-select-option v-for=\"(item,index) in modelData\" :key=\"index\" :value=\"item.iid\">{{item.sname}}\r\n            </a-select-option>\r\n          </a-select>\r\n        </p>\r\n        <p>\r\n          <span>发送对象</span>\r\n          <a-select style=\"width: 260px\" v-model=\"secoendData\">\r\n            <a-select-option v-for=\"(item,index) in selectData\" :key=\"index\" :value=\"item.id\">{{item.name}}\r\n            </a-select-option>\r\n          </a-select>\r\n        </p>\r\n      </div>\r\n\r\n      <div class=\"line2\">\r\n        <p>\r\n          <span>文件号</span>\r\n          <a-input  v-model=\"docnum\" style=\"width: 150px;\" placeholder=\"文件号\" @change=\"getNowNum($event)\"></a-input>\r\n          <a-button type=\"primary\" style=\"margin-left: 10px;\" @click=\"showTable\">{{listName}}</a-button>\r\n        </p>\r\n        <p>\r\n          <span>年份</span>\r\n          <a-select v-model=\"defaultYear\" style=\"width:260px\" @change=\"changeYear\">\r\n            <a-select-option v-for=\"(item,index) in yearData\" :key=\"index\" :value=\"item.id\">{{item.name}}\r\n            </a-select-option>\r\n          </a-select>\r\n        </p>\r\n      </div>\r\n\r\n      <div class=\"line3\">\r\n        <p>\r\n          <span>文件字号</span>\r\n          <a-input v-model=\"docwordNum\" style=\"width:150px;\" placeholder=\"文件号\" disabled></a-input>\r\n        </p>\r\n\r\n      </div>\r\n\r\n      <template>\r\n        <a-table\r\n          :columns=\"columns\"\r\n          rowKey=\"iid\"\r\n          :dataSource=\"numLists\"\r\n          :loading=\"loading\"\r\n          @change=\"changePagenation\"\r\n          v-show=\"isshowTable\">\r\n          <!--:record=\"record.ibusdataId\"-->\r\n          <template slot=\"action\" slot-scope=\"text, record\">\r\n            <div v-if=\"record.ibusdataId==='是'? false:true\" class=\"editable-row-operations\">\r\n              <a @click=\"()=>use(record)\">选择使用</a>&nbsp\r\n              <a @click=\"()=>set(record)\">设置线下占用</a>\r\n            </div>\r\n            <div v-else class=\"editable-row-operations\" style=\"color: #999999;\">\r\n              <span>选择使用</span>&nbsp\r\n              <span>设置线下占用</span>\r\n            </div>\r\n          </template>\r\n        </a-table>\r\n      </template>\r\n\r\n\r\n      <!--设置线下占用modal-->\r\n      <a-modal\r\n        title=\"温馨提示\"\r\n        :visible=\"visible1\"\r\n        @ok=\"openok\"\r\n        @cancel=\"cancelModal\"\r\n      >\r\n        <p>确定要设置线下占用吗？</p>\r\n      </a-modal>\r\n\r\n    </div>\r\n\r\n\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import {httpAction} from '@/api/manage'\r\n  import Vue from 'vue'\r\n  import {ACCESS_TOKEN} from \"../../store/mutation-types\";\r\n  import pick from 'lodash.pick'\r\n  import {getAction} from '@/api/manage'\r\n\r\n  const columns = [\r\n    {\r\n      title: '空号',\r\n      dataIndex: 'idocNum',\r\n      width: '20%'\r\n    },\r\n    {\r\n      title: '是否线下占用',\r\n      dataIndex: 'ibusdataId',\r\n      width: '20%'\r\n    },\r\n\r\n    {\r\n      title: '操作',\r\n      dataIndex: 'work',\r\n      width: '20%',\r\n      scopedSlots: {customRender: 'action'},\r\n    },]\r\n\r\n  const data = []\r\n  export default {\r\n    name: \"DengjiwenhaoModal\",\r\n    data() {\r\n      return {\r\n        title: \"登记文号\",\r\n        visible: false,\r\n        visible1: false,  //线下占用modal\r\n        docnumData: {\r\n          id: '',\r\n          docnum: ''\r\n        },\r\n        setid: '',\r\n        loading: true,\r\n        defaultYear: new Date().getFullYear(),\r\n        model: {},\r\n        listName: '展开空号列表',\r\n        headers: {'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)},\r\n        columns,\r\n        numId: '',\r\n        numLists: [],\r\n        modelData: '',\r\n        docnum: '',\r\n        docwordNum: '',\r\n        isshowTable: false,\r\n        yearData: [\r\n          {id: new Date().getFullYear(), name: new Date().getFullYear()},\r\n          {id: new Date().getFullYear() - 1, name: new Date().getFullYear() - 1}\r\n        ],\r\n        selectData: [],\r\n        secoendData: '',//发送对象值\r\n        selectedModel: '',\r\n        wenhao: '',\r\n        sendObj: '',\r\n        table: '',\r\n        functionId: '',\r\n        busdataId: '',\r\n        pagination: {\r\n          current: '',\r\n          total: '',\r\n        },\r\n        columns,\r\n        data,\r\n        labelCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 5},\r\n        },\r\n        wrapperCol: {\r\n          xs: {span: 24},\r\n          sm: {span: 16},\r\n        },\r\n        confirmLoading: false,\r\n        form: this.$form.createForm(this),\r\n        validatorRules: {\r\n          // iId:{rules: [{ required: true, message: '请输入主键id!' }]},\r\n        },\r\n        url: {\r\n          namelist: \"/papertitle/docNumSet/getDocNumList\",\r\n          numlist: \"/docnum/docNumManage/getNumList\",\r\n          setNum: \"/docnum/docNumManage/setNum\",\r\n          selectNum: \"/docnum/docNumManage/selectNum\",\r\n          sendobj: \"/papertitle/docNumSet/queryById\",\r\n\r\n        },\r\n      }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n      //展开空号列表\r\n      showTable() {\r\n        console.log(Boolean(this.selectedModel));\r\n        if (Boolean(this.selectedModel)) {\r\n          // console.log(this.isshowTable);\r\n          getAction(this.url.numlist, {iDocnumId: this.numId, sYear: this.defaultYear}).then((res) => {\r\n            // console.log(res.result);\r\n            //分页\r\n            this.pagination.total = res.result.total;\r\n            let resNumLists = res.result.records;\r\n            resNumLists.map((item) => {\r\n              if (!Boolean(item.ibusdataId)) {\r\n                item.ibusdataId = '否'\r\n              } else {\r\n                item.ibusdataId = '是'\r\n              }\r\n            });\r\n            this.numLists = resNumLists;\r\n            this.loading = false;\r\n\r\n          });\r\n\r\n          if (this.isshowTable) {\r\n            this.isshowTable = false;\r\n            this.listName = '展开空号列表';\r\n          } else {\r\n            this.listName = '收起空号列表';\r\n            this.isshowTable = true;\r\n          }\r\n        } else {\r\n\r\n          this.$notification['warning']({\r\n            message: '温馨提示',\r\n            description: '先选择文件字'\r\n          })\r\n        }\r\n\r\n      },\r\n      //分页事件\r\n      changePagenation(pagination) {\r\n        // console.log(pagination);\r\n        const pager = {...this.pagination};\r\n        pager.current = pagination.current;\r\n        this.pagination = pager;\r\n        console.log(pager);\r\n\r\n        getAction(this.url.numlist, {\r\n          iDocnumId: this.numId,\r\n          sYear: this.defaultYear,\r\n          pageNo: this.pagination.current\r\n        }).then((res) => {\r\n          console.log(res.result);\r\n          //分页\r\n          this.pagination.total = res.result.total;\r\n          let resNumLists = res.result.records;\r\n          resNumLists.map((item) => {\r\n            if (!Boolean(item.ibusdataId)) {\r\n              item.ibusdataId = '否'\r\n            } else {\r\n              item.ibusdataId = '是'\r\n            }\r\n          });\r\n          this.numLists = resNumLists;\r\n        })\r\n\r\n      },\r\n      getNowNum(event){\r\n        this.docnum = event.srcElement.value;\r\n        this.docwordNum = this.selectedModel.label.trim() + '〔' + this.defaultYear + '〕' + this.docnum + '号';\r\n      },\r\n      dengji(record) {\r\n        this.busdataId = record.i_id;\r\n        this.functionId = record.i_bus_function_id;\r\n        this.table = record.table;\r\n        this.visible = true;\r\n        this.getDocNumList();\r\n      },\r\n      close() {\r\n        this.$emit('close');\r\n        this.selectData = \"\",\r\n        this.secoendData = \"\",\r\n        this.selectedModel = \"\",\r\n        this.wenhao = \"\",\r\n        this.sendObj = \"\",\r\n        this.table = \"\",\r\n        this.functionId = \"\",\r\n        this.busdataId = \"\",\r\n        this.docnum = '',\r\n        // this.docwordNum = '',\r\n        this.visible = false;\r\n      },\r\n      handleOk() {\r\n        let iSend = '';\r\n        if (this.selectedModel) {\r\n          if (this.secoendData === \"上报\") {\r\n            iSend = 1;\r\n          } else {\r\n            iSend = 2;\r\n          }\r\n          getAction(this.url.setNum, {\r\n            iDocnumId: this.numId,\r\n            sYear: this.defaultYear,\r\n            iDocNum: this.docnum,\r\n            sBusdataTable: this.table,\r\n            iBusdataId: this.busdataId,\r\n            iSendObj: iSend\r\n          }).then((res) => {\r\n            this.docnumData.id = res.result.iid;\r\n            this.docnumData.docnum = this.docwordNum;\r\n            // alert(JSON.stringify(this.docnumData))\r\n            this.$emit('saveDocNum', this.docnumData)\r\n          })\r\n          this.close()\r\n        } else {\r\n          this.$notification['warning']({\r\n            message: '温馨提示',\r\n            description: '先选择文件字'\r\n          })\r\n        }\r\n\r\n      },\r\n      handleDenji() {\r\n        this.close()\r\n      },\r\n      use(e) {\r\n        console.log(e);\r\n\r\n        getAction(this.url.selectNum, {iId: e.iid, iBusdataId: this.busdataId}).then((res) => {\r\n          let idocNum = e.idocNum;\r\n          this.docnum = idocNum;\r\n          this.docwordNum = this.wenhao.trim() + '〔' + this.defaultYear + '〕' + this.docnum + '号';\r\n          getAction(this.url.numlist, {iDocnumId: this.numId, sYear: this.defaultYear}).then((res) => {\r\n            console.log(res.result);\r\n            //分页\r\n            this.pagination.total = res.result.total;\r\n            let resNumLists = res.result.records;\r\n            resNumLists.map((item) => {\r\n              if (!Boolean(item.ibusdataId)) {\r\n                item.ibusdataId = '否'\r\n              } else {\r\n                item.ibusdataId = '是'\r\n              }\r\n            });\r\n            this.numLists = resNumLists;\r\n          })\r\n        })\r\n      },\r\n      set(e) {\r\n        console.log(e);\r\n        this.visible1 = true;\r\n        this.setid = e.iid;\r\n\r\n      },\r\n      //设置线下占用确定按钮\r\n      openok() {\r\n        getAction(this.url.selectNum, {\r\n            iId: this.setid,\r\n            iBusdataId: -1\r\n          }\r\n        ).then((res) => {\r\n          getAction(this.url.numlist, {\r\n            iDocnumId: this.numId,\r\n            sYear: this.defaultYear,\r\n            pageNo: this.pagination.current\r\n          }).then((res) => {\r\n            console.log(res.result);\r\n            //分页\r\n            this.pagination.total = res.result.total;\r\n            let resNumLists = res.result.records;\r\n            resNumLists.map((item) => {\r\n              if (!Boolean(item.ibusdataId)) {\r\n                item.ibusdataId = '否'\r\n              } else {\r\n                item.ibusdataId = '是'\r\n              }\r\n            });\r\n            this.numLists = resNumLists;\r\n          });\r\n        })\r\n        this.visible1 = false;\r\n      },\r\n      cancelModal() {\r\n        this.visible1 = false;\r\n      },\r\n      //查询文件字列表\r\n      getDocNumList() {\r\n        //let that = this;\r\n        let url = this.url.namelist;\r\n        getAction(url, {iBusFunctionId: this.functionId}).then((res) => {\r\n          this.modelData = res.result;\r\n\r\n        })\r\n      },\r\n      getModalVal(val) {\r\n        this.numId = val.key;\r\n        this.wenhao = val.label;\r\n        setTimeout(() => {\r\n          console.log('-------', this.docnum)\r\n          this.docwordNum = val.label.trim() + '〔' + this.defaultYear + '〕' + that.docnum + '号';\r\n        }, 200)\r\n        let that = this;\r\n        let url = that.url.sendobj;\r\n        getAction(url, {id: val.key}).then((res) => {\r\n          that.docnum = res.result.idocNum+1;\r\n          let iud = res.result.iutemplateId;\r\n          let idd = res.result.idtemplateId;\r\n          let arr = [];\r\n          if (iud) {\r\n            arr.push({id: '1', name: '上报'})\r\n          } else {\r\n            arr.splice(0, 1);\r\n\r\n          }\r\n          if (idd) {\r\n            arr.push({id: '2', name: '下发'})\r\n          } else {\r\n            arr.splice(1, 2);\r\n\r\n          }\r\n          this.selectData = arr;\r\n          console.log(this.selectData);\r\n          this.secoendData = this.selectData[0].name;\r\n          this.docwordNum = val.label.trim() + '〔' + this.defaultYear + '〕' + that.docnum + '号';\r\n          // console.log(this.selectedModel)\r\n          // this.docwordNum = that.modelData[val.key].name+that.docnum\r\n        })\r\n      },\r\n\r\n      changeYear(e) {\r\n        console.log(e);\r\n        this.defaultYear = e;\r\n        this.docwordNum = this.wenhao + '〔' + e + '〕' + this.docnum + '号';\r\n\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .box {\r\n    width: 100%;\r\n    height: auto;\r\n\r\n    .line1 {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n\r\n      p {\r\n        span {\r\n          margin-right: 25px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .line2 {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n\r\n      p {\r\n        span {\r\n          margin-right: 25px;\r\n        }\r\n      }\r\n    }\r\n\r\n    .line3 {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n\r\n      p {\r\n        span {\r\n          margin-right: 10px;\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n</style>"]}]}