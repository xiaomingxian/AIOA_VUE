{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\workflow\\proManagerList.vue?vue&type=style&index=0&id=17397d24&scoped=true&lang=css&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\workflow\\proManagerList.vue","mtime":1572251285118},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\css-loader\\index.js","mtime":1570780111199},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1570779225817},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\postcss-loader\\src\\index.js","mtime":1570780438513},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import '~@assets/less/common.less'\n",{"version":3,"sources":["proManagerList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiVA","file":"proManagerList.vue","sourceRoot":"src/views/workflow","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\">\r\n\r\n    <!-- 查询区域 -->\r\n    <div class=\"table-page-search-wrapper\">\r\n      <a-form layout=\"inline\">\r\n        <a-row :gutter=\"24\">\r\n\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"流程名称\">\r\n              <a-input placeholder=\"请输入流程名称\" v-model=\"queryParam.name\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"流程定义key\">\r\n              <a-input placeholder=\"请输入流程定义key\" v-model=\"queryParam.key\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <span style=\"float: left;overflow: hidden;\" class=\"table-page-search-submitButtons\">\r\n              <a-button type=\"primary\" ref=\"reSearchQuery\" @click=\"searchQuery\" icon=\"search\">查询</a-button>\r\n              <a-button type=\"primary\" @click=\"searchReset\" icon=\"reload\" style=\"margin-left: 8px\">重置</a-button>\r\n            </span>\r\n          </a-col>\r\n\r\n        </a-row>\r\n      </a-form>\r\n    </div>\r\n\r\n    <!-- 操作按钮区域 -->\r\n    <div class=\"table-operator\" style=\"display: flex\">\r\n\r\n      <a-upload name=\"file\" :multiple=\"true\" :action=\"url.fileUpload\" :headers=\"headers\" :fileList=\"fileList\" @change=\"handleChange\" >\r\n        <a-button type=\"primary\" icon=\"plus\">\r\n          <a-icon typeof=\"upload\"/>\r\n          部署\r\n        </a-button>\r\n      </a-upload>\r\n\r\n      <a-dropdown v-if=\"selectedRowKeys.length > 0\">\r\n        <a-menu slot=\"overlay\">\r\n          <a-menu-item key=\"1\" @click=\"dels(0)\">\r\n            <a-icon type=\"delete\"/>\r\n            删除\r\n          </a-menu-item>\r\n          <a-menu-item key=\"1\" @click=\"dels(1)\">\r\n            <a-icon type=\"delete\"/>\r\n            级联删除\r\n          </a-menu-item>\r\n        </a-menu>\r\n        <a-button style=\"margin-left: 8px\"> 批量操作\r\n          <a-icon type=\"down\"/>\r\n        </a-button>\r\n      </a-dropdown>\r\n    </div>\r\n\r\n    <!-- table区域-begin -->\r\n    <div>\r\n      <div class=\"ant-alert ant-alert-info\" style=\"margin-bottom: 16px;\">\r\n        <i class=\"anticon anticon-info-circle ant-alert-icon\"></i> 已选择 <a style=\"font-weight: 600\">{{\r\n        selectedRowKeys.length }}</a>项\r\n        <a style=\"margin-left: 24px\" @click=\"onClearSelected\">清空</a>\r\n      </div>\r\n\r\n      <a-table\r\n        ref=\"table\"\r\n        size=\"middle\"\r\n        bordered\r\n        rowKey=\"deploymentId\"\r\n        :columns=\"columns\"\r\n        :dataSource=\"dataSource\"\r\n        :pagination=\"ipagination\"\r\n        :loading=\"loading\"\r\n        :rowSelection=\"{selectedRowKeys: selectedRowKeys, onChange: onSelectChange}\"\r\n        @change=\"handleTableChange\">\r\n\r\n        <span slot=\"action\" slot-scope=\"text, record\">\r\n          <a @click=\"editPro(record)\">编辑</a>\r\n\r\n\r\n          <a-divider type=\"vertical\"/>\r\n          <a-dropdown>\r\n            <a class=\"ant-dropdown-link\">更多 <a-icon type=\"down\"/></a>\r\n            <a-menu slot=\"overlay\">\r\n              <a-menu-item>\r\n                      <a>\r\n                        <a-popconfirm title=\"是否删除?\"\r\n                                      @confirm=\"confirmdel(record.deploymentId,0)\"\r\n                                      @cancel=\"cancel\"\r\n                                      okText=\"确认\"\r\n                                      cancelText=\"取消\"> 删除</a-popconfirm>\r\n                      </a>\r\n\r\n                      <a>\r\n                        <a-popconfirm title=\"是否级联删除?\"\r\n                                      @confirm=\"confirmdel(record.deploymentId,1)\"\r\n                                      @cancel=\"cancel\"\r\n                                      okText=\"确认\"\r\n                                      cancelText=\"取消\"> 级联删除</a-popconfirm>\r\n                      </a>\r\n                      <a @click=\"active(record)\"> 激活</a>\r\n                      <a @click=\"disactiveProcess(record)\"> 挂起</a>\r\n                      <a @click=\"showPic(record)\"> 查看流程图</a>\r\n              </a-menu-item>\r\n            </a-menu>\r\n          </a-dropdown>\r\n        </span>\r\n\r\n      </a-table>\r\n    </div>\r\n    <!-- table区域-end -->\r\n\r\n    <!-- 表单区域 -->\r\n    <pic-modal ref=\"picModal\" @ok=\"modalFormOk\"></pic-modal>\r\n    <edit-pro ref=\"editPro\" @reload=\"reload\"></edit-pro>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import editPro from './modules/editPro'\r\n  import axios from 'axios'\r\n  import Vue from 'vue'\r\n  import picModal from './modules/picModal'\r\n  import {JeecgListMixin} from '@/mixins/JeecgListMixin'\r\n  import {ACCESS_TOKEN} from \"../../store/mutation-types\";\r\n  import {getAction} from \"../../api/manage\";\r\n\r\n  export default {\r\n    name: \"proManagerList\",\r\n    mixins: [JeecgListMixin],\r\n    components: {\r\n      picModal, editPro\r\n    },\r\n    data() {\r\n      return {\r\n        fileList:'',\r\n        headers: {'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)},\r\n        description: 'proManager管理页面',\r\n        datasource: [],\r\n        // 表头\r\n        columns: [\r\n          {\r\n            title: '流程定义id',\r\n            align: \"center\",\r\n            dataIndex: 'id'\r\n          },\r\n          {\r\n            title: '名称',\r\n            align: \"center\",\r\n            dataIndex: 'name'\r\n          },\r\n          {\r\n            title: '关键字',\r\n            align: \"center\",\r\n            dataIndex: 'key'\r\n          },\r\n          {\r\n            title: '版本',\r\n            align: \"center\",\r\n            dataIndex: 'version'\r\n          },\r\n          {\r\n            title: '部署id',\r\n            align: \"center\",\r\n            dataIndex: 'deploymentId'\r\n          },\r\n          {\r\n            title: '资源名称',\r\n            align: \"center\",\r\n            dataIndex: 'resourceName'\r\n          },\r\n          {\r\n            title: '描述',\r\n            align: \"center\",\r\n            dataIndex: 'description'\r\n          },\r\n          {\r\n            title: '激活状态',\r\n            align: \"center\",\r\n            dataIndex: 'sus'\r\n          },\r\n          {\r\n            title: '操作',\r\n            dataIndex: 'action',\r\n            align: \"center\",\r\n            scopedSlots: {customRender: 'action'},\r\n          }\r\n        ],\r\n        url: {\r\n          fileUpload: window._CONFIG['domianURL'] + '/wf/process/deploy',\r\n          list: \"/wf/process/processQuery\",\r\n          delete: window._CONFIG['domianURL'] + \"/wf/process/processDel\",\r\n          active: window._CONFIG['domianURL'] + '/wf/process/activeProcess',\r\n          disactiveProcess: window._CONFIG['domianURL'] + \"/wf/process/disactiveProcess\",\r\n          deleteBatch: \"/wf/process/processDel\",\r\n        },\r\n      }\r\n    },\r\n    computed: {\r\n      importExcelUrl: function () {\r\n        return `${window._CONFIG['domianURL']}/${this.url.importExcelUrl}`;\r\n      }\r\n    },\r\n    methods: {\r\n      reload() {\r\n        this.fileList=[]\r\n        this.selectedRowKeys = []\r\n        this.loading = true;\r\n        getAction(this.url.list).then((res) => {\r\n          if (res.success) {\r\n            this.dataSource = res.result.records;\r\n            this.ipagination.total = res.result.total;\r\n          }\r\n          if (res.code === 510) {\r\n            this.$message.warning(res.message)\r\n          }\r\n          this.loading = false;\r\n        })\r\n\r\n      }\r\n      ,\r\n      handleChange(info) {\r\n        this.fileList=info.fileList\r\n\r\n\r\n        if (info.file.status == 'done') {\r\n\r\n          this.$message.success(`${info.file.name} 文件上传成功`)\r\n\r\n          this.reload()\r\n        } else if (info.file.status == 'error') {\r\n          this.$message.error(`${info.file.name} 文件上传失败`)\r\n          this.reload()\r\n        }\r\n\r\n\r\n        // this.fileList=[]\r\n\r\n      },\r\n      dels(cascade) {\r\n\r\n        var ids = \"\";\r\n        for (var a = 0; a < this.selectedRowKeys.length; a++) {\r\n          ids += this.selectedRowKeys[a] + \",\";\r\n        }\r\n        this.confirmdel(ids, cascade)\r\n\r\n        this.reload()\r\n\r\n      },\r\n      confirmdel(id, cascade) {\r\n        var flag = cascade == 0 ? false : true\r\n        var that = this\r\n        axios.delete(this.url.delete, {\r\n          params: {\r\n            ids: id, cascade: flag\r\n          },\r\n          headers: {\r\n            'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\r\n          }\r\n        }).then(function (response) {\r\n          if (response.data.success) {\r\n            that.$message.success(response.data.message)\r\n\r\n          } else {\r\n            that.$message.error(response.data.message)\r\n          }\r\n        })\r\n        this.reload()\r\n      },\r\n      cancel() {\r\n        console.log('------->取消选择')\r\n      },\r\n      active(record) {\r\n        var that = this\r\n        if (!record.suspended) {\r\n          this.$message.error('已是激活状态，请勿重复操作')\r\n          return\r\n        }\r\n\r\n        axios.get(this.url.active, {\r\n          params: {\r\n            id: record.id\r\n          },\r\n          headers: {\r\n            'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\r\n          }\r\n        }).then(function (response) {\r\n          if (response.data.success) {\r\n            that.$message.success('激活成功')\r\n          } else {\r\n            that.$message.error('激活失败')\r\n          }\r\n        });\r\n        this.reload()\r\n      },\r\n      disactiveProcess(record) {\r\n        var that = this\r\n        if (record.suspended) {\r\n          this.$message.error('已是挂起状态，请勿重复操作')\r\n          return\r\n        }\r\n\r\n        axios.get(this.url.disactiveProcess, {\r\n          params: {\r\n            id: record.id\r\n          },\r\n          headers: {\r\n            'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\r\n          }\r\n        }).then(function (response) {\r\n          if (response.data.success) {\r\n            that.$message.success('挂起成功')\r\n          } else {\r\n            that.$message.error('挂起失败')\r\n          }\r\n        });\r\n        this.reload()\r\n      },\r\n      showPic(record) {\r\n        this.$refs.picModal.show(record.id)\r\n        this.$refs.picModal.title = record.name\r\n      },\r\n      editPro(record) {\r\n        this.$refs.editPro.editPro(record.id, record.name)\r\n        this.$refs.editPro.title = '编辑'\r\n        this.reload()\r\n      }\r\n\r\n\r\n    },\r\n    create() {\r\n    },\r\n\r\n  }\r\n</script>\r\n<style scoped>\r\n  @import '~@assets/less/common.less'\r\n</style>"]}]}