{"remainingRequest":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\src\\views\\jeecg\\report\\ArchivesStatisticst.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\src\\views\\jeecg\\report\\ArchivesStatisticst.vue","mtime":1568535249000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568345883000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1568345858000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568345883000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1568345696000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Bar from '@/components/chart/Bar'\nimport Pie from '@/components/chart/Pie'\nimport ACol from 'ant-design-vue/es/grid/Col'\nimport { getAction } from '@/api/manage'\n\nexport default {\n  name: 'ArchivesStatisticst',\n  components: {\n    ACol,\n    Bar,\n    Pie\n  },\n  data() {\n    return {\n      description: '档案统计页面',\n      // 查询条件\n      queryParam: {},\n      // 数据集\n      countSource: [],\n      // 柱状图\n      barType: 'year',\n      barDate: ['month', 'month'],\n      barValue: [],\n      // 饼状图\n      pieType: 'year',\n      pieDate: ['month', 'month'],\n      pieValue: [],\n      // 统计图类型\n      tabStatus:\"bar\",\n      url: {\n        getYearCountInfo: \"/api/report/getYearCountInfo\",\n        getMonthCountInfo:\"/api/report/getMonthCountInfo\",\n        getCntrNoCountInfo:\"/api/report/getCntrNoCountInfo\",\n        getCabinetCountInfo:\"/api/report/getCabinetCountInfo\",\n      },\n    }\n  },\n  created() {\n    let url = this.url.getYearCountInfo;\n    this.loadDate(url,'year',{});\n  },\n  methods: {\n    loadDate(url,type,param) {\n      getAction(url,param,'get').then((res) => {\n        if (res.success) {\n          this.countSource = [];\n          if(type === 'year'){\n            this.getYearCountSource(res.result);\n          }\n          if(type === 'month'){\n            this.getMonthCountSource(res.result);\n          }\n          if(type === 'category'){\n            this.getCategoryCountSource(res.result);\n          }\n          if(type === 'cabinet'){\n            this.getCabinetCountSource(res.result);\n          }\n        }else{\n          var that=this;\n          that.$message.warning(res.message);\n        }\n      })\n    },\n    getYearCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus === \"bar\"){\n          this.countSource.push({\n            x: `${data[i].year}年`,\n            y: data[i].yearcount\n          })\n        }else{\n          this.countSource.push({\n            item: `${data[i].year}年`,\n            count:data[i].yearcount\n          })\n        }\n      }\n    },\n    getMonthCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus === \"bar\"){\n          this.countSource.push({\n            x: data[i].month,\n            y: data[i].monthcount\n          })\n        }else{\n          this.countSource.push({\n            item: data[i].month,\n            count:data[i].monthcount\n          })\n        }\n      }\n    },\n    getCategoryCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus ===\"bar\"){\n          this.countSource.push({\n            x: data[i].classifyname,\n            y: data[i].cntrnocount\n          })\n        }else{\n          this.countSource.push({\n            item: data[i].classifyname,\n            count:data[i].cntrnocount\n          })\n        }\n      }\n    },\n    getCabinetCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus === \"bar\"){\n          this.countSource.push({\n            x: data[i].cabinetname,\n            y: data[i].cabinetcocunt\n          })\n        }else{\n          this.countSource.push({\n            item: data[i].cabinetname,\n            count:data[i].cabinetcocunt\n          })\n        }\n      }\n    },\n    // 选择统计图类别\n    callback(key) {\n      if(key === \"1\"){\n        this.tabStatus = \"bar\";\n        this.queryDatebar();\n      }else{\n        this.tabStatus = \"pie\";\n        this.queryDatepie();\n      }\n    },\n    // 选择统计类别\n    statisticst(e) {\n      if(this.tabStatus === \"pie\"){\n        this.pieType = e.target.value;\n        this.queryDatepie();\n      }else{\n        this.barType = e.target.value;\n        this.queryDatebar();\n      }\n    },\n    // 按月份查询\n    queryDatebar(){\n      if(this.barValue.length>0){\n        this.getUrl(this.barType,{startTime:this.barValue[0]._d,endTime:this.barValue[1]._d});\n      }else{\n        this.getUrl(this.barType,{});\n      }\n    },\n    queryDatepie(){\n      if(this.pieValue.length>0){\n        this.getUrl(this.pieType,{startTime:this.pieValue[0]._d,endTime:this.pieValue[1]._d});\n      }else{\n        this.getUrl(this.pieType,{});\n      }\n    },\n    searchReset(){\n      console.log(this.tabStatus);\n      if(this.tabStatus === \"pie\"){\n        this.pieValue = [];\n      }else{\n        this.barValue = [];\n      }\n      this.getUrl(this.barType,{});\n    },\n    // 选择请求url\n    getUrl(type,param){\n      let url = \"\";\n      if(type === 'year'){\n        url = this.url.getYearCountInfo;\n      }\n      if(type === 'month'){\n        url = this.url.getMonthCountInfo;\n      }\n      if(type === 'category'){\n        url = this.url.getCntrNoCountInfo;\n      }\n      if(type === 'cabinet'){\n        url = this.url.getCabinetCountInfo;\n      }\n      this.loadDate(url,type,param);\n    },\n    // 选择月份日期\n    handleBarDate(value, mode) {\n      this.barValue = value\n      this.barDate = [\n        mode[0] === 'date' ? 'month' : mode[0],\n        mode[1] === 'date' ? 'month' : mode[1]\n      ]\n    },\n    handlePieDate(value, mode) {\n      this.pieValue = value\n      this.pieDate = [\n        mode[0] === 'date' ? 'month' : mode[0],\n        mode[1] === 'date' ? 'month' : mode[1]\n      ]\n    },\n  }\n}\n",{"version":3,"sources":["ArchivesStatisticst.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArchivesStatisticst.vue","sourceRoot":"src/views/jeecg/report","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\">\r\n    <a-tabs defaultActiveKey=\"1\" @change=\"callback\">\r\n      <a-tab-pane tab=\"柱状图\" key=\"1\">\r\n        <a-row :gutter=\"24\">\r\n          <a-col :span=\"10\">\r\n            <a-radio-group :value=\"barType\" @change=\"statisticst\">\r\n              <a-radio-button value=\"year\">按年统计</a-radio-button>\r\n              <a-radio-button value=\"month\">按月统计</a-radio-button>\r\n              <a-radio-button value=\"category\">按类别统计</a-radio-button>\r\n              <a-radio-button value=\"cabinet\">按柜号统计</a-radio-button>\r\n            </a-radio-group>\r\n          </a-col>\r\n          <a-col :span=\"14\">\r\n            <a-form v-if=\"barType === 'month' && false\" layout=\"inline\" style=\"margin-top: -4px\">\r\n              <a-form-item label=\"月份区间\">\r\n                <a-range-picker\r\n                  :placeholder=\"['开始月份', '结束月份']\"\r\n                  format=\"YYYY-MM\"\r\n                  :value=\"barValue\"\r\n                  :mode=\"barDate\"\r\n                  @panelChange=\"handleBarDate\"/>\r\n              </a-form-item>\r\n              <a-button style=\"margin-top: 2px\" type=\"primary\" icon=\"search\" @click=\"queryDatebar\">查询</a-button>\r\n              <a-button style=\"margin-top: 2px;margin-left: 8px\" type=\"primary\" icon=\"reload\" @click=\"searchReset\">重置</a-button>\r\n            </a-form>\r\n          </a-col>\r\n          <bar class=\"statistic\" title=\"档案统计\" :dataSource=\"countSource\" :height=\"400\"/>\r\n        </a-row>\r\n      </a-tab-pane>\r\n\r\n      <a-tab-pane tab=\"饼状图\" key=\"2\">\r\n        <a-row :gutter=\"24\">\r\n          <a-col :span=\"10\">\r\n            <a-radio-group :value=\"pieType\" @change=\"statisticst\">\r\n              <a-radio-button value=\"year\">按年统计</a-radio-button>\r\n              <a-radio-button value=\"month\">按月统计</a-radio-button>\r\n              <a-radio-button value=\"category\">按类别统计</a-radio-button>\r\n              <a-radio-button value=\"cabinet\">按柜号统计</a-radio-button>\r\n            </a-radio-group>\r\n          </a-col>\r\n          <a-col :span=\"14\">\r\n            <a-form v-if=\"pieType === 'month' && false\" layout=\"inline\" style=\"margin-top: -4px\">\r\n              <a-row :gutter=\"24\">\r\n                <a-form-item label=\"月份区间\">\r\n                  <a-range-picker\r\n                    :placeholder=\"['开始月份', '结束月份']\"\r\n                    format=\"YYYY-MM\"\r\n                    :value=\"pieValue\"\r\n                    :mode=\"pieDate\"\r\n                    @panelChange=\"handlePieDate\"/>\r\n                </a-form-item>\r\n                <a-button style=\"margin-top: 2px\" type=\"primary\" icon=\"search\" @click=\"queryDatepie\">查询</a-button>\r\n                <a-button style=\"margin-top: 2px;margin-left: 8px\" type=\"primary\" icon=\"reload\" @click=\"searchReset\">重置</a-button>\r\n              </a-row>\r\n            </a-form>\r\n          </a-col>\r\n          <pie class=\"statistic\" title=\"档案统计\" :dataSource=\"countSource\" :height=\"450\"/>\r\n        </a-row>\r\n      </a-tab-pane>\r\n    </a-tabs>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import Bar from '@/components/chart/Bar'\r\n  import Pie from '@/components/chart/Pie'\r\n  import ACol from 'ant-design-vue/es/grid/Col'\r\n  import { getAction } from '@/api/manage'\r\n\r\n  export default {\r\n    name: 'ArchivesStatisticst',\r\n    components: {\r\n      ACol,\r\n      Bar,\r\n      Pie\r\n    },\r\n    data() {\r\n      return {\r\n        description: '档案统计页面',\r\n        // 查询条件\r\n        queryParam: {},\r\n        // 数据集\r\n        countSource: [],\r\n        // 柱状图\r\n        barType: 'year',\r\n        barDate: ['month', 'month'],\r\n        barValue: [],\r\n        // 饼状图\r\n        pieType: 'year',\r\n        pieDate: ['month', 'month'],\r\n        pieValue: [],\r\n        // 统计图类型\r\n        tabStatus:\"bar\",\r\n        url: {\r\n          getYearCountInfo: \"/api/report/getYearCountInfo\",\r\n          getMonthCountInfo:\"/api/report/getMonthCountInfo\",\r\n          getCntrNoCountInfo:\"/api/report/getCntrNoCountInfo\",\r\n          getCabinetCountInfo:\"/api/report/getCabinetCountInfo\",\r\n        },\r\n      }\r\n    },\r\n    created() {\r\n      let url = this.url.getYearCountInfo;\r\n      this.loadDate(url,'year',{});\r\n    },\r\n    methods: {\r\n      loadDate(url,type,param) {\r\n        getAction(url,param,'get').then((res) => {\r\n          if (res.success) {\r\n            this.countSource = [];\r\n            if(type === 'year'){\r\n              this.getYearCountSource(res.result);\r\n            }\r\n            if(type === 'month'){\r\n              this.getMonthCountSource(res.result);\r\n            }\r\n            if(type === 'category'){\r\n              this.getCategoryCountSource(res.result);\r\n            }\r\n            if(type === 'cabinet'){\r\n              this.getCabinetCountSource(res.result);\r\n            }\r\n          }else{\r\n            var that=this;\r\n            that.$message.warning(res.message);\r\n          }\r\n        })\r\n      },\r\n      getYearCountSource(data){\r\n        for (let i = 0; i < data.length; i++) {\r\n          if(this.tabStatus === \"bar\"){\r\n            this.countSource.push({\r\n              x: `${data[i].year}年`,\r\n              y: data[i].yearcount\r\n            })\r\n          }else{\r\n            this.countSource.push({\r\n              item: `${data[i].year}年`,\r\n              count:data[i].yearcount\r\n            })\r\n          }\r\n        }\r\n      },\r\n      getMonthCountSource(data){\r\n        for (let i = 0; i < data.length; i++) {\r\n          if(this.tabStatus === \"bar\"){\r\n            this.countSource.push({\r\n              x: data[i].month,\r\n              y: data[i].monthcount\r\n            })\r\n          }else{\r\n            this.countSource.push({\r\n              item: data[i].month,\r\n              count:data[i].monthcount\r\n            })\r\n          }\r\n        }\r\n      },\r\n      getCategoryCountSource(data){\r\n        for (let i = 0; i < data.length; i++) {\r\n          if(this.tabStatus ===\"bar\"){\r\n            this.countSource.push({\r\n              x: data[i].classifyname,\r\n              y: data[i].cntrnocount\r\n            })\r\n          }else{\r\n            this.countSource.push({\r\n              item: data[i].classifyname,\r\n              count:data[i].cntrnocount\r\n            })\r\n          }\r\n        }\r\n      },\r\n      getCabinetCountSource(data){\r\n        for (let i = 0; i < data.length; i++) {\r\n          if(this.tabStatus === \"bar\"){\r\n            this.countSource.push({\r\n              x: data[i].cabinetname,\r\n              y: data[i].cabinetcocunt\r\n            })\r\n          }else{\r\n            this.countSource.push({\r\n              item: data[i].cabinetname,\r\n              count:data[i].cabinetcocunt\r\n            })\r\n          }\r\n        }\r\n      },\r\n      // 选择统计图类别\r\n      callback(key) {\r\n        if(key === \"1\"){\r\n          this.tabStatus = \"bar\";\r\n          this.queryDatebar();\r\n        }else{\r\n          this.tabStatus = \"pie\";\r\n          this.queryDatepie();\r\n        }\r\n      },\r\n      // 选择统计类别\r\n      statisticst(e) {\r\n        if(this.tabStatus === \"pie\"){\r\n          this.pieType = e.target.value;\r\n          this.queryDatepie();\r\n        }else{\r\n          this.barType = e.target.value;\r\n          this.queryDatebar();\r\n        }\r\n      },\r\n      // 按月份查询\r\n      queryDatebar(){\r\n        if(this.barValue.length>0){\r\n          this.getUrl(this.barType,{startTime:this.barValue[0]._d,endTime:this.barValue[1]._d});\r\n        }else{\r\n          this.getUrl(this.barType,{});\r\n        }\r\n      },\r\n      queryDatepie(){\r\n        if(this.pieValue.length>0){\r\n          this.getUrl(this.pieType,{startTime:this.pieValue[0]._d,endTime:this.pieValue[1]._d});\r\n        }else{\r\n          this.getUrl(this.pieType,{});\r\n        }\r\n      },\r\n      searchReset(){\r\n        console.log(this.tabStatus);\r\n        if(this.tabStatus === \"pie\"){\r\n          this.pieValue = [];\r\n        }else{\r\n          this.barValue = [];\r\n        }\r\n        this.getUrl(this.barType,{});\r\n      },\r\n      // 选择请求url\r\n      getUrl(type,param){\r\n        let url = \"\";\r\n        if(type === 'year'){\r\n          url = this.url.getYearCountInfo;\r\n        }\r\n        if(type === 'month'){\r\n          url = this.url.getMonthCountInfo;\r\n        }\r\n        if(type === 'category'){\r\n          url = this.url.getCntrNoCountInfo;\r\n        }\r\n        if(type === 'cabinet'){\r\n          url = this.url.getCabinetCountInfo;\r\n        }\r\n        this.loadDate(url,type,param);\r\n      },\r\n      // 选择月份日期\r\n      handleBarDate(value, mode) {\r\n        this.barValue = value\r\n        this.barDate = [\r\n          mode[0] === 'date' ? 'month' : mode[0],\r\n          mode[1] === 'date' ? 'month' : mode[1]\r\n        ]\r\n      },\r\n      handlePieDate(value, mode) {\r\n        this.pieValue = value\r\n        this.pieDate = [\r\n          mode[0] === 'date' ? 'month' : mode[0],\r\n          mode[1] === 'date' ? 'month' : mode[1]\r\n        ]\r\n      },\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n  .ant-card-body .table-operator {\r\n    margin-bottom: 18px;\r\n  }\r\n\r\n  .ant-table-tbody .ant-table-row td {\r\n    padding-top: 15px;\r\n    padding-bottom: 15px;\r\n  }\r\n\r\n  .anty-row-operator button {\r\n    margin: 0 5px\r\n  }\r\n\r\n  .ant-btn-danger {\r\n    background-color: #ffffff\r\n  }\r\n\r\n  .ant-modal-cust-warp {\r\n    height: 100%\r\n  }\r\n\r\n  .ant-modal-cust-warp .ant-modal-body {\r\n    height: calc(100% - 110px) !important;\r\n    overflow-y: auto\r\n  }\r\n\r\n  .ant-modal-cust-warp .ant-modal-content {\r\n    height: 90% !important;\r\n    overflow-y: hidden\r\n  }\r\n\r\n  .statistic {\r\n    padding: 0px !important;\r\n    margin-top: 50px;\r\n  }\r\n\r\n  .statistic h4 {\r\n    margin-bottom: 20px;\r\n    text-align: center !important;\r\n    font-size: 24px !important;;\r\n  }\r\n\r\n  .statistic #canvas_1 {\r\n    width: 100% !important;\r\n  }\r\n</style>"]}]}