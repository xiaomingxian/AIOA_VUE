{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\oaBus\\TestStandardList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\oaBus\\TestStandardList.vue","mtime":1579513669248},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\babel-loader\\lib\\index.js","mtime":1570779245522},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport HeadInfo from '@/components/tools/HeadInfo'\nimport { getAction, postAction } from '@/api/manage'\n// import jsonp from 'fetch-jsonp';\nimport querystring from 'querystring';\nimport debounce from 'lodash/debounce';\n\nexport default {\n  name: \"TestStandardList\",\n  components: {\n    HeadInfo\n  },\n  data() {\n    this.lastFetchId = 0;\n    this.fetchUser = debounce(this.fetchUser, 800);\n    return {\n      defaultActivityKey:'0',//默认为第一个tab\n      data: [],\n      fetching: false,\n      getPageList: [\n        {\n          sname:'全文检索'\n        },\n        {\n          sname:'附件检索'\n        }\n      ],\n      search: '',\n      textData:[],\n      attachmentData:[],\n      dataSource: [],\n      pagination: {\n        current: 1,\n        pageSize: 10,\n        // pageSizeOptions: ['5', '10', '15', '20', '25', '30'],\n        showTotal: (total, range) => {\n          return \"共\" + total + \"条\"\n        },\n        // showQuickJumper: true,\n        // showSizeChanger: true,\n        total: 0,\n        onChange:pageindex=>{\n          console.log(pageindex);\n          this.current = pageindex;\n          console.log(this.defaultActivityKey);\n          //检测测试为全文检索  还是附件检索\n          if(this.defaultActivityKey=='0'){\n            //全文检索\n            this.FilterAllFiles(this.search,pageindex);\n          }else{\n            //附件检索\n            this.FuJianFiles(this.search,pageindex);\n          }\n\n        }\n      },\n    }\n  },\n  created() {\n\n  },\n  destroyed(){\n    this.dataDestroy();\n  },\n  methods: {\n    //---切换页签-----\n    changeTabs(e){\n      console.log(e);\n      //切换Tabs时  清空dataSourse\n      this.dataSource = [];\n      this.defaultActivityKey = e.toString()\n      //点击查询按钮检测  检测是否填写\n      if(this.search){\n        //若用户已填写 判断此时Tab 是全文检索0   附件检索1\n        if(e=='0'){\n          //全文检索\n          this.FilterAllFiles(this.search);\n        }else{\n          //附件检索\n          this.FuJianFiles(this.search);\n        }\n\n      }else{\n        this.$message.error('请输入搜索内容')\n      }\n\n    },\n    //---切换分页-----\n    changePage(e){\n      console.log(e);\n    },\n    fetchUser(value) {\n      // console.log('fetching user', value);\n      this.lastFetchId += 1;\n      const fetchId = this.lastFetchId;\n      this.data = [];\n      this.fetching = true;\n      let url = \"/oaEs/oaelasticsearch/getsearch\";\n      postAction(url, {keyWord: value}).then((res) => {\n          if (fetchId !== this.lastFetchId) {\n            // for fetch callback order\n            return;\n          }\n\n        for(let i = 0;i<res.result.length;i++){\n          this.data.push({\n            text: res.result[i].keyWord,\n            value: res.result[i].id\n          });\n        }\n          this.fetching = false;\n        });\n    },\n    handleChange(obj) {\n\n      //判断  全文检索搜索框是否输入    检测输入变化则赋值  否则清空变量\n      if(obj){\n        console.log(obj);\n        this.search = obj.key;\n      }else{\n        this.search = '';\n      }\n      // Object.assign(this, {\n      //   value,\n      //   data: [],\n      //   fetching: false,\n      // });\n    },\n    getTextSearch(defaultActivityKey) {\n\n      console.log(this.search);\n      console.log(defaultActivityKey);\n\n      //点击查询按钮检测  检测是否填写\n      if(this.search){\n        //若用户已填写 判断此时Tab 是全文检索0   附件检索1\n        if(defaultActivityKey=='0'){\n          //全文检索\n          this.FilterAllFiles(this.search);\n        }else{\n          //附件检索\n          this.FuJianFiles(this.search);\n        }\n\n      }else{\n        this.$message.error('请输入搜索内容')\n      }\n\n    },\n    //--------全文检索------------\n    FilterAllFiles(serchval,pageindex='1'){\n      let url = \"/oaEs/oaelasticsearch/list\";\n      postAction(url, {keyWord:serchval,pageNo:pageindex}).then((res) => {\n        console.log(res);\n        if(res.success){\n          this.pagination.total =  res.result.total;\n          this.dataSource = res.result.records;\n        }else{\n          this.$message.error('查询失败')\n        }\n\n        // for (let i = 0; i < res.result.records.length; i++) {\n        //   this.textData.push({\n        //     title: res.result.records[i].s_cur_proc_name,\n        //     description: res.result.records[i].s_title,\n        //   });\n        // }\n      });\n    },\n    //--------附件检索-------------\n    FuJianFiles(serchval,pageindex='1') {\n      let url = \"/oaEs/oaelasticsearch/oafile\";\n      postAction(url, {keyWord:serchval,pageNo:pageindex}).then((res) => {\n        if(res.success){\n          this.pagination.total =  res.result.total;\n          this.dataSource = res.result.records;\n        }else{\n          this.$message.error('查询失败')\n        }\n        // for (let i = 0; i < res.result.records.length; i++) {\n        //   this.attachmentData.push({\n        //     title: res.result.records[i].s_file_name,\n        //     description: res.result.records[i].s_title,\n        //   });\n        // }\n      });\n    },\n    getPgSearchList(iBMId) {\n\n      console.log(iBMId);\n\n      // for(let i=0;i<this.dataSource.length;i++){\n      //   this.dataSource[i].length=0;\n      // }\n\n      this.getTextSearch(this.defaultActivityKey);\n\n      // this.getAttachmentSearch(iBMId);\n      //\n      // this.dataSource.push(this.textData,this.attachmentData);\n\n    },\n    dataDestroy(){\n      this.pagination = [];\n      this.textData = [],\n      this.attachmentData = [],\n      this.dataSource = [];\n    }\n  }\n}\n",{"version":3,"sources":["TestStandardList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TestStandardList.vue","sourceRoot":"src/views/oaBus","sourcesContent":["<style>\r\n\r\n  /*.ant-tabs-nav-scroll{*/\r\n    /*height:39px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar{*/\r\n    /*border:none;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-nav{*/\r\n    /*!*background-color: #ffadd2;*!*/\r\n    /*border:1px solid #909090;*/\r\n    /*border-radius: 25%;*/\r\n    /*height: 27px;*/\r\n    /*top: 5px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-tab{*/\r\n    /*font-size: 14px;*/\r\n    /*padding-top: 2px;*/\r\n    /*margin-right: 0px;*/\r\n    /*bottom: 1px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-tab:hover{*/\r\n    /*color: #0061cb;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-tab-active{*/\r\n    /*color: #fff;*/\r\n    /*background-color: #7d70ff;*/\r\n    /*border-radius: 27%;*/\r\n    /*height:27px;*/\r\n  /*}*/\r\n\r\n  /*.ant-card-body .ant-tabs-bar .ant-tabs-ink-bar-animated{*/\r\n    /*display: none !important;*/\r\n  /*}*/\r\n\r\n\r\n</style>\r\n\r\n<template>\r\n  <div class=\"table-page-search-wrapper\">\r\n    <a-card :bordered=false>\r\n      <a-form layout=\"inline\" style=\"text-align: center; margin-top: 20px\">\r\n        <a-row :gutter=\"24\">\r\n          <a-col :md=\"8\" :sm=\"24\" style=\"margin-left:385px;\">\r\n              <a-select\r\n                mode=\"combobox\"\r\n                labelInValue\r\n                placeholder=\"公文检索\"\r\n                style=\"width: 100%\"\r\n                @search=\"fetchUser\"\r\n                @change=\"handleChange\"\r\n                :showArrow=\"false\"\r\n                :allowClear=\"true\"\r\n                :defaultActiveFirstOption=\"false\"\r\n                :notFoundContent=\"fetching ? undefined : null\"\r\n              >\r\n                <a-spin v-if=\"fetching\" slot=\"notFoundContent\" size=\"small\" />\r\n                <a-select-option v-for=\"d in data\" :key=\"d.text\">{{d.text}}</a-select-option>\r\n            </a-select>\r\n          </a-col>\r\n\r\n          <a-col :md=\"1\" :sm=\"24\" >\r\n            <span class=\"table-page-search-submitButtons\">\r\n              <a-button type=\"primary\" icon=\"search\" @click=\"getPgSearchList\">查询</a-button>\r\n            </span>\r\n          </a-col>\r\n        </a-row>\r\n        <!--<a-row :gutter=\"48\">-->\r\n        <!--<a-col :md=\"24\" :sm=\"24\" >-->\r\n        <!--<span class=\"table-page-search-submitButtons\" :style=\"advanced && { overflow: 'hidden' } || {} \">-->\r\n        <!--<a-button type=\"primary\" @click=\"getPgSearchList\">查询</a-button>-->\r\n        <!--</span>-->\r\n        <!--</a-col>-->\r\n        <!--</a-row>-->\r\n      </a-form>\r\n\r\n\r\n\r\n      <a-tabs\r\n        :default-active-key=\"0\"\r\n        @change=\"changeTabs\"\r\n      >\r\n        <a-tab-pane :tab=\"titleItem.sname\" v-for=\"(titleItem,titleIndex) in getPageList\" :key=\"titleIndex\">\r\n          <a-list size=\"large\" :pagination=\"pagination\" >\r\n            <a-list-item :key=\"index\" v-for=\"(item, index) in dataSource\">\r\n\r\n             <span v-if=\"defaultActivityKey=='0'\" v-html=\"item.s_title\"></span>\r\n             <span v-else v-html=\"item.sFileName\"></span>\r\n              <!--<a-list-item-meta>-->\r\n                <!--<a slot=\"title\" v-html=\"item.title\"></a>-->\r\n                <!--<p slot=\"description\" v-html=\"item.description\"></p>-->\r\n              <!--</a-list-item-meta>-->\r\n            </a-list-item>\r\n          </a-list>\r\n        </a-tab-pane>\r\n      </a-tabs>\r\n\r\n\r\n    </a-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import HeadInfo from '@/components/tools/HeadInfo'\r\n  import { getAction, postAction } from '@/api/manage'\r\n  // import jsonp from 'fetch-jsonp';\r\n  import querystring from 'querystring';\r\n  import debounce from 'lodash/debounce';\r\n\r\n  export default {\r\n    name: \"TestStandardList\",\r\n    components: {\r\n      HeadInfo\r\n    },\r\n    data() {\r\n      this.lastFetchId = 0;\r\n      this.fetchUser = debounce(this.fetchUser, 800);\r\n      return {\r\n        defaultActivityKey:'0',//默认为第一个tab\r\n        data: [],\r\n        fetching: false,\r\n        getPageList: [\r\n          {\r\n            sname:'全文检索'\r\n          },\r\n          {\r\n            sname:'附件检索'\r\n          }\r\n        ],\r\n        search: '',\r\n        textData:[],\r\n        attachmentData:[],\r\n        dataSource: [],\r\n        pagination: {\r\n          current: 1,\r\n          pageSize: 10,\r\n          // pageSizeOptions: ['5', '10', '15', '20', '25', '30'],\r\n          showTotal: (total, range) => {\r\n            return \"共\" + total + \"条\"\r\n          },\r\n          // showQuickJumper: true,\r\n          // showSizeChanger: true,\r\n          total: 0,\r\n          onChange:pageindex=>{\r\n            console.log(pageindex);\r\n            this.current = pageindex;\r\n            console.log(this.defaultActivityKey);\r\n            //检测测试为全文检索  还是附件检索\r\n            if(this.defaultActivityKey=='0'){\r\n              //全文检索\r\n              this.FilterAllFiles(this.search,pageindex);\r\n            }else{\r\n              //附件检索\r\n              this.FuJianFiles(this.search,pageindex);\r\n            }\r\n\r\n          }\r\n        },\r\n      }\r\n    },\r\n    created() {\r\n\r\n    },\r\n    destroyed(){\r\n      this.dataDestroy();\r\n    },\r\n    methods: {\r\n      //---切换页签-----\r\n      changeTabs(e){\r\n        console.log(e);\r\n        //切换Tabs时  清空dataSourse\r\n        this.dataSource = [];\r\n        this.defaultActivityKey = e.toString()\r\n        //点击查询按钮检测  检测是否填写\r\n        if(this.search){\r\n          //若用户已填写 判断此时Tab 是全文检索0   附件检索1\r\n          if(e=='0'){\r\n            //全文检索\r\n            this.FilterAllFiles(this.search);\r\n          }else{\r\n            //附件检索\r\n            this.FuJianFiles(this.search);\r\n          }\r\n\r\n        }else{\r\n          this.$message.error('请输入搜索内容')\r\n        }\r\n\r\n      },\r\n      //---切换分页-----\r\n      changePage(e){\r\n        console.log(e);\r\n      },\r\n      fetchUser(value) {\r\n        // console.log('fetching user', value);\r\n        this.lastFetchId += 1;\r\n        const fetchId = this.lastFetchId;\r\n        this.data = [];\r\n        this.fetching = true;\r\n        let url = \"/oaEs/oaelasticsearch/getsearch\";\r\n        postAction(url, {keyWord: value}).then((res) => {\r\n            if (fetchId !== this.lastFetchId) {\r\n              // for fetch callback order\r\n              return;\r\n            }\r\n\r\n          for(let i = 0;i<res.result.length;i++){\r\n            this.data.push({\r\n              text: res.result[i].keyWord,\r\n              value: res.result[i].id\r\n            });\r\n          }\r\n            this.fetching = false;\r\n          });\r\n      },\r\n      handleChange(obj) {\r\n\r\n        //判断  全文检索搜索框是否输入    检测输入变化则赋值  否则清空变量\r\n        if(obj){\r\n          console.log(obj);\r\n          this.search = obj.key;\r\n        }else{\r\n          this.search = '';\r\n        }\r\n        // Object.assign(this, {\r\n        //   value,\r\n        //   data: [],\r\n        //   fetching: false,\r\n        // });\r\n      },\r\n      getTextSearch(defaultActivityKey) {\r\n\r\n        console.log(this.search);\r\n        console.log(defaultActivityKey);\r\n\r\n        //点击查询按钮检测  检测是否填写\r\n        if(this.search){\r\n          //若用户已填写 判断此时Tab 是全文检索0   附件检索1\r\n          if(defaultActivityKey=='0'){\r\n            //全文检索\r\n            this.FilterAllFiles(this.search);\r\n          }else{\r\n            //附件检索\r\n            this.FuJianFiles(this.search);\r\n          }\r\n\r\n        }else{\r\n          this.$message.error('请输入搜索内容')\r\n        }\r\n\r\n      },\r\n      //--------全文检索------------\r\n      FilterAllFiles(serchval,pageindex='1'){\r\n        let url = \"/oaEs/oaelasticsearch/list\";\r\n        postAction(url, {keyWord:serchval,pageNo:pageindex}).then((res) => {\r\n          console.log(res);\r\n          if(res.success){\r\n            this.pagination.total =  res.result.total;\r\n            this.dataSource = res.result.records;\r\n          }else{\r\n            this.$message.error('查询失败')\r\n          }\r\n\r\n          // for (let i = 0; i < res.result.records.length; i++) {\r\n          //   this.textData.push({\r\n          //     title: res.result.records[i].s_cur_proc_name,\r\n          //     description: res.result.records[i].s_title,\r\n          //   });\r\n          // }\r\n        });\r\n      },\r\n      //--------附件检索-------------\r\n      FuJianFiles(serchval,pageindex='1') {\r\n        let url = \"/oaEs/oaelasticsearch/oafile\";\r\n        postAction(url, {keyWord:serchval,pageNo:pageindex}).then((res) => {\r\n          if(res.success){\r\n            this.pagination.total =  res.result.total;\r\n            this.dataSource = res.result.records;\r\n          }else{\r\n            this.$message.error('查询失败')\r\n          }\r\n          // for (let i = 0; i < res.result.records.length; i++) {\r\n          //   this.attachmentData.push({\r\n          //     title: res.result.records[i].s_file_name,\r\n          //     description: res.result.records[i].s_title,\r\n          //   });\r\n          // }\r\n        });\r\n      },\r\n      getPgSearchList(iBMId) {\r\n\r\n        console.log(iBMId);\r\n\r\n        // for(let i=0;i<this.dataSource.length;i++){\r\n        //   this.dataSource[i].length=0;\r\n        // }\r\n\r\n        this.getTextSearch(this.defaultActivityKey);\r\n\r\n        // this.getAttachmentSearch(iBMId);\r\n        //\r\n        // this.dataSource.push(this.textData,this.attachmentData);\r\n\r\n      },\r\n      dataDestroy(){\r\n        this.pagination = [];\r\n        this.textData = [],\r\n        this.attachmentData = [],\r\n        this.dataSource = [];\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .table-page-search-submitButtons .ant-btn{\r\n    background:linear-gradient(180deg,rgba(115,128,255,1),rgba(47,86,255,1)) repeat scroll 0% 0%;\r\n  }\r\n\r\n  .table-page-search-submitButtons .ant-btn svg{\r\n    fill:cyan;\r\n  }\r\n\r\n  /deep/.ant-card-body{\r\n    min-height: 650px !important;\r\n  }\r\n  /deep/.ant-spin-container{\r\n    min-height: 400px !important;\r\n  }\r\n\r\n\r\n  .ant-avatar-lg {\r\n    width: 48px;\r\n    height: 48px;\r\n    line-height: 48px;\r\n  }\r\n\r\n  .list-content-item {\r\n    color: rgba(0, 0, 0, .45);\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    font-size: 14px;\r\n    margin-left: 40px;\r\n    span {\r\n      line-height: 20px;\r\n    }\r\n    p {\r\n      margin-top: 4px;\r\n      margin-bottom: 0;\r\n      line-height: 22px;\r\n    }\r\n  }\r\n</style>"]}]}