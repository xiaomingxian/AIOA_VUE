{"remainingRequest":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xxm\\work\\jd\\fore\\src\\views\\data\\myData.vue?vue&type=style&index=0&id=5ab2785e&scoped=true&lang=less&","dependencies":[{"path":"C:\\xxm\\work\\jd\\fore\\src\\views\\data\\myData.vue","mtime":1578125234186},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\css-loader\\index.js","mtime":1570780111199},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1570779225817},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\postcss-loader\\src\\index.js","mtime":1570780438513},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\less-loader\\dist\\cjs.js","mtime":1570780454546},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1570779194464},{"path":"C:\\xxm\\work\\jd\\fore\\node_modules\\vue-loader\\lib\\index.js","mtime":1570779225726}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.searchBox{\n  width: 100%;\n  height: 60px;\n  border-bottom: 1px solid #cccccc;\n\n  display: flex;\n\n  p{\n    margin-left: 20px;\n  }\n  p:first-child{\n    margin-left: 0px;\n  }\n  p:last-child{\n    margin-left: 50px;\n  }\n}\n",{"version":3,"sources":["myData.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8RA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"myData.vue","sourceRoot":"src/views/data","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\" :loading=\"loading\">\r\n    <div class=\"searchBox\">\r\n        <p>\r\n          <span>所属模块：</span>\r\n          <a-select style=\"width: 260px;\"  placeholder=\"请选择所属模块（必选项）\" :defaultValue=\"ModelData[0].iid\"  @change=\"getModelVal\">\r\n            <a-select-option v-for=\"(item,index) in ModelData\" :key=\"index\" :value=\"item.iid\">{{item.sname}}\r\n            </a-select-option>\r\n          </a-select>\r\n        </p>\r\n\r\n      <p>\r\n        <span>所属业务：</span>\r\n        <a-select style=\"width: 260px;\" :allowClear='allowClear' ref=\"dsdsds\"  v-model=\"defaultValue\"   placeholder=\"请选择所属业务\" @change=\"getProVal\">\r\n          <a-select-option v-for=\"(item,index) in ProData\"  :key=\"index\" :value=\"item.iid\">{{item.sname}}\r\n          </a-select-option>\r\n        </a-select>\r\n      </p>\r\n\r\n      <p>\r\n        <span>申请年份：</span>\r\n        <a-select style=\"width: 260px;\"   placeholder=\"请选择申请年份（必选项）\" :defaultValue=\"YearData[0].year\" @change=\"getYearVal\">\r\n          <a-select-option v-for=\"(item,index) in YearData\" :key=\"index\" :value=\"item.year\">{{item.year}}\r\n          </a-select-option>\r\n        </a-select>\r\n      </p>\r\n\r\n      <p>\r\n        <!--<a-button type=\"primary\" @click=\"startAnalysis\">开始数据分析</a-button>-->\r\n      </p>\r\n    </div>\r\n\r\n    <a-tabs @change=\"getTabVal\">\r\n\r\n      <a-tab-pane  tab=\"分布情况\" key=\"1\">\r\n\r\n      </a-tab-pane>\r\n\r\n      <a-tab-pane  tab=\"办结率\" key=\"2\">\r\n      </a-tab-pane>\r\n\r\n    </a-tabs>\r\n    <!--<Banjie v-show=\"false\"    ref=\"banjieCompoment\"/>-->\r\n    <Distribution @startAnalysis=\"startAnalysis\" v-show=\"tabShow==1?true:false\" ref=\"distributionComponent\"/>\r\n    <Banjie  v-show=\"tabShow==2?true:false\"    ref=\"banjieCompoment\"/>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import {httpAction,getAction} from '@/api/manage'\r\n  import Distribution from './dataGram/Distribution'\r\n  import Banjie from './dataGram/Banjie'\r\n    export default {\r\n      name: \"dataAnalysis\",\r\n      components: {\r\n          Distribution,\r\n          Banjie\r\n      },\r\n      inject:['reload'],\r\n      filters:{\r\n        numberSlipce(val){\r\n          if(val%1===0){\r\n            return  val;\r\n          }else{\r\n            return (val).toFixed(2);\r\n          }\r\n          // return val*100\r\n        }\r\n      },\r\n      data() {\r\n        return {\r\n          defaultValue:'',\r\n          //ModelData[0].sname\r\n          tabShow:1,\r\n          loading:false,\r\n          fenbuqingkuang:false,\r\n          allowClear:true,\r\n          cheackModel:'',\r\n          cheackPro:'',\r\n          cheackYear:'',\r\n\r\n          ModelData:[],\r\n          ProData:[],\r\n          YearData:[],\r\n\r\n          userid:'',//人员id\r\n          departid:'',//部门id\r\n          parentid:'',//单位id\r\n\r\n          subData : {   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n            modelId:this.cheackModel,\r\n            iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n            iCreateYear:this.cheackYear,\r\n            // sCreateBy:this.userid\r\n          },\r\n          initModal:'',\r\n          initYear:''\r\n        }\r\n      },\r\n      created(){\r\n\r\n        //獲取用戶基本信息\r\n        const  userinfo =JSON.parse( localStorage.getItem('userdata'));\r\n        this.userid = userinfo.userInfo.id;// 人员id\r\n        this.departid = userinfo.departs[0].id;//部门id\r\n        this.parentid = userinfo.departs[0].parentId; //单位id\r\n\r\n        //加载基本数据    所属模块列表   申请年份列表\r\n        this.getBusModelList();\r\n        this.getYearList();\r\n        //  初始化 加载图表\r\n        setTimeout(()=>{\r\n          this.startAnalysis(this.initModal,this.initYear,'')\r\n          let url = \"/papertitle/docNumSet/busFunctionList?ibusModelId=\"+ this.initModal;\r\n          getAction(url).then((res)=>{\r\n            this.ProData = res.result;\r\n          })\r\n        },1000)\r\n\r\n\r\n      },\r\n      mounted(){\r\n\r\n\r\n      },\r\n      watch:{\r\n        $route(to,from){\r\n         this.startAnalysis();\r\n        }\r\n\r\n      },\r\n      methods:{\r\n        getTabVal(e){\r\n          this.tabShow = e;\r\n          this.startAnalysis();\r\n        },\r\n        //所属模块数据列表\r\n        getBusModelList() {\r\n          let url = \"/papertitle/docNumSet/busModelList\";\r\n          getAction(url).then((res) => {\r\n            this.ModelData = res.result;\r\n            this.initModal = this.ModelData[0].iid;\r\n\r\n            // alert( res.result[0].iid)\r\n            // this.defaultValue = res.result[0].iid\r\n          })\r\n        },\r\n\r\n        // 所属业务模块数据  参数依赖于所属模块 所选id\r\n        getProList(value){\r\n          let url = \"/papertitle/docNumSet/busFunctionList?ibusModelId=\"+value;\r\n          getAction(url).then((res)=>{\r\n            this.ProData = res.result;\r\n          })\r\n\r\n        },\r\n        //所属年份列表数据\r\n        getYearList(){\r\n          let url = '/data/dataAnalysis/analysis';\r\n          getAction(url).then((res)=>{\r\n            // alert(JSON.stringify(res.year))\r\n            this.YearData = res.year;\r\n            this.initYear = this.YearData[0].year;\r\n            // console.log(res);\r\n          })\r\n        },\r\n        //切换部门时所加载动画\r\n        loadingAnimation(){\r\n          // this.loading = true;\r\n          // setTimeout(()=>{\r\n          //   this.loading = false;\r\n          // },500)\r\n        },\r\n\r\n        //------------------------------------------------------------------------------------------------------------\r\n        //获取选值    所属模块value   此value值时所属业务的方法的基本参数\r\n        getModelVal(e){\r\n          this.cheackModel = e;\r\n          this.subData.modelId = e;\r\n\r\n          //获取对应业务列表  所需的模块儿id\r\n          this.getProList(e);\r\n          this.cheackPro = '';\r\n          this.defaultValue = ''\r\n\r\n            console.log(this.$refs.dsdsds);\r\n          let initYear = this.YearData[0].year;\r\n          //  初始化 加载图表\r\n          this.startAnalysis(e,this.cheackYear?this.cheackYear:initYear,this.cheackPro?this.cheackPro:'')\r\n        },\r\n        //获取选值    所属业务value\r\n        getProVal(e){\r\n          this.cheackPro = e;\r\n          this.subData.iBusFunctionId = e;\r\n\r\n\r\n\r\n          let initModal = this.ModelData[0].iid;\r\n          let initYear = this.YearData[0].year;\r\n          //  初始化 加载图表\r\n          this.startAnalysis(this.cheackModel?this.cheackModel:initModal,this.cheackYear?this.cheackYear:initYear,e)\r\n\r\n        },\r\n        //获取选值    申请年份value\r\n        getYearVal(e){\r\n          this.cheackYear = e;\r\n          this.subData.iCreateYear = e;\r\n\r\n\r\n          let initModal = this.ModelData[0].iid;\r\n          //  初始化 加载图表\r\n          this.startAnalysis(this.cheackModel?this.cheackModel:initModal,e,this.cheackPro?this.cheackPro:'')\r\n\r\n          // alert(this.cheackModel)\r\n\r\n        },\r\n\r\n        //------------------------------------------------------------------------------------------------------------\r\n\r\n\r\n        //开始分析件按钮    传递values  到接口方法参数\r\n        startAnalysis(initModal=this.subData.modelId,initYear=this.subData.iCreateYear,initYewu=this.subData.iBusFunctionId){\r\n\r\n            if(!Boolean(initModal)||!Boolean(initYear)){\r\n                this.$message.warning('所属模块与申请年份为必选项')\r\n            }else{\r\n\r\n              const urlStr = this.$route.path;\r\n              if(urlStr.endsWith('myData')){\r\n                // alert('我的数据')\r\n                // this.loadingAnimation();\r\n                //  为对象新增属性\r\n                // Object.assign(this.subData,{'sCreateBy':this.userid})\r\n                this.subData={   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n                    modelId:this.cheackModel?this.cheackModel :this.ModelData[0].iid,\r\n                    iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n                    iCreateYear:this.cheackYear?this.cheackYear:this.YearData[0].year,\r\n                    sCreateBy:this.userid\r\n                }\r\n\r\n              }else if(urlStr.endsWith('dataAnalysis')){\r\n                // alert('部门数据')\r\n                // this.loadingAnimation();\r\n                //  为对象新增属性\r\n                // Object.assign(this.subData,{'sCreateDeptid':this.departid})\r\n                this.subData={   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n                  modelId:this.cheackModel?this.cheackModel :this.ModelData[0].iid,\r\n                  iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n                  iCreateYear:this.cheackYear?this.cheackYear:this.YearData[0].year,\r\n                  sCreateDeptid:this.departid\r\n                }\r\n\r\n              }else if (urlStr.endsWith('unitidData')) {\r\n                // alert('单位数据数据')\r\n                // this.loadingAnimation();\r\n                //  为对象新增属性\r\n                // Object.assign(this.subData,{'sCreateUnitid':this.parentid})\r\n                this.subData={   //提交数据   提交前动态修改部门id  人员id   或者单位id\r\n                  modelId:this.cheackModel?this.cheackModel :this.ModelData[0].iid,\r\n                  iBusFunctionId:this.cheackPro?this.cheackPro:'',\r\n                  iCreateYear:this.cheackYear?this.cheackYear:this.YearData[0].year,\r\n                  sCreateUnitid:this.parentid\r\n                }\r\n\r\n\r\n              }\r\n\r\n\r\n              //------------------------------子组件方法调用 传参 subData     子组件分别为分布情况、办结率----------------------------------------------\r\n\r\n              this.$refs.distributionComponent.getSubData(this.subData);\r\n              this.$refs.banjieCompoment.getSubData(this.subData);\r\n\r\n              // this.$refs.distributionComponent.asDepartCheack(this.subData);\r\n\r\n\r\n            }\r\n        },\r\n\r\n\r\n\r\n      },\r\n    }\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n    .searchBox{\r\n      width: 100%;\r\n      height: 60px;\r\n      border-bottom: 1px solid #cccccc;\r\n\r\n      display: flex;\r\n\r\n      p{\r\n        margin-left: 20px;\r\n      }\r\n      p:first-child{\r\n        margin-left: 0px;\r\n      }\r\n      p:last-child{\r\n        margin-left: 50px;\r\n      }\r\n    }\r\n</style>"]}]}