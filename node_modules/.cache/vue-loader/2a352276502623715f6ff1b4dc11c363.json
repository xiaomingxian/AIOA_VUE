{"remainingRequest":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\src\\views\\modules\\monitor\\HttpTrace.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\src\\views\\modules\\monitor\\HttpTrace.vue","mtime":1568535256000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568345883000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1568345858000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568345883000},{"path":"D:\\project\\workspaceideaIU\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1568345696000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport moment from 'moment'\nimport { getAction } from '@/api/manage'\n\nmoment.locale('zh-cn')\n\nexport default {\n  data() {\n    return {\n      advanced: false,\n      dataSource: [],\n      pagination: {\n        defaultPageSize: 10,\n        defaultCurrent: 1,\n        pageSizeOptions: ['10', '20', '30', '40', '100'],\n        showQuickJumper: true,\n        showSizeChanger: true,\n        showTotal: (total, range) => `显示 ${range[0]} ~ ${range[1]} 条记录，共 ${total} 条记录`\n      },\n      loading: true,\n      tableLoading: true\n    }\n  },\n  computed: {\n    columns() {\n      return [{\n        title: '请求时间',\n        dataIndex: 'timestamp',\n        customRender(text) {\n          return moment(text).format('YYYY-MM-DD HH:mm:ss')\n        }\n      }, {\n        title: '请求方法',\n        dataIndex: 'request.method',\n        scopedSlots: { customRender: 'requestMethod' },\n        filters: [\n          { text: 'GET', value: 'GET' },\n          { text: 'POST', value: 'POST' },\n          { text: 'PUT', value: 'PUT' },\n          { text: 'DELETE', value: 'DELETE' }\n        ],\n        filterMultiple: true,\n        onFilter: (value, record) => record.request.method.includes(value)\n      }, {\n        title: '请求URL',\n        dataIndex: 'request.uri',\n        customRender(text) {\n          return text.split('?')[0]\n        }\n      }, {\n        title: '响应状态',\n        dataIndex: 'response.status',\n        scopedSlots: { customRender: 'responseStatus' }\n      }, {\n        title: '请求耗时',\n        dataIndex: 'timeTaken',\n        scopedSlots: { customRender: 'timeTaken' }\n      }]\n    }\n  },\n  mounted() {\n    this.fetch()\n  },\n  methods: {\n\n    handleClickUpdate() {\n      this.fetch()\n    },\n\n    handleTableChange() {\n      this.fetch()\n    },\n\n    fetch() {\n      this.tableLoading = true\n      getAction('actuator/httptrace').then((data) => {\n        let filterData = []\n        for (let d of data.traces) {\n          if (d.request.method !== 'OPTIONS' && d.request.uri.indexOf('httptrace') === -1) {\n            filterData.push(d)\n          }\n        }\n        this.dataSource = filterData\n      }).catch((e) => {\n        console.error(e)\n        this.$message.error('获取HTTP信息失败')\n      }).finally(() => {\n        this.loading = false\n        this.tableLoading = false\n      })\n    }\n\n  }\n}\n",{"version":3,"sources":["HttpTrace.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"HttpTrace.vue","sourceRoot":"src/views/modules/monitor","sourcesContent":["<template>\r\n  <a-skeleton active :loading=\"loading\" :paragraph=\"{rows: 17}\">\r\n    <a-card :bordered=\"false\" class=\"card-area\">\r\n\r\n      <a-alert type=\"info\" :showIcon=\"true\">\r\n        <div slot=\"message\">\r\n          共追踪到 {{ dataSource.length }} 条近期HTTP请求记录\r\n          <a-divider type=\"vertical\"/>\r\n          <a @click=\"handleClickUpdate\">立即刷新</a>\r\n        </div>\r\n      </a-alert>\r\n\r\n      <!-- 表格区域 -->\r\n      <a-table\r\n        :columns=\"columns\"\r\n        :dataSource=\"dataSource\"\r\n        :pagination=\"pagination\"\r\n        :loading=\"tableLoading\"\r\n        :scroll=\"{ x: 900 }\"\r\n        style=\"margin-top: 20px;\"\r\n        @change=\"handleTableChange\">\r\n\r\n        <template slot=\"timeTaken\" slot-scope=\"text\">\r\n          <a-tag v-if=\"text < 500\" color=\"green\">{{ text }} ms</a-tag>\r\n          <a-tag v-else-if=\"text < 1000\" color=\"cyan\">{{ text }} ms</a-tag>\r\n          <a-tag v-else-if=\"text < 1500\" color=\"orange\">{{ text }} ms</a-tag>\r\n          <a-tag v-else color=\"red\">{{ text }} ms</a-tag>\r\n        </template>\r\n\r\n        <template slot=\"responseStatus\" slot-scope=\"text\">\r\n          <a-tag v-if=\"text < 200\" color=\"pink\">{{ text }} </a-tag>\r\n          <a-tag v-else-if=\"text < 201\" color=\"green\">{{ text }} </a-tag>\r\n          <a-tag v-else-if=\"text < 399\" color=\"cyan\">{{ text }} </a-tag>\r\n          <a-tag v-else-if=\"text < 403\" color=\"orange\">{{ text }} </a-tag>\r\n          <a-tag v-else-if=\"text < 501\" color=\"red\">{{ text }} </a-tag>\r\n          <span v-else>{{ text }}</span>\r\n        </template>\r\n\r\n        <template slot=\"requestMethod\" slot-scope=\"text\">\r\n          <a-tag v-if=\"text === 'GET'\" color=\"#87d068\">{{ text }}</a-tag>\r\n          <a-tag v-else-if=\"text === 'POST'\" color=\"#2db7f5\">{{ text }}</a-tag>\r\n          <a-tag v-else-if=\"text === 'PUT'\" color=\"#ffba5a\">{{ text }}</a-tag>\r\n          <a-tag v-else-if=\"text === 'DELETE'\" color=\"#f50\">{{ text }}</a-tag>\r\n          <span v-else>{{ text }} ms</span>\r\n        </template>\r\n\r\n      </a-table>\r\n\r\n    </a-card>\r\n  </a-skeleton>\r\n</template>\r\n\r\n<script>\r\n  import moment from 'moment'\r\n  import { getAction } from '@/api/manage'\r\n\r\n  moment.locale('zh-cn')\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        advanced: false,\r\n        dataSource: [],\r\n        pagination: {\r\n          defaultPageSize: 10,\r\n          defaultCurrent: 1,\r\n          pageSizeOptions: ['10', '20', '30', '40', '100'],\r\n          showQuickJumper: true,\r\n          showSizeChanger: true,\r\n          showTotal: (total, range) => `显示 ${range[0]} ~ ${range[1]} 条记录，共 ${total} 条记录`\r\n        },\r\n        loading: true,\r\n        tableLoading: true\r\n      }\r\n    },\r\n    computed: {\r\n      columns() {\r\n        return [{\r\n          title: '请求时间',\r\n          dataIndex: 'timestamp',\r\n          customRender(text) {\r\n            return moment(text).format('YYYY-MM-DD HH:mm:ss')\r\n          }\r\n        }, {\r\n          title: '请求方法',\r\n          dataIndex: 'request.method',\r\n          scopedSlots: { customRender: 'requestMethod' },\r\n          filters: [\r\n            { text: 'GET', value: 'GET' },\r\n            { text: 'POST', value: 'POST' },\r\n            { text: 'PUT', value: 'PUT' },\r\n            { text: 'DELETE', value: 'DELETE' }\r\n          ],\r\n          filterMultiple: true,\r\n          onFilter: (value, record) => record.request.method.includes(value)\r\n        }, {\r\n          title: '请求URL',\r\n          dataIndex: 'request.uri',\r\n          customRender(text) {\r\n            return text.split('?')[0]\r\n          }\r\n        }, {\r\n          title: '响应状态',\r\n          dataIndex: 'response.status',\r\n          scopedSlots: { customRender: 'responseStatus' }\r\n        }, {\r\n          title: '请求耗时',\r\n          dataIndex: 'timeTaken',\r\n          scopedSlots: { customRender: 'timeTaken' }\r\n        }]\r\n      }\r\n    },\r\n    mounted() {\r\n      this.fetch()\r\n    },\r\n    methods: {\r\n\r\n      handleClickUpdate() {\r\n        this.fetch()\r\n      },\r\n\r\n      handleTableChange() {\r\n        this.fetch()\r\n      },\r\n\r\n      fetch() {\r\n        this.tableLoading = true\r\n        getAction('actuator/httptrace').then((data) => {\r\n          let filterData = []\r\n          for (let d of data.traces) {\r\n            if (d.request.method !== 'OPTIONS' && d.request.uri.indexOf('httptrace') === -1) {\r\n              filterData.push(d)\r\n            }\r\n          }\r\n          this.dataSource = filterData\r\n        }).catch((e) => {\r\n          console.error(e)\r\n          this.$message.error('获取HTTP信息失败')\r\n        }).finally(() => {\r\n          this.loading = false\r\n          this.tableLoading = false\r\n        })\r\n      }\r\n\r\n    }\r\n  }\r\n</script>\r\n<style></style>\r\n"]}]}